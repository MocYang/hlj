(function(J,I){typeof exports=="object"&&typeof module<"u"?I(exports):typeof define=="function"&&define.amd?define(["exports"],I):(J=typeof globalThis<"u"?globalThis:J||self,I(J.mapv3d={}))})(this,function(J){"use strict";function I(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function dr(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function R(i,n,e){return n&&dr(i.prototype,n),e&&dr(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}var vr=function(){return"V0.1.29"},hr=function(){return new Date().toLocaleString()},vi="DEV",hi=function(){var n=`%c \u{1F312}%c MapV3D %c \u56FE\u6D0B\u4E09\u7EF4\u5730\u56FE\u5E73\u53F0 %c

\u7248 \u672C \u53F7\uFF1A`.concat(vr(),`
\u7F16\u8BD1\u65E5\u671F\uFF1A`).concat(hr(),`
\u7248\u6743\u58F0\u660E\uFF1A
1. MapV3D\u7248\u6743\u5B8C\u5168\u5C5E\u4E8E "\u676D\u5DDE\u56FE\u6D0B\u4FE1\u606F\u79D1\u6280\u6709\u9650\u516C\u53F8"\u3002
2. MapV3D\u4E2Dmapv3d-src.*.js\u7A0B\u5E8F\u5305\uFF0C\u4EFB\u4F55\u4E2A\u4EBA\u548C\u673A\u6784\u5728\u9075\u5B88\u4E0B\u5217\u6761\u4EF6\u7684\u524D\u63D0\u4E0B\u6388\u6743\u6C38\u4E45\u4F7F\u7528\uFF1A
    1\uFF09\u4E0D\u8FDB\u884C\u4EFB\u4F55\u5F62\u5F0F\u7684\u7834\u89E3\u548C\u88C1\u526A\uFF0C\u7A0B\u5E8F\u5305\u5B8C\u6574\u5F15\u7528
    2\uFF09\u4FDD\u7559\u6B64\u7248\u6743\u4FE1\u606F\u5728\u63A7\u5236\u53F0\u8F93\u51FA
\u6211\u4EEC\u4FDD\u7559\u5BF9\u6B64\u7248\u6743\u4FE1\u606F\u7684\u6700\u7EC8\u89E3\u91CA\u6743\u3002
`),e='font-size: 17px;line-height: 1.5;font-weight: 1000;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";color: rgb(240, 133, 25);',t='font-size: 12px;line-height: 1.5;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";color: rgb(0, 138, 255);',r='font-size: 15px;line-height: 1.5;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";font-style: italic;color: rgb(240, 133, 25);padding-bottom: 5px;',a='font-size: 12px;line-height: 1.5;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";color: rgb(0, 138, 255);';console.log(n,e,t,r,a)};function gr(i,n,e,t,r,a,o){try{var u=i[a](o),s=u.value}catch(l){e(l);return}u.done?n(s):Promise.resolve(s).then(t,r)}function z(i){return function(){var n=this,e=arguments;return new Promise(function(t,r){var a=i.apply(n,e);function o(s){gr(a,t,r,o,u,"next",s)}function u(s){gr(a,t,r,o,u,"throw",s)}o(void 0)})}}function ie(i){return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ie(i)}function gi(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var pr={exports:{}},mr={exports:{}};(function(i){function n(e){return i.exports=n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i.exports.__esModule=!0,i.exports.default=i.exports,n(e)}i.exports=n,i.exports.__esModule=!0,i.exports.default=i.exports})(mr),function(i){var n=mr.exports.default;function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i.exports=e=function(){return t},i.exports.__esModule=!0,i.exports.default=i.exports;var t={},r=Object.prototype,a=r.hasOwnProperty,o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function f(y,v,b){return Object.defineProperty(y,v,{value:b,enumerable:!0,configurable:!0,writable:!0}),y[v]}try{f({},"")}catch{f=function(b,_,A){return b[_]=A}}function c(y,v,b,_){var A=v&&v.prototype instanceof w?v:w,M=Object.create(A.prototype),K=new fe(_||[]);return M._invoke=function(de,pe,$){var Q="suspendedStart";return function(me,fi){if(Q==="executing")throw new Error("Generator is already running");if(Q==="completed"){if(me==="throw")throw fi;return ge()}for($.method=me,$.arg=fi;;){var di=$.delegate;if(di){var fr=Z(di,$);if(fr){if(fr===m)continue;return fr}}if($.method==="next")$.sent=$._sent=$.arg;else if($.method==="throw"){if(Q==="suspendedStart")throw Q="completed",$.arg;$.dispatchException($.arg)}else $.method==="return"&&$.abrupt("return",$.arg);Q="executing";var Fe=g(de,pe,$);if(Fe.type==="normal"){if(Q=$.done?"completed":"suspendedYield",Fe.arg===m)continue;return{value:Fe.arg,done:$.done}}Fe.type==="throw"&&(Q="completed",$.method="throw",$.arg=Fe.arg)}}}(y,b,K),M}function g(y,v,b){try{return{type:"normal",arg:y.call(v,b)}}catch(_){return{type:"throw",arg:_}}}t.wrap=c;var m={};function w(){}function C(){}function L(){}var E={};f(E,u,function(){return this});var S=Object.getPrototypeOf,V=S&&S(S(ne([])));V&&V!==r&&a.call(V,u)&&(E=V);var p=L.prototype=w.prototype=Object.create(E);function U(y){["next","throw","return"].forEach(function(v){f(y,v,function(b){return this._invoke(v,b)})})}function H(y,v){function b(A,M,K,de){var pe=g(y[A],y,M);if(pe.type!=="throw"){var $=pe.arg,Q=$.value;return Q&&n(Q)=="object"&&a.call(Q,"__await")?v.resolve(Q.__await).then(function(me){b("next",me,K,de)},function(me){b("throw",me,K,de)}):v.resolve(Q).then(function(me){$.value=me,K($)},function(me){return b("throw",me,K,de)})}de(pe.arg)}var _;this._invoke=function(A,M){function K(){return new v(function(de,pe){b(A,M,de,pe)})}return _=_?_.then(K,K):K()}}function Z(y,v){var b=y.iterator[v.method];if(b===void 0){if(v.delegate=null,v.method==="throw"){if(y.iterator.return&&(v.method="return",v.arg=void 0,Z(y,v),v.method==="throw"))return m;v.method="throw",v.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var _=g(b,y.iterator,v.arg);if(_.type==="throw")return v.method="throw",v.arg=_.arg,v.delegate=null,m;var A=_.arg;return A?A.done?(v[y.resultName]=A.value,v.next=y.nextLoc,v.method!=="return"&&(v.method="next",v.arg=void 0),v.delegate=null,m):A:(v.method="throw",v.arg=new TypeError("iterator result is not an object"),v.delegate=null,m)}function he(y){var v={tryLoc:y[0]};1 in y&&(v.catchLoc=y[1]),2 in y&&(v.finallyLoc=y[2],v.afterLoc=y[3]),this.tryEntries.push(v)}function ce(y){var v=y.completion||{};v.type="normal",delete v.arg,y.completion=v}function fe(y){this.tryEntries=[{tryLoc:"root"}],y.forEach(he,this),this.reset(!0)}function ne(y){if(y){var v=y[u];if(v)return v.call(y);if(typeof y.next=="function")return y;if(!isNaN(y.length)){var b=-1,_=function A(){for(;++b<y.length;)if(a.call(y,b))return A.value=y[b],A.done=!1,A;return A.value=void 0,A.done=!0,A};return _.next=_}}return{next:ge}}function ge(){return{value:void 0,done:!0}}return C.prototype=L,f(p,"constructor",L),f(L,"constructor",C),C.displayName=f(L,l,"GeneratorFunction"),t.isGeneratorFunction=function(y){var v=typeof y=="function"&&y.constructor;return!!v&&(v===C||(v.displayName||v.name)==="GeneratorFunction")},t.mark=function(y){return Object.setPrototypeOf?Object.setPrototypeOf(y,L):(y.__proto__=L,f(y,l,"GeneratorFunction")),y.prototype=Object.create(p),y},t.awrap=function(y){return{__await:y}},U(H.prototype),f(H.prototype,s,function(){return this}),t.AsyncIterator=H,t.async=function(y,v,b,_,A){A===void 0&&(A=Promise);var M=new H(c(y,v,b,_),A);return t.isGeneratorFunction(v)?M:M.next().then(function(K){return K.done?K.value:M.next()})},U(p),f(p,l,"Generator"),f(p,u,function(){return this}),f(p,"toString",function(){return"[object Generator]"}),t.keys=function(y){var v=[];for(var b in y)v.push(b);return v.reverse(),function _(){for(;v.length;){var A=v.pop();if(A in y)return _.value=A,_.done=!1,_}return _.done=!0,_}},t.values=ne,fe.prototype={constructor:fe,reset:function(v){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ce),!v)for(var b in this)b.charAt(0)==="t"&&a.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var v=this.tryEntries[0].completion;if(v.type==="throw")throw v.arg;return this.rval},dispatchException:function(v){if(this.done)throw v;var b=this;function _($,Q){return K.type="throw",K.arg=v,b.next=$,Q&&(b.method="next",b.arg=void 0),!!Q}for(var A=this.tryEntries.length-1;A>=0;--A){var M=this.tryEntries[A],K=M.completion;if(M.tryLoc==="root")return _("end");if(M.tryLoc<=this.prev){var de=a.call(M,"catchLoc"),pe=a.call(M,"finallyLoc");if(de&&pe){if(this.prev<M.catchLoc)return _(M.catchLoc,!0);if(this.prev<M.finallyLoc)return _(M.finallyLoc)}else if(de){if(this.prev<M.catchLoc)return _(M.catchLoc,!0)}else{if(!pe)throw new Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return _(M.finallyLoc)}}}},abrupt:function(v,b){for(var _=this.tryEntries.length-1;_>=0;--_){var A=this.tryEntries[_];if(A.tryLoc<=this.prev&&a.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var M=A;break}}M&&(v==="break"||v==="continue")&&M.tryLoc<=b&&b<=M.finallyLoc&&(M=null);var K=M?M.completion:{};return K.type=v,K.arg=b,M?(this.method="next",this.next=M.finallyLoc,m):this.complete(K)},complete:function(v,b){if(v.type==="throw")throw v.arg;return v.type==="break"||v.type==="continue"?this.next=v.arg:v.type==="return"?(this.rval=this.arg=v.arg,this.method="return",this.next="end"):v.type==="normal"&&b&&(this.next=b),m},finish:function(v){for(var b=this.tryEntries.length-1;b>=0;--b){var _=this.tryEntries[b];if(_.finallyLoc===v)return this.complete(_.completion,_.afterLoc),ce(_),m}},catch:function(v){for(var b=this.tryEntries.length-1;b>=0;--b){var _=this.tryEntries[b];if(_.tryLoc===v){var A=_.completion;if(A.type==="throw"){var M=A.arg;ce(_)}return M}}throw new Error("illegal catch attempt")},delegateYield:function(v,b,_){return this.delegate={iterator:ne(v),resultName:b,nextLoc:_},this.method==="next"&&(this.arg=void 0),m}},t}i.exports=e,i.exports.__esModule=!0,i.exports.default=i.exports}(pr);var Ve=pr.exports(),B=Ve;try{regeneratorRuntime=Ve}catch{(typeof globalThis>"u"?"undefined":ie(globalThis))==="object"?globalThis.regeneratorRuntime=Ve:Function("r","regeneratorRuntime = r")(Ve)}function ot(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,e=arguments.length>2?arguments[2]:void 0,t,r,a=function(){var u=this,s=arguments;return e?(t?clearTimeout(t):r=i.apply(u,s),t=setTimeout(function(){t=null},n)):(clearTimeout(t),t=setTimeout(function(){i.apply(u,s)},n)),r};return a.cancel=function(){clearInterval(t),t=null},a}function yr(i,n,e){var t,r,a,o=0;e=e||{leading:!1,trailing:!0};var u=function(){o=e.leading?+new Date:0,t=null,i.apply(r,a),t||(r=a=null)},s=function(){var f=+new Date;!o&&!e.leading&&(o=f),r=this,a=arguments;var c=n-(f-o);c<=0||c>n?(t&&(clearTimeout(t),t=null),o=f,i.apply(r,a),t||(r=a=null)):!t&&e.trailing&&(t=setTimeout(u,c))};return s.cancel=function(){clearTimeout(t),t=null,o=0},s}var pi=function(){var n=document.documentElement,e=n.requestFullScreen||n.webkitRequestFullScreen||n.mozRequestFullScreen||n.msRequestFullscreen;if(e)e.call(n);else if(typeof window.ActiveXObject<"u"){var t=new ActiveXObject("WScript.Shell");t!=null&&t.SendKeys("{F11}")}},mi=function(){var n=document,e=n.cancelFullScreen||n.mozCancelFullScreen||n.msExitFullscreen||n.webkitExitFullscreen||n.exitFullscreen;if(e)e.call(n);else if(typeof window.ActiveXObject<"u"){var t=new ActiveXObject("WScript.Shell");t!=null&&t.SendKeys("{F11}")}};function yi(i){if(Array.isArray(i))return i}function bi(i,n){var e=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(e!=null){var t=[],r=!0,a=!1,o,u;try{for(e=e.call(i);!(r=(o=e.next()).done)&&(t.push(o.value),!(n&&t.length===n));r=!0);}catch(s){a=!0,u=s}finally{try{!r&&e.return!=null&&e.return()}finally{if(a)throw u}}return t}}function ut(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function br(i,n){if(!!i){if(typeof i=="string")return ut(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ut(i,n)}}function wi(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function st(i,n){return yi(i)||bi(i,n)||br(i,n)||wi()}function Ci(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Oi(i))||n&&i&&typeof i.length=="number"){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Oi(i,n){if(!!i){if(typeof i=="string")return wr(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return wr(i,n)}}function wr(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}var _i=function(){function i(){I(this,i),this.events=new Map}return R(i,[{key:"_add",value:function(e,t,r){var a=this,o=this.events.get(e),u=o||this.events.set(e,new Map).get(e);u.set(e,function(){t.apply(void 0,arguments),r&&a.off(e,t)})}},{key:"on",value:function(e,t){if(!t){console.error("No callback for key: ",e);return}this._add(e,t,!1)}},{key:"off",value:function(e,t){var r=this.events.get(e);r&&r.delete(t)}},{key:"dispatch",value:function(e){var t=this.events.get(e);if(!t){console.error("No callback for key: ",e);return}for(var r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];var u=Ci(t.entries()),s;try{for(u.s();!(s=u.n()).done;){var l=st(s.value,2),f=l[1];f.apply(void 0,a)}}catch(c){u.e(c)}finally{u.f()}}},{key:"once",value:function(e,t){this._add(e,t,!0)}}]),i}();const ki=new _i;function lt(){this.locked=null}lt.prototype.lock=z(B.mark(function i(){var n=this;return B.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.locked!==null){t.next=4;break}this.locked=[],t.next=6;break;case 4:return t.next=6,new Promise(function(r){return n.locked.push(r)});case 6:case"end":return t.stop()}},i,this)})),lt.prototype.unlock=function(){this.locked.length?this.locked.shift()():this.locked=null};const Ei={captureVideo:function(n){var e=document.createElement("canvas");return e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0,e.width,e.height),e.toDataURL()}};var Si=function(){var i=navigator.userAgent,n=/(?:Windows Phone)/.test(i),e=/(?:SymbianOS)/.test(i)||n,t=/(?:Android)/.test(i),r=/(?:Firefox)/.test(i);/(?:Chrome|CriOS)/.test(i);var a=/(?:iPad|PlayBook)/.test(i)||t&&!/(?:Mobile)/.test(i)||r&&/(?:Tablet)/.test(i),o=/(?:iPhone)/.test(i)&&!a,u=!o&&!t&&!e;return{isTablet:a,isPhone:o,isAndroid:t,isPc:u}}(),Cr={treeDfs:function(n,e){n.forEach(function(t){e(t),t.children&&Cr.treeDfs(t.children,e)})},treeToList:function(n){var e=[],t=function r(a){a.forEach(function(o){e.push(o),o.children&&o.children.length>0&&r(o.children)})};return t(n),e},list2Tree:function(n){return n.forEach(function(e){n.forEach(function(t){t.pid===e.id&&(e.children||(e.children=[]),e.children.push(t))})}),n=n.filter(function(e){return e.pid===null}),n}};function d(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Or={exports:{}},ct={exports:{}},_r=function(n,e){return function(){for(var r=new Array(arguments.length),a=0;a<r.length;a++)r[a]=arguments[a];return n.apply(e,r)}},Ii=_r,we=Object.prototype.toString;function ft(i){return Array.isArray(i)}function dt(i){return typeof i>"u"}function Ai(i){return i!==null&&!dt(i)&&i.constructor!==null&&!dt(i.constructor)&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function kr(i){return we.call(i)==="[object ArrayBuffer]"}function Li(i){return we.call(i)==="[object FormData]"}function Ri(i){var n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(i):n=i&&i.buffer&&kr(i.buffer),n}function Di(i){return typeof i=="string"}function Mi(i){return typeof i=="number"}function Er(i){return i!==null&&ie(i)==="object"}function $e(i){if(we.call(i)!=="[object Object]")return!1;var n=Object.getPrototypeOf(i);return n===null||n===Object.prototype}function Bi(i){return we.call(i)==="[object Date]"}function Pi(i){return we.call(i)==="[object File]"}function ji(i){return we.call(i)==="[object Blob]"}function Sr(i){return we.call(i)==="[object Function]"}function Ni(i){return Er(i)&&Sr(i.pipe)}function Ti(i){return we.call(i)==="[object URLSearchParams]"}function Fi(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function Vi(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function vt(i,n){if(!(i===null||typeof i>"u"))if(ie(i)!=="object"&&(i=[i]),ft(i))for(var e=0,t=i.length;e<t;e++)n.call(null,i[e],e,i);else for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&n.call(null,i[r],r,i)}function ht(){var i={};function n(r,a){$e(i[a])&&$e(r)?i[a]=ht(i[a],r):$e(r)?i[a]=ht({},r):ft(r)?i[a]=r.slice():i[a]=r}for(var e=0,t=arguments.length;e<t;e++)vt(arguments[e],n);return i}function $i(i,n,e){return vt(n,function(r,a){e&&typeof r=="function"?i[a]=Ii(r,e):i[a]=r}),i}function Hi(i){return i.charCodeAt(0)===65279&&(i=i.slice(1)),i}var ae={isArray:ft,isArrayBuffer:kr,isBuffer:Ai,isFormData:Li,isArrayBufferView:Ri,isString:Di,isNumber:Mi,isObject:Er,isPlainObject:$e,isUndefined:dt,isDate:Bi,isFile:Pi,isBlob:ji,isFunction:Sr,isStream:Ni,isURLSearchParams:Ti,isStandardBrowserEnv:Vi,forEach:vt,merge:ht,extend:$i,trim:Fi,stripBOM:Hi},Ee=ae;function Ir(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Ar=function(n,e,t){if(!e)return n;var r;if(t)r=t(e);else if(Ee.isURLSearchParams(e))r=e.toString();else{var a=[];Ee.forEach(e,function(s,l){s===null||typeof s>"u"||(Ee.isArray(s)?l=l+"[]":s=[s],Ee.forEach(s,function(c){Ee.isDate(c)?c=c.toISOString():Ee.isObject(c)&&(c=JSON.stringify(c)),a.push(Ir(l)+"="+Ir(c))}))}),r=a.join("&")}if(r){var o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+r}return n},Ui=ae;function He(){this.handlers=[]}He.prototype.use=function(n,e,t){return this.handlers.push({fulfilled:n,rejected:e,synchronous:t?t.synchronous:!1,runWhen:t?t.runWhen:null}),this.handlers.length-1},He.prototype.eject=function(n){this.handlers[n]&&(this.handlers[n]=null)},He.prototype.forEach=function(n){Ui.forEach(this.handlers,function(t){t!==null&&n(t)})};var xi=He,Ki=ae,Gi=function(n,e){Ki.forEach(n,function(r,a){a!==e&&a.toUpperCase()===e.toUpperCase()&&(n[e]=r,delete n[a])})},Lr=function(n,e,t,r,a){return n.config=e,t&&(n.code=t),n.request=r,n.response=a,n.isAxiosError=!0,n.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},n},Rr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},gt,Dr;function Mr(){if(Dr)return gt;Dr=1;var i=Lr;return gt=function(e,t,r,a,o){var u=new Error(e);return i(u,t,r,a,o)},gt}var pt,Br;function qi(){if(Br)return pt;Br=1;var i=Mr();return pt=function(e,t,r){var a=r.config.validateStatus;!r.status||!a||a(r.status)?e(r):t(i("Request failed with status code "+r.status,r.config,null,r.request,r))},pt}var mt,Pr;function Wi(){if(Pr)return mt;Pr=1;var i=ae;return mt=i.isStandardBrowserEnv()?function(){return{write:function(t,r,a,o,u,s){var l=[];l.push(t+"="+encodeURIComponent(r)),i.isNumber(a)&&l.push("expires="+new Date(a).toGMTString()),i.isString(o)&&l.push("path="+o),i.isString(u)&&l.push("domain="+u),s===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){var r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),mt}var yt,jr;function zi(){return jr||(jr=1,yt=function(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}),yt}var bt,Nr;function Yi(){return Nr||(Nr=1,bt=function(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}),bt}var wt,Tr;function Ji(){if(Tr)return wt;Tr=1;var i=zi(),n=Yi();return wt=function(t,r){return t&&!i(r)?n(t,r):r},wt}var Ct,Fr;function Xi(){if(Fr)return Ct;Fr=1;var i=ae,n=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Ct=function(t){var r={},a,o,u;return t&&i.forEach(t.split(`
`),function(l){if(u=l.indexOf(":"),a=i.trim(l.substr(0,u)).toLowerCase(),o=i.trim(l.substr(u+1)),a){if(r[a]&&n.indexOf(a)>=0)return;a==="set-cookie"?r[a]=(r[a]?r[a]:[]).concat([o]):r[a]=r[a]?r[a]+", "+o:o}}),r},Ct}var Ot,Vr;function Zi(){if(Vr)return Ot;Vr=1;var i=ae;return Ot=i.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),r;function a(o){var u=o;return e&&(t.setAttribute("href",u),u=t.href),t.setAttribute("href",u),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=a(window.location.href),function(u){var s=i.isString(u)?a(u):u;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}(),Ot}var _t,$r;function Ue(){if($r)return _t;$r=1;function i(n){this.message=n}return i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,_t=i,_t}var kt,Hr;function Ur(){if(Hr)return kt;Hr=1;var i=ae,n=qi(),e=Wi(),t=Ar,r=Ji(),a=Xi(),o=Zi(),u=Mr(),s=Rr,l=Ue();return kt=function(c){return new Promise(function(m,w){var C=c.data,L=c.headers,E=c.responseType,S;function V(){c.cancelToken&&c.cancelToken.unsubscribe(S),c.signal&&c.signal.removeEventListener("abort",S)}i.isFormData(C)&&delete L["Content-Type"];var p=new XMLHttpRequest;if(c.auth){var U=c.auth.username||"",H=c.auth.password?unescape(encodeURIComponent(c.auth.password)):"";L.Authorization="Basic "+btoa(U+":"+H)}var Z=r(c.baseURL,c.url);p.open(c.method.toUpperCase(),t(Z,c.params,c.paramsSerializer),!0),p.timeout=c.timeout;function he(){if(!!p){var fe="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,ne=!E||E==="text"||E==="json"?p.responseText:p.response,ge={data:ne,status:p.status,statusText:p.statusText,headers:fe,config:c,request:p};n(function(v){m(v),V()},function(v){w(v),V()},ge),p=null}}if("onloadend"in p?p.onloadend=he:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(he)},p.onabort=function(){!p||(w(u("Request aborted",c,"ECONNABORTED",p)),p=null)},p.onerror=function(){w(u("Network Error",c,null,p)),p=null},p.ontimeout=function(){var ne=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded",ge=c.transitional||s;c.timeoutErrorMessage&&(ne=c.timeoutErrorMessage),w(u(ne,c,ge.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},i.isStandardBrowserEnv()){var ce=(c.withCredentials||o(Z))&&c.xsrfCookieName?e.read(c.xsrfCookieName):void 0;ce&&(L[c.xsrfHeaderName]=ce)}"setRequestHeader"in p&&i.forEach(L,function(ne,ge){typeof C>"u"&&ge.toLowerCase()==="content-type"?delete L[ge]:p.setRequestHeader(ge,ne)}),i.isUndefined(c.withCredentials)||(p.withCredentials=!!c.withCredentials),E&&E!=="json"&&(p.responseType=c.responseType),typeof c.onDownloadProgress=="function"&&p.addEventListener("progress",c.onDownloadProgress),typeof c.onUploadProgress=="function"&&p.upload&&p.upload.addEventListener("progress",c.onUploadProgress),(c.cancelToken||c.signal)&&(S=function(ne){!p||(w(!ne||ne&&ne.type?new l("canceled"):ne),p.abort(),p=null)},c.cancelToken&&c.cancelToken.subscribe(S),c.signal&&(c.signal.aborted?S():c.signal.addEventListener("abort",S))),C||(C=null),p.send(C)})},kt}var Y=ae,xr=Gi,Qi=Lr,ea=Rr,ta={"Content-Type":"application/x-www-form-urlencoded"};function Kr(i,n){!Y.isUndefined(i)&&Y.isUndefined(i["Content-Type"])&&(i["Content-Type"]=n)}function ra(){var i;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(i=Ur()),i}function na(i,n,e){if(Y.isString(i))try{return(n||JSON.parse)(i),Y.trim(i)}catch(t){if(t.name!=="SyntaxError")throw t}return(e||JSON.stringify)(i)}var xe={transitional:ea,adapter:ra(),transformRequest:[function(n,e){return xr(e,"Accept"),xr(e,"Content-Type"),Y.isFormData(n)||Y.isArrayBuffer(n)||Y.isBuffer(n)||Y.isStream(n)||Y.isFile(n)||Y.isBlob(n)?n:Y.isArrayBufferView(n)?n.buffer:Y.isURLSearchParams(n)?(Kr(e,"application/x-www-form-urlencoded;charset=utf-8"),n.toString()):Y.isObject(n)||e&&e["Content-Type"]==="application/json"?(Kr(e,"application/json"),na(n)):n}],transformResponse:[function(n){var e=this.transitional||xe.transitional,t=e&&e.silentJSONParsing,r=e&&e.forcedJSONParsing,a=!t&&this.responseType==="json";if(a||r&&Y.isString(n)&&n.length)try{return JSON.parse(n)}catch(o){if(a)throw o.name==="SyntaxError"?Qi(o,this,"E_JSON_PARSE"):o}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Y.forEach(["delete","get","head"],function(n){xe.headers[n]={}}),Y.forEach(["post","put","patch"],function(n){xe.headers[n]=Y.merge(ta)});var Et=xe,ia=ae,aa=Et,oa=function(n,e,t){var r=this||aa;return ia.forEach(t,function(o){n=o.call(r,n,e)}),n},St,Gr;function qr(){return Gr||(Gr=1,St=function(n){return!!(n&&n.__CANCEL__)}),St}var Wr=ae,It=oa,ua=qr(),sa=Et,la=Ue();function At(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new la("canceled")}var ca=function(n){At(n),n.headers=n.headers||{},n.data=It.call(n,n.data,n.headers,n.transformRequest),n.headers=Wr.merge(n.headers.common||{},n.headers[n.method]||{},n.headers),Wr.forEach(["delete","get","head","post","put","patch","common"],function(r){delete n.headers[r]});var e=n.adapter||sa.adapter;return e(n).then(function(r){return At(n),r.data=It.call(n,r.data,r.headers,n.transformResponse),r},function(r){return ua(r)||(At(n),r&&r.response&&(r.response.data=It.call(n,r.response.data,r.response.headers,n.transformResponse))),Promise.reject(r)})},oe=ae,zr=function(n,e){e=e||{};var t={};function r(f,c){return oe.isPlainObject(f)&&oe.isPlainObject(c)?oe.merge(f,c):oe.isPlainObject(c)?oe.merge({},c):oe.isArray(c)?c.slice():c}function a(f){if(oe.isUndefined(e[f])){if(!oe.isUndefined(n[f]))return r(void 0,n[f])}else return r(n[f],e[f])}function o(f){if(!oe.isUndefined(e[f]))return r(void 0,e[f])}function u(f){if(oe.isUndefined(e[f])){if(!oe.isUndefined(n[f]))return r(void 0,n[f])}else return r(void 0,e[f])}function s(f){if(f in e)return r(n[f],e[f]);if(f in n)return r(void 0,n[f])}var l={url:o,method:o,data:o,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:s};return oe.forEach(Object.keys(n).concat(Object.keys(e)),function(c){var g=l[c]||a,m=g(c);oe.isUndefined(m)&&g!==s||(t[c]=m)}),t},Lt,Yr;function Jr(){return Yr||(Yr=1,Lt={version:"0.26.1"}),Lt}var fa=Jr().version,Rt={};["object","boolean","number","function","string","symbol"].forEach(function(i,n){Rt[i]=function(t){return ie(t)===i||"a"+(n<1?"n ":" ")+i}});var Xr={};Rt.transitional=function(n,e,t){function r(a,o){return"[Axios v"+fa+"] Transitional option '"+a+"'"+o+(t?". "+t:"")}return function(a,o,u){if(n===!1)throw new Error(r(o," has been removed"+(e?" in "+e:"")));return e&&!Xr[o]&&(Xr[o]=!0,console.warn(r(o," has been deprecated since v"+e+" and will be removed in the near future"))),n?n(a,o,u):!0}};function da(i,n,e){if(ie(i)!=="object")throw new TypeError("options must be an object");for(var t=Object.keys(i),r=t.length;r-- >0;){var a=t[r],o=n[a];if(o){var u=i[a],s=u===void 0||o(u,a,i);if(s!==!0)throw new TypeError("option "+a+" must be "+s);continue}if(e!==!0)throw Error("Unknown option "+a)}}var va={assertOptions:da,validators:Rt},Zr=ae,ha=Ar,Qr=xi,en=ca,Ke=zr,tn=va,Se=tn.validators;function De(i){this.defaults=i,this.interceptors={request:new Qr,response:new Qr}}De.prototype.request=function(n,e){typeof n=="string"?(e=e||{},e.url=n):e=n||{},e=Ke(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;t!==void 0&&tn.assertOptions(t,{silentJSONParsing:Se.transitional(Se.boolean),forcedJSONParsing:Se.transitional(Se.boolean),clarifyTimeoutError:Se.transitional(Se.boolean)},!1);var r=[],a=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(e)===!1||(a=a&&m.synchronous,r.unshift(m.fulfilled,m.rejected))});var o=[];this.interceptors.response.forEach(function(m){o.push(m.fulfilled,m.rejected)});var u;if(!a){var s=[en,void 0];for(Array.prototype.unshift.apply(s,r),s=s.concat(o),u=Promise.resolve(e);s.length;)u=u.then(s.shift(),s.shift());return u}for(var l=e;r.length;){var f=r.shift(),c=r.shift();try{l=f(l)}catch(g){c(g);break}}try{u=en(l)}catch(g){return Promise.reject(g)}for(;o.length;)u=u.then(o.shift(),o.shift());return u},De.prototype.getUri=function(n){return n=Ke(this.defaults,n),ha(n.url,n.params,n.paramsSerializer).replace(/^\?/,"")},Zr.forEach(["delete","get","head","options"],function(n){De.prototype[n]=function(e,t){return this.request(Ke(t||{},{method:n,url:e,data:(t||{}).data}))}}),Zr.forEach(["post","put","patch"],function(n){De.prototype[n]=function(e,t,r){return this.request(Ke(r||{},{method:n,url:e,data:t}))}});var ga=De,Dt,rn;function pa(){if(rn)return Dt;rn=1;var i=Ue();function n(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(o){t=o});var r=this;this.promise.then(function(a){if(!!r._listeners){var o,u=r._listeners.length;for(o=0;o<u;o++)r._listeners[o](a);r._listeners=null}}),this.promise.then=function(a){var o,u=new Promise(function(s){r.subscribe(s),o=s}).then(a);return u.cancel=function(){r.unsubscribe(o)},u},e(function(o){r.reason||(r.reason=new i(o),t(r.reason))})}return n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]},n.prototype.unsubscribe=function(t){if(!!this._listeners){var r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}},n.source=function(){var t,r=new n(function(o){t=o});return{token:r,cancel:t}},Dt=n,Dt}var Mt,nn;function ma(){return nn||(nn=1,Mt=function(n){return function(t){return n.apply(null,t)}}),Mt}var Bt,an;function ya(){if(an)return Bt;an=1;var i=ae;return Bt=function(e){return i.isObject(e)&&e.isAxiosError===!0},Bt}var on=ae,ba=_r,Ge=ga,wa=zr,Ca=Et;function un(i){var n=new Ge(i),e=ba(Ge.prototype.request,n);return on.extend(e,Ge.prototype,n),on.extend(e,n),e.create=function(r){return un(wa(i,r))},e}var ve=un(Ca);ve.Axios=Ge,ve.Cancel=Ue(),ve.CancelToken=pa(),ve.isCancel=qr(),ve.VERSION=Jr().version,ve.all=function(n){return Promise.all(n)},ve.spread=ma(),ve.isAxiosError=ya(),ct.exports=ve,ct.exports.default=ve,function(i){i.exports=ct.exports}(Or);const sn=gi(Or.exports);function ln(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function cn(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?ln(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):ln(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var Pt=sn.create({baseURL:"",timeout:1e4});Pt.interceptors.request.use(function(i){return i},function(i){return Promise.reject(i)}),Pt.interceptors.response.use(function(i){return i.data},function(i){return Promise.reject(i)});var Oa=sn.CancelToken;function _a(){return Oa.source()}function ka(){return function(){var n=_a();return{http:function(){var e=z(B.mark(function r(a){return B.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",Pt.request(cn(cn({},a),{},{cancelToken:n.token})));case 1:case"end":return u.stop()}},r)}));function t(r){return e.apply(this,arguments)}return t}(),cancel:function(t){n.cancel(t)}}}}const Ea=ka();function fn(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function Sa(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?fn(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):fn(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function Ia(){return jt.apply(this,arguments)}function jt(){return jt=z(B.mark(function i(){var n,e,t,r;return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return n=Ea(),e=n.http,o.next=3,e({url:"./config.json"});case 3:return t=o.sent,r=window.location.host,console.log("%c config.json\u914D\u7F6E:","color: red;font-size:13px",t),console.log("%c \u672C\u673AIP:","color: blue;font-size:13px",r),o.abrupt("return",Sa({environments:t.environments},t[t.environments||"PRD"])||{});case 8:case"end":return o.stop()}},i)})),jt.apply(this,arguments)}var dn=Tt,vn=ze,Aa={code:400,msg:"invalid parameter"},La={code:401,msg:"view3d uninitialized "};function Ie(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";dn(i)&&console.error(i),vn(i)&&console.log(i.msg)}function qe(i){dn(i)&&console.warn(i),vn(i)&&console.warn(i.msg)}function h(i,n){if(!!i)return!n in i?(Ie("".concat(n," dose not exist.")),!1):!0}const Ra=Object.freeze(Object.defineProperty({__proto__:null,InvalidParameter:Aa,View3dUnInitialized:La,logError:Ie,warn:qe,functionExist:h},Symbol.toStringTag,{value:"Module"}));var se=function(){return null},hn=function(){return!1},We=Object.create(null),gn=Object.prototype.toString,Nt=function(n){return gn.call(n)},ze=function(n){return Nt(n)==="[object Object]"},pn=function(n){return yn(n)&&le(n.then)&&le(n.catch)},Da=function(n){return n===!0||n===!1};function Ma(i){return i==null||i===""||i==="undefined"}function Ba(i){return!(i==null||i===""||i==="undefined")}function Ae(i){return typeof Array.isArray=="export function"?Array.isArray(i):Object.prototype.toString.call(i)==="[object Array]"}function Tt(i){return typeof i=="string"&&i.constructor===String}function Pa(i){return typeof obj=="number"&&obj.constructor===Number}function mn(i){return ie(i)==="object"&&i.constructor===Date}function le(i){return typeof i=="export function"||typeof i=="function"}function yn(i){return i!==null&&ie(i)=="object"}function Ft(i,n){if(i===null||ie(i)!="object")return i;if(n==null&&(n=["_parent","_class"]),mn(i)){var e=new Date;return e.setTime(i.getTime()),e}if(Ae(i)){for(var e=[],t=0,r=i.length;t<r;++t)e[t]=Ft(i[t],n);return e}if(ie(i)==="object"){var e={};for(var a in i)typeof a!="export function"&&n.indexOf(a)==-1&&i.hasOwnProperty(a)&&(e[a]=Ft(i[a],n));return e}return i}function ja(i){for(var n=document.scripts||document.getElementsByTagName("script"),e,t=n.length;t>0;t--)n[t-1].src.indexOf(i)>-1&&(e=n[t-1].src.substring(0,n[t-1].src.lastIndexOf("/")+1));return e}function bn(i){return i&&Tt(i)&&i.toLowerCase()}function Vt(i){return Object.keys(i).reduce(function(n,e){return n[bn(e)]=i[e],n},{})}function Na(i){function n(e){return"_"+e.toLowerCase()}return Object.keys(i).reduce(function(e,t){return e[t.replace(/[A-Z]/,n)]=i[t],e},{})}function Ta(i){function n(e){return e=e.slice(1),e=e[0].toUpperCase()+e.slice(1),e}return Object.keys(i).reduce(function(e,t){return e[t.replace(/_\w/g,n)]=i[t],e},{})}var Fa=function(n,e){var t={};return n.forEach(function(r){var a=e(r);typeof a!="string"&&(a=JSON.stringify(a)),t[a]=t[a]||[],t[a].push(r)}),t},Va=function(n){return n.sort(function(){return Math.random()-.5})};function ye(){return Math.floor(Math.random()*16777215).toString(16)}function $t(){return"".concat(ye()).concat(ye()).concat(ye().slice(2))}function $a(){return"".concat(ye()).concat(ye()).concat(ye()).concat(ye()).concat(ye().slice(2))}function Ha(i,n){var e=null,t="",r=0,a="    ";return n=n||{},n.newlineAfterColonIfBeforeBraceOrBracket=n.newlineAfterColonIfBeforeBraceOrBracket===!0,n.spaceAfterColon=n.spaceAfterColon===!1,typeof i!="string"||(i=JSON.parse(i)),i=JSON.stringify(i),e=/([{}])/g,i=i.replace(e,`\r
$1\r
`),e=/([\[\]])/g,i=i.replace(e,`\r
$1\r
`),e=/(\,)/g,i=i.replace(e,`$1\r
`),e=/(\r\n\r\n)/g,i=i.replace(e,`\r
`),e=/\r\n\,/g,i=i.replace(e,","),n.newlineAfterColonIfBeforeBraceOrBracket||(e=/\:\r\n\{/g,i=i.replace(e,":{"),e=/\:\r\n\[/g,i=i.replace(e,":[")),n.spaceAfterColon&&(e=/\:/g,i=i.replace(e,":")),i.split(`\r
`).forEach(function(o,u){var s=0,l=0,f="";for(o.match(/\{$/)||o.match(/\[$/)?l=1:o.match(/\}/)||o.match(/\]/)?r!==0&&(r-=1):l=0,s=0;s<r;s++)f+=a;o!==""&&(t+=f+o+`\r
`),r+=l}),t.replace(/\r\n$/,"")}var Ht=1920,Ut=1080;function Ua(i,n){Ht=i,Ut=n}function xa(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof i!="number"?i:"".concat(i/Ht*100,"vw")}function Ka(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof i!="number"?i:"".concat(i/Ut*100,"vh")}function Ga(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ht;if(typeof i!="number")return i;var e=window.innerWidth;return Math.ceil(e/n*i)}function qa(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ut;if(typeof i!="number")return i;var e=window.innerHeight;return Math.ceil(e/n*i)}var wn=Si,Wa={sim_arraw:"sim_arraw",sim_dot:"sim_dot",sim_dashed:"sim_dashed",sim_flash:"sim_flash",sim_scan:"sim_scan",red:"red"};function za(i,n){}function Ya(i,n){if(!!i)return!n in i?(Ie("".concat(n," dose not exist.")),!1):!0}const Ja=Object.freeze(Object.defineProperty({__proto__:null,lock:lt,debounce:ot,throttle:yr,enterFullScreen:pi,exitFullScreen:mi,captureUtil:Ei,EventBus:ki,treeUtil:Cr,fetchConfig:Ia,NOOP:se,FALSE_FUNC:hn,EMPTY_OBJ:We,objectToString:gn,toTypeString:Nt,isPlainObject:ze,isPromise:pn,isBoolean:Da,isEmpty:Ma,isNotEmpty:Ba,isArray:Ae,isString:Tt,isNumber:Pa,isDate:mn,isFunction:le,isObject:yn,clone:Ft,getPath:ja,toLowerCase:bn,objectKeyToLowerCase:Vt,objectKeyToUnderline:Na,objectKeyUnderlineToUppercase:Ta,groupBy:Fa,shuffledArray:Va,createHex:ye,createUUID:$t,createUUID32:$a,beautifyJSON:Ha,setBaseLayout:Ua,formatPxToVw:xa,formatPxToVh:Ka,pxFromVw:Ga,pxFromVh:qa,osUtil:wn,STYLES:Wa,isInViewBox:za,functionExist:Ya},Symbol.toStringTag,{value:"Module"}));function Xa(i){if(Array.isArray(i))return ut(i)}function Za(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Qa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Me(i){return Xa(i)||Za(i)||br(i)||Qa()}var eo=se,Cn=Ae,be=le,to=ze,ro=pn,Be=[],xt=!1;function On(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,n=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,t=arguments.length,r=new Array(t>3?t-3:0),a=3;a<t;a++)r[a-3]=arguments[a];return new Promise(function(o){be(n)&&(e=n,n=null),e&&e.apply(n,[].concat(r)),setTimeout(function(){var u=eo;r.length===1&&be(r[0])?u=r[0]:r.length>1&&be(r[r.length-1])&&(u=r[r.length-1]),u(),o()},i)})}function _n(i,n){for(var e=arguments.length,t=new Array(e>2?e-2:0),r=2;r<e;r++)t[r-2]=arguments[r];return new Promise(function(a){if(be(n)){var o=function(){a.apply(void 0,arguments)};if(Cn(t)&&t.length===1&&be(t[0])){var u=t[0];o=function(){for(var f=arguments.length,c=new Array(f),g=0;g<f;g++)c[g]=arguments[g];u.apply(i,[].concat(c)),a.apply(void 0,c)},t=[]}else if(Cn(t)&&t.length>1&&be(t[t.length-1])){var s=t.pop();o=function(){for(var f=arguments.length,c=new Array(f),g=0;g<f;g++)c[g]=arguments[g];s.apply(null,[].concat(c)),a.apply(void 0,c)}}n.apply(i,[].concat(Me(t),[o]))}})}function Ye(i,n){for(var e=arguments.length,t=new Array(e>2?e-2:0),r=2;r<e;r++)t[r-2]=arguments[r];return z(B.mark(function a(){return B.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",_n.apply(void 0,[i,n].concat(t)));case 1:case"end":return u.stop()}},a)}))}function kn(i,n,e){for(var t=arguments.length,r=new Array(t>3?t-3:0),a=3;a<t;a++)r[a-3]=arguments[a];return z(B.mark(function o(){return B.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",On.apply(void 0,[i,n,e].concat(r)));case 1:case"end":return s.stop()}},o)}))}function Pe(i){return new Promise(function(){var n=z(B.mark(function e(t,r){return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:try{En({task:i.task,complete:function(){t.apply(void 0,arguments)}})}catch(u){r(u)}case 1:case"end":return o.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}())}function no(i){return function(){var n=z(B.mark(function e(t,r){var a,o,u,s=arguments;return B.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:for(a=s.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=s[u];return f.abrupt("return",Pe({task:function(){return be(i)&&i&&i(),Ye.apply(void 0,[t,r].concat(o))}}));case 2:case"end":return f.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}()}function G(i,n){for(var e=arguments.length,t=new Array(e>2?e-2:0),r=2;r<e;r++)t[r-2]=arguments[r];return Pe({task:Ye.apply(void 0,[i,n].concat(t))})}function j(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,n=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,t=arguments.length,r=new Array(t>3?t-3:0),a=3;a<t;a++)r[a-3]=arguments[a];return Pe({task:kn.apply(void 0,[i,n,e].concat(r))})}function En(i){to(i)&&Sn(Be,i),!xt&&io()}function Kt(i){return i.length===0?null:i[0]}function Sn(i,n){i.push(n)}function In(i){return i.length===0?null:i.splice(0,1)}function io(){return Gt.apply(this,arguments)}function Gt(){return Gt=z(B.mark(function i(){var n,e,t,r;return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:xt=!0,n=Kt(Be);case 2:if(n===null){o.next=21;break}if(e=n.task(),t=void 0,!be(e)){o.next=11;break}return o.next=8,e();case 8:t=o.sent,o.next=15;break;case 11:if(!ro(e)){o.next=15;break}return o.next=14,e;case 14:t=o.sent;case 15:r=n.complete,be(r)&&r(t),In(Be),n=Kt(Be),o.next=2;break;case 21:xt=!1;case 22:case"end":return o.stop()}},i)})),Gt.apply(this,arguments)}window.$taskQueue=Be;const An=Object.freeze(Object.defineProperty({__proto__:null,sleep:On,until:_n,curry:Ye,wait:kn,doSchedule:Pe,preSchedule:no,schedule:G,waitSchedule:j,performAsyncWork:En,peek:Kt,push:Sn,pop:In},Symbol.toStringTag,{value:"Module"}));var ao=le,oo=We,uo=ot,so=function(){function i(){I(this,i),this._view3d=null,this.config=oo}return R(i,[{key:"view3d",get:function(){return this._view3d},set:function(e){this._view3d=e}},{key:"createMap",value:function(){var n=z(B.mark(function t(r){var a=this,o,u;return B.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.config=r,o={},u=this,!(!window.MapVision||!window.MapVision.View3d)){l.next=6;break}return r.error&&ao(r.error)&&r.error({code:1,msg:"mapvision3d.min.js file was not include."}),l.abrupt("return");case 6:return l.abrupt("return",Pe({task:function(){var c={id:r.id,url:r.url,projectId:r.projectId,mapkey:r.mapkey,token:r.token};return o=new MapVision.View3d(c),Ye(o,o.Open,function(g){if(g.code===200)u._view3d=o;else{Ie({msg:"connection fail! check if MapVisionPServer is running!"}),r.error(g);return}r.autoResize&&lo(u,r.autoResizeTicker),a._view3d.OverLayerRemoveAll(),r.resetBuildings&&a._view3d.ResetAllBuildings(),a.setNorthControl(r.northControl),r.defaultSetResolution&&a.setResolution(r.id),a.setParameters(),a.setMouseEnable(r.enableMouse),a.setKeyBoardEnable(r.enableKeyboard),a._view3d.Stop(),a._view3d.Clear(),a.setMouseCursorVisible(r.internalMouseVisible),a._insertMask(),r.defaultLocate&&o.ResetHome()})}}));case 7:case"end":return l.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"destroy",value:function(){co(),this.view3d=null}},{key:"_insertMask",value:function(){var e=this.config.id,t=document.getElementById(e);if(t){var r=t.parentNode;if(r){var a=document.createElement("div");a.id=e+"_mask",a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.width="100%",a.style.height="100%",a.style.zIndex="1",a.style.display="none",a.style.backgroundColor="transparent",a.style.opacity="0",r.appendChild(a)}}}},{key:"_removeMask",value:function(){var e=this.config.id,t=document.getElementById(e);if(t){var r=t.parentNode;r&&r.removeChild(t)}}},{key:"showCover",value:function(){var e=this.config.id,t=document.getElementById(e+"_mask");t&&(t.style.display="block")}},{key:"hideCover",value:function(){var e=this.config.id,t=document.getElementById(e+"_mask");t&&(t.style.display="none")}},{key:"setResolution",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"mapVision3d",t=this.config,r=this._view3d,a=document.getElementById(e);if(a&&h(r,"SetResolution")){var o=window.devicePixelRatio*(wn.isPc?1:3);r.SetResolution(a.clientWidth*o*t.resolutionScale,a.clientHeight*o*t.resolutionScale)}}},{key:"openMap",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"default";h(this._view3d,"OpenMap")&&this._view3d.OpenMap(e)}},{key:"setMouseEnable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._view3d.enableMouse=e}},{key:"setKeyBoardEnable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._view3d.enableKeyboard=e}},{key:"setTreeVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"InstancedFoliageActor",e)}},{key:"setDirectionalLightVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"DirectionalLight",e)}},{key:"setDynamicSkyVisible",value:function(e){var t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"Ultra_Dynamic_Sky",e)}},{key:"setSkySphereVisible",value:function(e){var t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"BP_Sky_Sphere",e)}},{key:"getKeyBoardEnable",value:function(){return this._view3d.enableKeyboard}},{key:"setMouseCursorVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;h(this._view3d,"SetParameters")&&this.setParameters({showmouse:e})}},{key:"getSceneSunInfo",value:function(){var n=z(B.mark(function t(){var r;return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(r=this._view3d,!h(r,"GetScenceSunInfo")){o.next=3;break}return o.abrupt("return",G(r,r.GetScenceSunInfo));case 3:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"setSceneSunInfo",value:function(e){var t=this._view3d;if(h(t,"SetScenceSunInfo"))return j(10,t,t.SetScenceSunInfo,e)}},{key:"setNorthControl",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;this._view3d.SetNorthControl(e,t,r,a)}},{key:"close",value:function(){var e=this._view3d;h(e,"Close")&&(e.Close(),this.destroy())}},{key:"setParameters",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this._view3d;t.SetParameters(e)}},{key:"clear",value:function(){var e=this._view3d;h(e,"Clear")&&e.Clear()}},{key:"stop",value:function(){var e=this._view3d;h(e,"Stop")&&e.Stop()}},{key:"isClose",value:function(){var e=this._view3d;if(h(e,"IsClose"))return e.IsClose()}},{key:"setMapStatus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this._view3d;h(t,"SetMapStatus")&&t.SetMapStatus(e)}}]),i}(),Je;function lo(i){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:300;Je=uo(function(){i.setResolution(i.config.id)},n),window.addEventListener("resize",Je)}function co(){Je&&window.removeEventListener("resize",Je)}function Ln(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function Ce(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Ln(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Ln(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var qt=ze,fo=le,Xe=se,vo=function(){function i(n,e){I(this,i),this.view3d=n,this.viewer=e,this.duration=1,this.timer=null}return R(i,[{key:"init",value:function(){this.resetHome()}},{key:"resetHome",value:function(){var e=this.view3d;h(e,"ResetHome")&&e.ResetHome()}},{key:"setPosition",value:function(e){var t=this.view3d;qt(e)&&h(t,"SetPosition")&&t.SetPosition(e)}},{key:"flyToPosition",value:function(e){var t,r,a,o,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.duration,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Xe,c=this.view3d;(t=this.viewer)===null||t===void 0||(r=t.core)===null||r===void 0||r.showCover(),(a=this.viewer)===null||a===void 0||(o=a.event)===null||o===void 0||o.silent();var g=this;this.timer&&clearTimeout(this.timer);var m=function(S){var V,p,U,H;(V=g.viewer)===null||V===void 0||(p=V.core)===null||p===void 0||p.hideCover(),(U=g.viewer)===null||U===void 0||(H=U.event)===null||H===void 0||H.reBind(),fo(f)&&setTimeout(function(){f(S)},100)};if(!e){m();return}if(qt(e))h(c,"FlyToPosition")&&(c.FlyToPosition(e,u,s,l,function(E){g.timer&&(clearTimeout(g.timer),g.timer=null),m(E)}),this.timer=setTimeout(function(){m(null)},(s+.5)*1e3));else if(Array.isArray(e)){var w=0,C=null,L=function E(){var S=e[w],V=S.duration||s,p=function(H){C&&clearTimeout(C),w++,w===e.length?(C=null,m(H)):E()};c.FlyToPosition(S,u,V,l,p),C=setTimeout(p,(V+.2)*1e3)};L()}}},{key:"flyToPositionByOptions",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={position:null,duration:1,enableCurve:!1,showLocation:!1,onFinish:Xe},r=Object.assign({},t,e);this.flyToPosition(r.position,r.showLocation,r.duration,r.enableCurve,r.onFinish)}},{key:"flyToObject",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.duration,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.view3d;qt(e)&&!!e.gid&&h(a,"FlyToObject")&&a.FlyToObject(e,r,t)}},{key:"flyToObjectById",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={gid:"",showLocation:!1,pitch:90,yaw:0,distance:null,duration:this.duration,enableCurve:!1,onFinish:function(){return null}};if(e=Ce(Ce({},t),e),!e.gid){console.warn("object gid is undefined or ''.");return}var r=this.view3d;h(r,"FlyToObjectById")&&r.FlyToObjectById(e.gid,e.showLocation,e.pitch,e.distance,e.duration)}},{key:"setNorth",value:function(){var e=this.view3d;h(e,"SetNorth")&&e.SetNorth()}},{key:"getHomePosition",value:function(){var e=this.view3d;if(h(e,"GetHomePosition"))return G(e,e.GetHomePosition)}},{key:"getCurrentPosition",value:function(){var e=this.view3d;if(h(e,"GetCurrentPosition"))return G(e,e.GetCurrentPosition)}},{key:"getScreenPosition",value:function(e){var t=this.view3d;if(h(t,"GetScreenPosition"))return G(t,t.GetScrrenPosition,e)}},{key:"flyToObjectByType",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={type:10102,pitch:90,yaw:0,distance:100,duration:this.duration,heightRadio:1,enableCurve:!1,onFinish:Xe};e=Ce(Ce({},t),e);var r=this.view3d;if(h(r,"FlyToObjectByType"))return j.apply(void 0,[10,r,r.FlyToObjectByType].concat(Me(e)))}},{key:"flyToObjectByIds",value:function(e){var t={ids:[],pitch:90,yaw:0,distance:100,duration:this.duration,heightRadio:1,enableCurve:!1,onFinish:Xe};e=Ce(Ce({},t),e);var r=this.view3d;if(h(r,"FlyToObjectByIds"))return j.apply(void 0,[10,r,r.FlyToObjectByIds].concat(Me(e)))}},{key:"zoomIn",value:function(){var n=z(B.mark(function t(){var r;return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(r=this.view3d,!h(r,"ZoomIn")){o.next=3;break}return o.abrupt("return",j(10,r,r.ZoomIn));case 3:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"zoomOut",value:function(){var n=z(B.mark(function t(){var r;return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(r=this.view3d,!h(r,"ZoomOut")){o.next=3;break}return o.abrupt("return",j(10,r,r.ZoomOut));case 3:case"end":return o.stop()}},t,this)}));function e(){return n.apply(this,arguments)}return e}()},{key:"setPitchAngle",value:function(){var n=z(B.mark(function t(r){var a;return B.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"SetPitchAngle")){u.next=3;break}return u.abrupt("return",j(100,a,a.SetPitchAngle,r));case 3:case"end":return u.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"getPitchAngle",value:function(){var n=z(B.mark(function t(r){var a;return B.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"GetPitchAngle")){u.next=3;break}return u.abrupt("return",G(a,a.GetPitchAngle));case 3:case"end":return u.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"setRotateAngle",value:function(){var n=z(B.mark(function t(r){var a;return B.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"SetRotateAngle")){u.next=3;break}return u.abrupt("return",j(100,a,a.SetRotateAngle,r));case 3:case"end":return u.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"getRotateAngle",value:function(){var n=z(B.mark(function t(r){var a;return B.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"GetRotateAngle")){u.next=3;break}return u.abrupt("return",G(a,a.GetRotateAngle));case 3:case"end":return u.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={gid:"",pitch:90,radio:1,distance:10,highlight:!0};e=Ce(Ce({},t),e);var r=this.view3d;h(r,"Rotate")&&r.Rotate(e.pitch,e.radio,e.distance,e.gid,e.highlight)}}]),i}();function Rn(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=ho(i))||n&&i&&typeof i.length=="number"){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function ho(i,n){if(!!i){if(typeof i=="string")return Dn(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Dn(i,n)}}function Dn(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}var go=Ae,Mn=le,x=se,po=function(){function i(n,e){I(this,i),this._view3d=n,this._drawCtl=e,this.config=e.config,this.mapViewer=e._mapView}return R(i,[{key:"_draw",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{isOnce:!1,onDraw:x,onFinish:x,drawPoints:!0,pointsVisible:!0},r=this.mapViewer,a=t.onDraw,o=t.onFinish,u=t.drawPoints;t.pointsVisible;var s=t.isOnce,l=this,f=null,c=[];r.event.silent();var g=this._drawCtl,m=function w(){if(g.overLayerStopEdit(),window.removeEventListener("contextmenu",w),u){var C=Rn(c),L;try{for(C.s();!(L=C.n()).done;){var E=L.value;g.overLayerRemoveObject(E)}}catch(S){C.e(S)}finally{C.f()}}r.event.reBind(),Mn(o)&&o(f)};window.addEventListener("contextmenu",m),g.overLayerStartEdit(e,function(w){if(f=w,go(w.points)&&u){var C=Rn(w.points.slice(c.length)),L;try{for(C.s();!(L=C.n()).done;){var E=L.value;l.point({radius:5,color:e.color,location:E},!1).then(function(S){c.push(S)})}}catch(S){C.e(S)}finally{C.f()}}Mn(a)&&a(w),s&&m()})}},{key:"text",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this._drawCtl,a=this.config.text(e);return r.overLayerCreateObject(a,t)}},{key:"drawText",value:function(e){var t=this.config.text(e),r={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,r)}},{key:"model",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this._drawCtl;return r.overLayerCreateObject(this.config.model(e),t)}},{key:"drawModel",value:function(e){var t=this.config.model(e),r={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,r)}},{key:"image",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this._drawCtl;return r.overLayerCreateObject(this.config.image(e),t)}},{key:"drawImage",value:function(e){var t=this.config.image(e),r={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,r)}},{key:"point",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.circle(this.config.point(e),t)}},{key:"drawPoint",value:function(e){var t=this.config.point(e),r={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,r)}},{key:"line",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.points||e.points.length<2)&&qe("\u521B\u5EFA\u7EBF\uFF0C\u5FC5\u987B\u63D0\u4F9B points \u53C2\u6570\uFF0C\u4E14\u81F3\u5C11\u5305\u542B\u4E24\u4E2A\u53CA\u4EE5\u4E0A\u4E2A\u70B9\uFF01"),this._drawCtl.overLayerCreateObject(this.config.line(e),t)}},{key:"drawLine",value:function(e){var t=this.config.line(e),r={isOnce:!1,onDraw:e.onDraw||x,onFinish:e.onFinish||x,drawPoints:e.drawPoints||!1,pointsVisible:e.pointsVisible||!1};this._draw(t,r)}},{key:"polygon",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.polygon(e),t)}},{key:"drawPolygon",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=this.config.polygon(e),r={onDraw:e.onDraw||x,onFinish:e.onFinish||x,drawPoints:e.drawPoints||!0,pointsVisible:e.pointsVisible||!0};this._draw(t,r)}},{key:"circle",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.circle(e),t)}},{key:"imageLabel",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.imageLabel(e),t)}},{key:"drawImageLabel",value:function(e){var t=this.config.imageLabel(e),r={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,r)}},{key:"polygon3d",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.polygon3d(e),t)}},{key:"drawPolygon3d",value:function(e){var t=this.config.polygon3d(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"triangle",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.triangle(e),t)}},{key:"drawTriangle",value:function(e){var t=this.config.triangle(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"rect",value:function(e,t){return this._drawCtl.overLayerCreateObject(this.config.rect(e),t)}},{key:"drawRect",value:function(e){var t=this.config.rect(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"regularPolygon",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.regularPolygon(e),t)}},{key:"drawRegularPolygon",value:function(e){var t=this.config.regularPolygon(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"shape",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.shape(e),t)}},{key:"drawShape",value:function(e){var t=this.config.shape(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"box",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.box(e),t)}},{key:"drawBox",value:function(e){var t=this.config.box(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"pyramid",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.pyramid(e),t)}},{key:"drawPyramid",value:function(e){var t=this.config.pyramid(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"cone",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.cone(e),t)}},{key:"drawCone",value:function(e){var t=this.config.cone(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"cylinder",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.cylinder(e),t)}},{key:"drawCylinder",value:function(e){var t=this.config.cylinder(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"sphere",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.sphere,t)}},{key:"drawSphere",value:function(e){var t=this.config.sphere(e),r={onFinish:e.onFinish||x};this._draw(t,r)}},{key:"skeleton",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.skeleton,t)}},{key:"billBoard",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.billBoard(e),t)}},{key:"vlcMedia",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.vlcMedia(e),t)}},{key:"routeModel",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.routeModel(e),t)}},{key:"layer",value:function(e){return this._drawCtl.layerLoadAsync(this.config.layer(e))}},{key:"layerDynamic",value:function(e){return this._drawCtl.layerLoadAsync(this.config.layerDynamic(e))}},{key:"route",value:function(e){return this._drawCtl.createRoute(this.config.route(e))}},{key:"niagara",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.niagara(e),t)}}]),i}(),mo=function(){function i(n,e){I(this,i),this._view3d=n,this._drawCtl=e}return R(i,[{key:"one",value:function(e){return this._drawCtl.findObjectById(e)}},{key:"all",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"*";return this._drawCtl.findObjectByPrefix(e)}}]),i}(),yo=R(function i(n){I(this,i),this._view3d=n}),bo=function(){function i(n,e){I(this,i),this._view3d=n,this._drawCtl=e}return R(i,[{key:"all",value:function(){this._drawCtl.overLayerRemoveAll()}},{key:"one",value:function(e){this._drawCtl.overLayerRemoveObject(e)}},{key:"oneById",value:function(e){return this._drawCtl.overLayerRemoveObjectById(e)}}]),i}(),wo=R(function i(){I(this,i),this.LINE={SIM_ARRAW:"sim_arraw",SIM_DOT:"sim_dot",SIM_DASHED:"sim_dashed",SIM_FLASH:"sim_flash",SIM_CAN:"sim_scan"}});const Co=new wo;var Wt="10001",zt="10001_01",Yt="10001_02",Jt="10001_03",Xt="10001_05",Ze="10002",Zt="10002_01",Oo="10003",Bn="10004",Qt="10004_01",er="10004_02",_o="10005",ko="10006",Eo="10007",So="10008",Io="10009",tr="10010",Ao="10010_01",Lo="10012",Ro="10013",Do="10014",Qe={text:{type:10002,typeName:"label"},model:{type:10002,typeName:"model",options:[]},image:{type:10102,typeName:"image",options:[]},point:{type:10002,typeName:"circle"},line:{type:10002,typeName:"linestring",options:[]},polygon:{type:10002,typeName:"polygon",options:[]},circle:{type:10002,typeName:"circle"},imageLabel:{type:10002,typeName:"imageLabel"},polygon3d:{type:10002,typeName:"polygon3d"},triangle:{type:10002,typeName:"triangle"},rect:{type:10002,typeName:"rect"},regularPolygon:{type:10002,typeName:"regularPolygon"},shape:{type:10002,typeName:"shape"},box:{type:10002,typeName:"box"},pyramid:{type:10002,typeName:"pyramid"},cone:{type:10002,typeName:"cone"},cylinder:{type:10002,typeName:"cylinder"},sphere:{type:10002,typeName:"sphere"},skeleton:{type:10002,typeName:"skeleton"},billBoard:{type:10002,typeName:"webbrowser"},media:{type:10002,typeName:"media"},dynamicModel:{type:10002,typeName:"dynamicModel"},routeModel:{type:10002,typeName:"routeModel"},layer:{type:10002,typeName:"MLT_LAYER_SHAPE"},layerDynamic:{type:10002,typeName:"MLT_LAYER_POS_DYNAMIC"},route:{type:10002,typeName:"route_patrol"},videoSequence:{type:10002,typeName:"video_sequence"},video:{type:10002,typeName:"video_rtsp"},videoProjection:{type:10002,typeName:"media2"},region:{type:10002,typeName:"region"},heatmap:{type:10002,typeName:"heatmap_rect"},niagara:{type:10111,typeName:"niagara",options:["P_Marker","P_Marker_1","P_Marker_2","P_Marker_3","P_Marker_4","P_Marker_5","P_Marker_6","P_Marker_7","P_Marker_8","P_Marker_9"]}};const Pn=Object.freeze(Object.defineProperty({__proto__:null,CATEGORY_CAMERA:Wt,CAMERA_TYPE_BOX:zt,CAMERA_TYPE_SPEED_DOME:Yt,CAMERA_TYPE_DOME:Jt,CATEGORY_BAYONET:Xt,CATEGORY_DOOR:Ze,CATEGORY_DOOR_HK_FACE_ACCESS_TERMINAL:Zt,CATEGORY_FIRE_EXTINGUISHING:Oo,CATEGORY_INTERCOM:Bn,CATEGORY_INTERCOM_HK_INDOOR:Qt,CATEGORY_INTERCOM_HK_OUTDOOR:er,CATEGORY_BROADCAST:_o,CATEGORY_ALARM:ko,CATEGORY_LIGAN:Eo,CATEGORY_WINDOW:So,CATEGORY_BED:Io,CATEGORY_FACE:tr,CATEGORY_FACE_HK_400:Ao,CATEGORY_AGV:Lo,CATEGORY_CAR:Ro,CATEGORY_ROBOT:Do,TYPE:Qe},Symbol.toStringTag,{value:"Module"}));function jn(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function D(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?jn(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):jn(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var P=Qe,N=Vt,Mo=function(){function i(){I(this,i)}return R(i,[{key:"getTypeName",value:function(e){return e.typeName}},{key:"mergeConfig",value:function(e){return e.id||(e.id=$t()),e.gid||(e.gid=e.id),D(D({},e),{},{attr:D(D({},e.attr),{},{gid:e.gid||e.id})})}},{key:"text",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.text),text:"",font:"\u9ED1\u4F53",fontcolor:"#ffffff",fontsize:24,halign:"center",valign:"bottom",location:null},N(e)))}},{key:"model",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.model),filename:"default",scale:1,style:"red",location:null},N(e)))}},{key:"image",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.image),style:"default",scale:1,screen:!0,location:null},N(e)))}},{key:"point",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.point),radius:10,color:"red",location:null},N(e)))}},{key:"line",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.line),style:"red",linewidth:10,points:[]},N(e)))}},{key:"polygon",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.polygon),points:[],color:"#00ff00",linecolor:"#00ff00",lineWidth:1,linevisible:!0},N(e)))}},{key:"circle",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.circle),radius:10,color:"red",location:null},N(e)))}},{key:"imageLabel",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.imageLabel),lighting:!0,iconstyle:"default.png",style:"white",scale:1,screen:!0,location:null},N(e)))}},{key:"polygon3d",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.polygon3d),style:"green",color:"#0000ff",linewidth:5,linestyle:"green",linecolor:"#0000ff",linevisible:!0,roofvisible:!1,roofheight:400,edgestyle:"green",edgecolor:"#0000ff",edgeheight:400,points:[]},N(e)))}},{key:"triangle",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.triangle),color:"#ffffff",points:[]},N(e)))}},{key:"rect",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.rect),length:100,width:100,color:"#ffffff",location:null},N(e)))}},{key:"regularPolygon",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.regularPolygon),radius:100,num:5,color:"#ffffff",location:null},N(e)))}},{key:"shape",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.shape),scale:1,style:"box",color:"#ffffff",location:null},N(e)))}},{key:"box",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.box),length:100,width:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"pyramid",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.pyramid),radius:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"cone",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.cone),radius:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"cylinder",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.cylinder),radius:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"sphere",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.sphere),scale:1,radius:100,color:"#ffffff",location:null},N(e)))}},{key:"skeleton",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.skeleton),filename:"person",scale:1,color:"#ffffff",location:null},N(e)))}},{key:"billBoard",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.billBoard),url:"",width:100,height:100,screen:!0,location:null},N(e)))}},{key:"media",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.media),url:"",screen:!0,scale:1,width:100,height:100,location:null},N(e)))}},{key:"dynamicModel",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.dynamicModel),scale:1,filename:"",location:null},N(e)))}},{key:"routeModel",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.routeModel),scale:1,speed:20,filename:"default",points:[],location:null},N(e)))}},{key:"layer",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.layer),shapes:[]},N(e)))}},{key:"layerDynamic",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.layerDynamic),speed:10,shapes:[]},N(e)))}},{key:"route",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.route),visible:!0,style:"sim_arraw",showloc:!0,width:100,speed:2e3,distance:1e3,pitch:35,iselev:!0,geom:[]},N(e)))}},{key:"videoSequence",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return{type:this.getTypeName(P.videoSequence),id:e}}},{key:"video",value:function(e){return D({type:this.getTypeName(P.video),url:"",width:10,height:10,position:null},N(e))}},{key:"videoProjection",value:function(e){return this.mergeConfig(D({type:this.getTypeName(P.videoProjection),url:"",width:50,height:45,bwidth:10,barch:5,points:[],location:null},N(e)))}},{key:"region",value:function(e){return D({type:this.getTypeName(P.region),style:"default",geom:null},N(e))}},{key:"heatmap",value:function(e){return D({type:this.getTypeName(P.heatmap),pheight:100,minx:0,miny:0,maxx:0,maxy:0,gradient:{},points:[]},N(e))}},{key:"niagara",value:function(e){return D({type:this.getTypeName(P.heatmap),filename:"",scale:1,location:null},N(e))}}]),i}();const Bo=new Mo;function Nn(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function Po(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Nn(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Nn(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var jo=We,je=se,No=Vt,To=function(){function i(n,e){I(this,i),this._view3d=n,this._event=e.event,this._mapView=e,this.create=new po(n,this),this.find=new mo(n,this),this.remove=new bo(n,this),this.update=new yo(n,this)}return R(i,[{key:"ACTOR",get:function(){return Co}},{key:"config",get:function(){return Bo}},{key:"overLayerSelectObjectEdit",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:je,t=this._view3d,r=this;if(h(t,"OverLayerSelectObjectEdit")){var a=function o(){r.overLayerStopEdit(),window.removeEventListener("contextmenu",o)};window.addEventListener("contextmenu",a),t.OverLayerSelectObjectEdit(function(o){e&&e(o)})}}},{key:"overLayerStartEdit",value:function(e,t){var r=this._view3d;if(h(r,"OverLayerStartEdit"))return j(10,r,r.OverLayerStartEdit,function(){r.OverLayerStartEdit(e,t)})}},{key:"overLayerStopEdit",value:function(){var e=this,t=this._view3d;if(h(t,"OverLayerStopEdit"))return j(10,t,t.OverLayerStopEdit,function(){e._event.reBind()})}},{key:"overLayerCreateObject",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:jo,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this._view3d;if(h(a,"OverLayerCreateObject"))return G(a,a.OverLayerCreateObject,t,function(o){r&&e._event.reBind()})}},{key:"overLayerCreateObjects",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t.length>200&&console.warn("OverLayerCreateObjects \u4E00\u6B21\u521B\u5EFA\u5BF9\u8C61\u7684\u6570\u91CF\u4E0D\u5E94\u8D85\u8FC7200\u4E2A\uFF0C\u4E0D\u7136\u6709\u5931\u8D25\u7684\u98CE\u9669\u3002");var a=this._view3d;if(h(a,"OverLayerCreateObjects"))return G(a,a.OverLayerCreateObjects,t,function(){r&&e._event.reBind()})}},{key:"findObjectById",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=this._view3d;if(h(t,"FindObjectById"))return G(t,t.FindObjectById,e)}},{key:"findObjectByPrefix",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=this._view3d;if(h(r,"FindObjectByPrefix"))return G(r,r.FindObjectByPrefix,e,t)}},{key:"overLayerUpdateObject",value:function(e){var t=this._view3d;h(t,"OverLayerUpdateObject")&&t.OverLayerUpdateObject(e)}},{key:"overLayerUpdateObjectAsync",value:function(e){var t=this._view3d;if(h(t,"OverLayerUpdateObject"))return j(20,t,t.OverLayerUpdateObject,e)}},{key:"updateObjectStyle",value:function(e,t){var r=this._view3d;h(r,"UpdateObjectStyle")&&r.UpdateObjectStyle(e,t)}},{key:"updateObjectStyleAsync",value:function(e,t){var r=this._view3d;if(h(r,"UpdateObjectStyle"))return j(20,r,r.UpdateObjectStyle,e,t)}},{key:"updateObject",value:function(e){var t=this._view3d;h(t,"UpdateObject")&&t.UpdateObject(e)}},{key:"updateObjectAsync",value:function(e){var t=this._view3d;if(h(t,"UpdateObject"))return j(20,t,t.UpdateObject,e)}},{key:"updateObjects",value:function(e){var t=this._view3d;h(t,"UpdateObjects")&&t.UpdateObjects(e)}},{key:"resetObjects",value:function(){var e=this._view3d;h(e,"ResetObjects")&&e.ResetObjects()}},{key:"updateObjectsAsync",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,r=this._view3d;if(h(r,"UpdateObjects"))return j(t,r,r.UpdateObjects,e)}},{key:"clearObjectStyle",value:function(){var e=this._view3d;h(e,"ClearObjectStyle")&&e.ClearObjectStyle()}},{key:"getObjectsVisible",value:function(){var e=this._view3d;if(h(e,"GetObjectsVisible"))return G(e,e.GetObjectsVisible)}},{key:"setObjectsVisible",value:function(e){var t=this._view3d;h(t,"SetObjectsVisible")&&t.SetObjectsVisible(e)}},{key:"setObjectsVisibleAsync",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,r=this._view3d;if(h(r,"SetObjectsVisible"))return j(t,r,r.SetObjectsVisible,e)}},{key:"updateObjectVisible",value:function(e,t){var r=this._view3d;h(r,"UpdateObjectVisible")&&r.UpdateObjectVisible(e,t)}},{key:"updateObjectVisibleAsync",value:function(e,t){var r=this._view3d;if(h(r,"UpdateObjectVisible"))return j(10,r,r.UpdateObjectVisible,e,t)}},{key:"overLayerRemoveObject",value:function(e){var t=this._view3d;h(t,"OverLayerRemoveObject")&&t.OverLayerRemoveObject(e)}},{key:"overLayerRemoveObjectById",value:function(e){var t=this._view3d;if(h(t,"OverLayerRemoveObjectById"))return j(20,t,t.OverLayerRemoveObjectById,e)}},{key:"overLayerRemoveObjectsById",value:function(e){var t=this._view3d;if(h(t,"OverLayerRemoveObjectsById"))return j(20,t,t.OverLayerRemoveObjectsById,e)}},{key:"overLayerRemoveAll",value:function(){var e=this._view3d;h(e,"OverLayerRemoveAll")&&e.OverLayerRemoveAll()}},{key:"setObjectHighlight",value:function(e){var t=this._view3d;if(h(t,"SetObjectHighlight"))return j(20,t,t.SetObjectHighlight,e)}},{key:"setObjectsHighlightByPrefix",value:function(e){if(!!e){var t=this._view3d;h(t,"SetObjectsHighlightByPrefix")&&t.SetObjectsHighlightByPrefix(e)}}},{key:"clearHighlight",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20,a=this._view3d;if(h(a,"ClearHighlight"))return j(r,a,a.ClearHighlight,function(){t&&e._event.reBind()})}},{key:"layerLoad",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,r=this._view3d;h(r,"LayerLoad")&&r.LayerLoad(e,function(a){t(a)})}},{key:"layerLoadAsync",value:function(e){var t=this._view3d;if(h(t,"LayerLoad"))return G(t,t.LayerLoad,e)}},{key:"layerSetVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this._view3d;h(r,"LayerSetVisible")&&r.LayerSetVisible(e,t)}},{key:"layerSetVisibleAsync",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this._view3d;if(h(r,"LayerSetVisible"))return j(20,r,r.LayerSetVisible,e,t)}},{key:"layerRemove",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=this._view3d;h(t,"LayerRemove")&&t.LayerRemove(e)}},{key:"layerRemoveAsync",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=this._view3d;if(h(t,"LayerRemove"))return j(20,t,t.LayerRemove,e)}},{key:"layerReLoad",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,r=this._view3d;h(r,"LayerReLoad")&&r.LayerReLoad(e,t)}},{key:"layerReLoadAsync",value:function(e){var t=this._view3d;if(h(t,"LayerReLoad"))return G(t,t.LayerReLoad,e)}},{key:"createRoute",value:function(e){var t=this._view3d;if(h(t,"CreateRoute"))return G(t,t.CreateRoute,e)}},{key:"playRoute",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:je,t=this._view3d;h(t,"CreateRoute")&&t.PlayRoute(function(r){e(r)})}},{key:"pauseRoute",value:function(){var e=this._view3d;h(e,"PauseRoute")&&e.PauseRoute()}},{key:"resumeRoute",value:function(e){var t=this._view3d;h(t,"resumeRoute")&&t.ResumeRoute(e)}},{key:"stopRoute",value:function(){var e=this._view3d;h(e,"StopRoute")&&e.StopRoute()}},{key:"playSequence",value:function(e){var t=this._view3d;h(t,"PlaySequence")&&t.PlaySequence(e)}},{key:"pauseSequence",value:function(e){var t=this._view3d;h(t,"PlaySequence")&&t.PlaySequence(e)}},{key:"stopSequence",value:function(e){var t=this._view3d;h(t,"StopSequence")&&t.StopSequence(e)}},{key:"isPlayingSequence",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,r=this._view3d;h(r,"IsPlayingSequence")&&r.IsPlayingSequence(e,t)}},{key:"isPausedSequence",value:function(e,t){var r=this._view3d;h(r,"IsPausedSequence")&&r.IsPausedSequence(e,t)}},{key:"streamVideoOpen",value:function(e){var t=this._view3d,r=Po({url:"",width:10,height:9,position:null},No(e));h(t,"StreamVideoOpen")&&t.StreamVideoOpen(r)}},{key:"streamVideoClose",value:function(){var e=this._view3d;h(e,"StreamVideoClose")&&e.StreamVideoClose()}},{key:"setHighlightRegion",value:function(e){var t=this._view3d,r={style:"default",geom:e};h(t,"SetHighlightRegion")&&t.SetHighlightRegion(r)}},{key:"clearHighlightRegion",value:function(){var e=this._view3d;h(e,"ClearHighlightRegion")&&e.ClearHighlightRegion()}}]),i}(),Tn=se,Fo=R(function i(n,e){var t=this;I(this,i),d(this,"selectIds",function(){return Array.from(t.entity.ids)}),d(this,"selectEntities",function(){return Array.from(t.entity.data.values())}),d(this,"selectAll",function(){var r=t.selectIds();return r.reduce(function(a,o){var u=t.selectDataById(o);return u&&a.push(u),a},[])}),d(this,"selectTotal",function(){return t.selectIds().length}),d(this,"selectDataById",function(r){var a=t.entity.data.get(r);return a?a.getState():(console.warn("cannot find entity for id: ".concat(r,".")),null)}),d(this,"selectEntityById",function(r){var a=t.entity.data.get(r);return a||(console.warn("cannot find entity for id: ".concat(r,".")),null)}),d(this,"selectByCategory",function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"category_id";return t.selectAll().filter(function(o){return o[a]===r})}),d(this,"selectEntitiesByCategory",function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"category";return t.selectEntities().filter(function(o){return o[a]===r})}),d(this,"selectMapEntityById",function(r){return t.selectEntityById(r).getEntityData()}),d(this,"selectMapEntity",function(r){return r.reduce(function(a,o){return a.push.apply(a,Me(o.getEntityData())),a},[])}),d(this,"filter",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tn;return t.selectAll().filter(r)}),d(this,"filterEntities",function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tn;return t.selectEntities().filter(r)}),d(this,"filterOutDoor",function(){return t.filter(function(r){return!r.indoor})}),d(this,"filterOutDoorEntities",function(){return t.filterEntities(function(r){return!r.data.indoor})}),d(this,"filterByBuilding",function(r){return t.filter(function(a){return a.build_id===r})}),d(this,"filterEntityByBuilding",function(r){return t.filterEntities(function(a){return a.data.build_id===r})}),d(this,"filterByFloor",function(r,a){return t.filter(function(o){return o.indoor&&o.build_id===r&&o.floor_id===a})}),d(this,"filterEntityByFloor",function(r,a){return t.filterEntities(function(o){return o.data.indoor&&o.data.build_id===r&&o.data.floor_id===a})}),this.entity=n,this.mapViewer=e}),Oe=se,rr={isFirst:!1,size:200,onMap:!0,instance:!0,onSuccess:Oe,onProgress:Oe,onError:Oe},Ne={draw:!1,onMap:!0,scale:1,image:!0,imageScale:1,imageVisible:!0,modelVisible:!0,modelScale:1,textVisible:!0,textScale:1,visibleDistance:1e5,visibleInViewBox:!1,onSuccess:Oe,onError:Oe,onVisibleStatusChange:Oe,onMouseMove:Oe,onMouseMoveOut:Oe};function Fn(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Vo(i))||n&&i&&typeof i.length=="number"){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Vo(i,n){if(!!i){if(typeof i=="string")return Vn(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Vn(i,n)}}function Vn(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function $n(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function Hn(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?$n(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):$n(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var Un=$t,xn="MODEL_INSTANCE_TYPE",Le=function(){function i(n,e,t){I(this,i),this.$$typeof=xn,this.config=t,this.data=null,this.id=null,this.entity=new Map,this.type=e.category_id,this.typeName="\u6A21\u578B\u57FA\u7C7B",this.visible=!1,this.created=!1,this.mapViewer=n,this.setData(e)}return R(i,[{key:"_concatGid",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Un(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Un();return"".concat(e,"_").concat(t)}},{key:"setState",value:function(e,t){this[e]=t}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){e&&(this.data=e,this.id=e.id)}},{key:"getEntity",value:function(e){return e?this.entity.get(e):this.entity}},{key:"getAllEntities",value:function(){return Array.from(this.entity.values())}},{key:"getEntityData",value:function(){return Array.from(this.entity.values()).map(function(e){return e.data})}},{key:"setEntity",value:function(e,t){this.entity.set(e,{gid:t.gid||t.attr.id,type:t.type,data:t,visible:t.visible})}},{key:"deleteEntity",value:function(e){this.entity.delete(e)}},{key:"getModel",value:function(){return this.entity.get("model")}},{key:"getIcon",value:function(){return this.entity.get("icon")}},{key:"setModel",value:function(e){this.setEntity("model",e)}},{key:"setIcon",value:function(e){this.setEntity("icon",e)}},{key:"getIconLocation",value:function(e){return e?Hn(Hn({},e),{},{z:e.z+20}):null}},{key:"setVisible",value:function(e){var t=this.mapViewer.drawer;if(e!==this.visible){var r=Fn(this.entity.values()),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;t.updateObjectVisible(o.gid,e)}}catch(u){r.e(u)}finally{r.f()}this.markVisible(e)}}},{key:"markVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.visible=e}},{key:"markCreated",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.created=e}},{key:"clearEntity",value:function(){this.entity.clear()}},{key:"flyTo",value:function(e){if(this.data.center){var t=this.data.center,r={x:t.x,y:t.y,z:t.z,pitch:t.pitch,yaw:t.yaw,roll:t.roll};this.mapViewer.camera.flyToPositionByOptions({position:r,duration:e.duration})}if(this.data.indoor){var a=this.data.build_id,o=this.data.floor_id,u=this.mapViewer.model,s=u.getAdapter();s.setVisible(a,o)}}},{key:"highlight",value:function(){var e=this.getModel(),t=this.mapViewer;return this.clearHighlight().then(function(){e&&t.drawer.setObjectHighlight(e==null?void 0:e.gid)}),this}},{key:"clearHighlight",value:function(){var e=this.mapViewer,t=e.drawer;return t.clearHighlight()}},{key:"create",value:function(){var e=this,t=this.config,r=this.data||{},a=this.mapViewer.drawer,o=this.mapViewer.event,u=JSON.parse(JSON.stringify(r)),s=function(f){e.setModel(f),e.markCreated(!0),e.markVisible(!0),t.onSuccess(f)};t.draw?o.setMousePositionCallback(function(l){u.location=l,a.overLayerCreateObject(u).then(function(f){s(f)})}):t.onMap?a.overLayerCreateObject(u).then(function(l){s(l)}):e.setModel(u)}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.config,r=e.changes,a=e.data,o=this.mapViewer.drawer;if(t&&this.setState("config",t),a&&this.setState("data",a),r){var u=this.getModel(),s=this.getIcon();s&&(s.data.location=this.getIconLocation(r),o.overLayerUpdateObject(s.data)),u.data.location=r,o.overLayerUpdateObject(u.data)}}},{key:"destroy",value:function(){var e=this.entity,t=this.mapViewer.drawer,r=Fn(e.entries()),a;try{for(r.s();!(a=r.n()).done;){var o=st(a.value,2),u=o[0],s=o[1];t.remove.one(s.data)}}catch(l){r.e(l)}finally{r.f()}this.clearEntity()}}]),i}();d(Le,"CATEGORY","MODEL");function O(i){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(i)}function $o(i,n){for(;!Object.prototype.hasOwnProperty.call(i,n)&&(i=O(i),i!==null););return i}function X(){return typeof Reflect<"u"&&Reflect.get?X=Reflect.get.bind():X=function(n,e,t){var r=$o(n,e);if(!!r){var a=Object.getOwnPropertyDescriptor(r,e);return a.get?a.get.call(arguments.length<3?n:t):a.value}},X.apply(this,arguments)}function nr(i,n){return nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},nr(i,n)}function ee(i,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&nr(i,n)}function q(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function te(i,n){if(n&&(ie(n)==="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q(i)}function Kn(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function Gn(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Kn(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Kn(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function Ho(i){var n=Uo();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function Uo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qn=We,xo=se,k=function(i){ee(e,i);var n=Ho(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),e.mapViewer=t,r.category=e.model,r.categoryName="\u76D1\u63A7",r.type=Wt,r.typeName="\u76D1\u63A7",r.fileName="qiangji",r}return R(e,[{key:"setModelVisible",value:function(){}},{key:"setIconVisible",value:function(){}},{key:"getArea",value:function(){return this.entity.get("area")}},{key:"setArea",value:function(r){this.setEntity("area",r)}},{key:"flyTo",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{speed:40,showLocation:!1};return X(O(e.prototype),"flyTo",this).call(this,r),this}},{key:"create",value:function(){var r,a=this,o=this.config,u=this.data||qn,s=this.mapViewer.drawer,l=this.mapViewer.event,f=s.config.model({attr:{id:u.id,gid:this._concatGid(e.model,u.id)},gid:this._concatGid(e.model,u.id),fileName:this.fileName,scale:1,location:(u==null||(r=u.options)===null||r===void 0?void 0:r.location)||null}),c=s.config.image({attr:{id:u.id,gid:this._concatGid(e.icon,u.id)},gid:this._concatGid(e.icon,u.id),style:this.fileName+"_icon",location:a.getIconLocation(f==null?void 0:f.location)}),g=function(w,C){C&&(a.setModel(f),a.setIcon(c)),a.markVisible(!0),a.markCreated(!0),o.onSuccess(w)};return o.draw?l.setMousePositionCallback(function(m){f.location=m,c.location=a.getIconLocation(m),s.create.image(c),s.create.model(f,!0).then(function(w){g(w,!0)})}):(a.setModel(f),a.setIcon(c),o.onMap&&(s.create.model(f),s.create.image(c,!0).then(function(m){g(m,!1)}))),this}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X(O(e.prototype),"update",this).call(this,r),this}},{key:"destroy",value:function(){X(O(e.prototype),"destroy",this).call(this)}},{key:"updateImage",value:function(){}},{key:"updateText",value:function(){}},{key:"updateVisibleArea",value:function(){}},{key:"createArea",value:function(){var r=this.data||qn,a=this.mapViewer.drawer,o=this;if(r.camera_area){var u=this.getEntity("area");if(u)this.setAreaVisible(!0);else{var s=a.config.polygon(Gn(Gn({attr:{id:r.id}},r.camera_area),{},{gid:this._concatGid(e.area,r.id)}));a.create.polygon(s,!0).then(function(l){o.setArea(l)})}}}},{key:"drawArea",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:xo,a=this.mapViewer,o=this,u=this._concatGid(e.area,this.data.id);a.drawer.create.drawPolygon({gid:u,attr:{id:this.data.id},onFinish:function(l){l&&o.setArea(l),r(l)}})}},{key:"clearArea",value:function(){var r=this.mapViewer.drawer,a=this.getArea();this.deleteEntity("area"),r.remove.one(a.data)}},{key:"setVisible",value:function(r){return X(O(e.prototype),"setVisible",this).call(this,r),this}},{key:"setAreaVisible",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=this.mapViewer.drawer,o=this.getEntity("area");o&&a.updateObjectVisible(o.gid,r)}}]),e}(Le);d(k,"mapViewer",null),d(k,"model","$CAMERA"),d(k,"icon","$ICON_CAMERA"),d(k,"area","$AREA_CAMERA"),d(k,"_getModelInstance",function(i){if(!i)return null;if(!!k.mapViewer){var n=k.mapViewer.model,e=n.getAdapter(),t=e.getSelector();return t.selectEntityById(i.attr.id)}}),d(k,"modelClickHandler",function(i){var n=k._getModelInstance(i);n&&n.flyTo()}),d(k,"modelDoubleClickHandler",function(i){var n=k._getModelInstance(i);n&&n.flyTo()}),d(k,"iconClickHandler",function(i){var n=k._getModelInstance(i);n&&n.flyTo()}),d(k,"iconDoubleClickHandler",function(i){var n=k._getModelInstance(i);n&&n.flyTo()}),d(k,"areaClickHandler",function(i){var n=k._getModelInstance(i);n&&n.flyTo()}),d(k,"areaDoubleClickHandler",function(i){var n=k._getModelInstance(i);n&&n.flyTo()});function Ko(i){var n=Go();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function Go(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qo=function(i){ee(e,i);var n=Ko(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="CAMERA",r.categoryName="\u76D1\u63A7",r.type=zt,r.typeName="\u67AA\u673A",r.fileName="qiangji",r.create(),r}return R(e)}(k);function Wo(i){var n=zo();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function zo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Yo=function(i){ee(e,i);var n=Wo(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="CAMERA",r.categoryName="\u76D1\u63A7",r.type=Yt,r.typeName="\u7403\u673A",r.fileName="qiuji",r.create(),r}return R(e)}(k);function Jo(i){var n=Xo();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function Xo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Zo=function(i){ee(e,i);var n=Jo(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="CAMERA",r.categoryName="\u76D1\u63A7",r.type=Jt,r.typeName="\u534A\u7403",r.fileName="banqiu",r.create(),r}return R(e)}(k);function Qo(i){var n=eu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function eu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tu=function(i){ee(e,i);var n=Qo(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="CAMERA",r.categoryName="\u76D1\u63A7",r.type=tr,r.typeName="\u4EBA\u8138",r.fileName="qiangji",r.create(),r}return R(e)}(k);function ru(i){var n=nu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function nu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var iu=function(i){ee(e,i);var n=ru(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="CAMERA",r.categoryName="\u76D1\u63A7",r.type=Xt,r.typeName="\u5361\u53E3",r.fileName="qiangji",r.create(),r}return R(e)}(k);function au(i){var n=ou();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function ou(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var F=function(i){ee(e,i);var n=au(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),e.mapViewer=t,r.category=e.model,r.categoryName="\u95E8\u7981",r.type=Ze,r.typeName="\u95E8\u7981",r.fileName="menjin",r.create(),r}return R(e,[{key:"create",value:function(){var r,a=this,o=this,u=this.config,s=this.data||{},l=this.mapViewer.drawer,f=this.mapViewer.event,c=l.config.model({attr:{id:s.id},gid:this._concatGid(e.model,s.id),fileName:this.fileName,scale:1,location:(s==null||(r=s.options)===null||r===void 0?void 0:r.location)||null}),g=l.config.image({attr:{id:s.id},gid:this._concatGid(e.icon,s.id),style:this.fileName+"_icon",location:o.getIconLocation(c==null?void 0:c.location)});u.draw?f.setMousePositionCallback(function(m){c.location=m,g.location=o.getIconLocation(m),l.create.image(g),l.create.model(c,!0).then(function(w){u.onSuccess(w)}),o.setModel(c),o.setIcon(g),a.markVisible(!0)}):(o.setModel(c),o.setIcon(g),u.onMap&&(l.create.model(c),l.create.image(g,!0),this.markVisible(!0)))}},{key:"flyTo",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{speed:40,showLocation:!1};return X(O(e.prototype),"flyTo",this).call(this,r),this}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X(O(e.prototype),"update",this).call(this,r),this}},{key:"setVisible",value:function(r){return X(O(e.prototype),"setVisible",this).call(this,r),this}}]),e}(Le);d(F,"mapViewer",null),d(F,"model","$DOOR"),d(F,"icon","$ICON_DOOR"),d(F,"_getModelInstance",function(i){if(!i)return null;if(!!F.mapViewer){var n=F.mapViewer.model,e=n.getDeviceAdapter(),t=e.getSelector();return t.selectEntityById(i.attr.id)}}),d(F,"modelClickHandler",function(i){console.log(i);var n=F._getModelInstance(i);n&&n.flyTo()}),d(F,"modelDoubleClickHandler",function(i){console.log(i);var n=F._getModelInstance(i);n&&n.flyTo()}),d(F,"iconClickHandler",function(i){console.log(i);var n=F._getModelInstance(i);n&&n.flyTo()}),d(F,"iconDoubleClickHandler",function(i){console.log(i);var n=F._getModelInstance(i);n&&n.flyTo()});function uu(i){var n=su();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function su(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var lu=function(i){ee(e,i);var n=uu(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="DOOR",r.categoryName="\u95E8\u7981",r.type=Zt,r.typeName="\u6D77\u5EB7\u4EBA\u8138\u8BC6\u522B\u4E00\u4F53\u673A",r.fileName="menjin",r.create(),r}return R(e)}(F);function cu(i){var n=fu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function fu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var T=function(i){ee(e,i);var n=cu(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),e.mapViewer=t,r.category=e.model,r.categoryName="\u5BF9\u8BB2",r.type=Ze,r.typeName="\u5BF9\u8BB2",r.fileName="duijiang",r.create(),r}return R(e,[{key:"create",value:function(){var r,a=this,o=this,u=this.config,s=this.data||{},l=this.mapViewer.drawer,f=this.mapViewer.event,c=l.config.model({attr:{id:s.id},gid:this._concatGid(e.model,s.id),fileName:this.fileName,scale:1,location:(s==null||(r=s.options)===null||r===void 0?void 0:r.location)||null}),g=l.config.image({attr:{id:s.id},gid:this._concatGid(e.icon,s.id),style:this.fileName+"_icon",location:o.getIconLocation(c==null?void 0:c.location)});u.draw?f.setMousePositionCallback(function(m){c.location=m,g.location=o.getIconLocation(m),l.create.image(g),l.create.model(c,!0).then(function(w){u.onSuccess(w)}),o.setModel(c),o.setIcon(g),a.markVisible(!0)}):(o.setModel(c),o.setIcon(g),u.onMap&&(l.create.model(c),l.create.image(g,!0),this.markVisible(!0)))}},{key:"flyTo",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{speed:40,showLocation:!1};return X(O(e.prototype),"flyTo",this).call(this,r),this}},{key:"update",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X(O(e.prototype),"update",this).call(this,r),this}},{key:"setVisible",value:function(r){return X(O(e.prototype),"setVisible",this).call(this,r),this}}]),e}(Le);d(T,"mapViewer",null),d(T,"model","$INTERCOM"),d(T,"icon","$ICON_INTERCOM"),d(T,"_getModelInstance",function(i){if(!i)return null;if(!!T.mapViewer){var n=T.mapViewer.model,e=n.getDeviceAdapter(),t=e.getSelector();return t.selectEntityById(i.attr.id)}}),d(T,"modelClickHandler",function(i){console.log(i);var n=T._getModelInstance(i);n&&n.flyTo()}),d(T,"modelDoubleClickHandler",function(i){console.log(i);var n=T._getModelInstance(i);n&&n.flyTo()}),d(T,"iconClickHandler",function(i){console.log(i);var n=T._getModelInstance(i);n&&n.flyTo()}),d(T,"iconDoubleClickHandler",function(i){console.log(i);var n=T._getModelInstance(i);n&&n.flyTo()});function du(i){var n=vu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function vu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hu=function(i){ee(e,i);var n=du(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="INTERCOM",r.categoryName="\u5BF9\u8BB2",r.type=Qt,r.typeName="\u6D77\u5EB7\u5BF9\u8BB2\u5BA4\u5185\u7EC8\u7AEF",r.fileName="duijiang",r.create(),r}return R(e)}(T);function gu(i){var n=pu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function pu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mu=function(i){ee(e,i);var n=gu(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.category="INTERCOM",r.categoryName="\u5BF9\u8BB2",r.type=er,r.typeName="\u6D77\u5EB7\u5BF9\u8BB2\u5BA4\u5916\u7EC8\u7AEF",r.fileName="duijiang",r.create(),r}return R(e)}(T);function yu(i){var n=bu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function bu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wu=function(i){ee(e,i);var n=yu(e);function e(t){var r;I(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return r=n.call.apply(n,[this,t].concat(o)),r.type=Qe.image.typeName,r.typeName="image",r.$$typeof="IMAGE",r.create(),r}return R(e,[{key:"create",value:function(){X(O(e.prototype),"create",this).call(this)}},{key:"flyTo",value:function(r){X(O(e.prototype),"flyTo",this).call(this,r)}},{key:"setVisible",value:function(r){X(O(e.prototype),"setVisible",this).call(this,r)}}]),e}(Le),Cu=function(n){var e=Le,t=n.category_id,r=n.type;if(t!==void 0)switch(t){case Wt:e=k;break;case zt:e=qo;break;case Yt:e=Yo;break;case Jt:e=Zo;break;case tr:e=tu;break;case Xt:e=iu;break;case Ze:e=F;break;case Bn:e=T;break;case Qt:e=hu;break;case er:e=mu;break;case Zt:e=lu;break}else if(r!==void 0)switch(r){case Qe.image.typeName:e=wu;break}return e},Ou=function(){function i(n){I(this,i),this.mapViewer=n}return R(i,[{key:"create",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne,r=Cu(e);if(r)return new r(this.mapViewer,e,t);console.warn("device category of ".concat(e.categoryId,", is not support yet."))}}]),i}();function Wn(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function zn(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Wn(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Wn(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var _u=Ae,Yn=se,ku=Nt,Jn=R(function i(n){var e=this;I(this,i),d(this,"addOne",function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne;return new Ou(e.mapViewer).create(t,r)}),d(this,"updateOne",function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t==null||t.update(r)}),d(this,"deleteOne",function(t){t==null||t.destroy()}),d(this,"addMany",function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rr,a=e.mapViewer,o=a.drawer;r=Object.assign({},{size:200,onSuccess:Yn,onProgress:Yn},r);var u=r,s=u.size,l=u.onSuccess,f=u.onProgress;if(!_u(t)){console.error("type source must be an array, got "+ku(t));return}var c=+new Date,g=t.length,m=function w(C){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=t.slice(C,L);if(C>g-1){var S=+new Date;f&&f({progress:100}),console.log("\u52A0\u8F7D ".concat(g," \u4E2A\u6A21\u578B,\u5171\u8017\u65F6: ").concat((S-c)/1e3,"s. ")),l&&l();return}o.overLayerCreateObjects(E).then(function(){C<g&&(f&&f({progress:Math.floor(Math.pow(10,4)*(C/g)/100)}),w(L,L+s))}).catch(function(V){console.error(V)})};m(0,s)}),d(this,"updateMany",function(t,r){var a=t.reduce(function(o,u){return o.push.apply(o,Me(u.getAllEntities().map(function(s){return zn(zn({},s.data),r)}))),u.markVisible(r.visible),o},[]);e.mapViewer.core.view3d.SetObjectsVisible(a)}),d(this,"deleteMany",function(){}),this.mapViewer=n});function ke(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Eu(i))||n&&i&&typeof i.length=="number"){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Eu(i,n){if(!!i){if(typeof i=="string")return Xn(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Xn(i,n)}}function Xn(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function Zn(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function ue(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?Zn(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Zn(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var et=Ae,Su=function(){function i(n){var e=this;I(this,i),d(this,"getSelector",function(){return e.selector}),d(this,"getController",function(){return e.controller}),d(this,"getInitialState",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Object.assign({},e.entity,t)}),d(this,"addOne",function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};r=ue(ue({},Ne),r);var a=t.id;e.entity.ids.add(t.id);var o=e.getController().addOne(t,r);return e.entity.data.set(a,o),o}),d(this,"addMany",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!et(t)){console.warn("addMany take array  as only argument.");return}r=ue(ue({},rr),r);var a=[];if(r.instance){var o=ke(t),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=e.addOne(s,ue(ue({},Ne),{},{onMap:!1}));a.push(l)}}catch(m){o.e(m)}finally{o.f()}}else a=t;if(r.onMap){var f=e.getSelector(),c=f.selectMapEntity,g=c(a);e.controller.addMany(g,ue(ue({},r),{},{onSuccess:function(){if(!r.instance){var w=ke(t),C;try{for(w.s();!(C=w.n()).done;){var L=C.value;L.$$typeof===xn&&(L.markVisible(!0),L.markCreated(!0))}}catch(E){w.e(E)}finally{w.f()}}}}))}return e}),d(this,"setAll",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!et(t)){console.warn("setAll take array  as only argument.");return}var a=ue(ue(ue({},rr),r),{},{isFirst:!0});return e.removeAll(),e.addMany(t,a),e}),d(this,"removeOne",function(t){if(!!t){var r=e.getSelector().selectEntityById(t);return e.getController().deleteOne(r),e.entity.ids.delete(t),e.entity.data.delete(t),e}}),d(this,"removeMany",function(t){if(!et(t)){console.warn("removeMany take array  as only argument.");return}var r=ke(t),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;e.removeOne(o)}}catch(u){r.e(u)}finally{r.f()}return e}),d(this,"removeAll",function(){return e.removeMany(Array.from(e.entity.ids)),e.entity.ids.clear(),e.entity.data.clear(),e}),d(this,"upsertOne",function(t){return e.getSelector().selectDataById(t.id)?e.updateOne(t):e.addOne(t),e}),d(this,"upsertMany",function(t){var r=ke(t),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;e.upsertOne(o)}}catch(u){r.e(u)}finally{r.f()}return e}),d(this,"updateOne",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{data:null,config:{},changes:null},r=t.data,a=t.config;if(!(!r||!r.id)){a=ue(ue({},Ne),a);var o=e.getSelector().selectEntityById(r.id);if(o)if(o.data.category_id===r.category_id)e.getController().updateOne(o,t);else return e.removeOne(r.id),e.addOne(r,a);else console.warn("Can not update for Id: ".concat(r.id,", because it's instance don't exist."))}}),d(this,"updateMany",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(!et(t)){console.warn("updateMany take Array as only argument.");return}var r=ke(t),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;e.updateOne(o)}}catch(u){r.e(u)}finally{r.f()}return e}),this.entity={ids:new Set,data:new Map},this.mapViewer=n,this.selector=new Fo(this.entity),this.controller=new Jn(this.mapViewer)}return R(i,[{key:"setVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={visible:!0,outdoor:!0,buildId:"",floorId:""},r=Object.assign({},t,e),a=r.outdoor,o=r.buildId,u=r.floorId,s=this.getSelector(),l=[];o&&!u?l=s.filterEntityByBuilding(o):o&&u&&(l=s.filterEntityByFloor(o,u)),a&&(l=l.concat(s.filterOutDoorEntities())),l=l.filter(function(p){return p.data.on_map});var f=[],c=[],g=[],m=this.getVisible(),w=ke(m),C;try{var L=function(){var U=C.value,H=l.find(function(Z){return Z.id===U.id});H||g.push(U)};for(w.s();!(C=w.n()).done;)L()}catch(p){w.e(p)}finally{w.f()}var E=ke(l),S;try{var V=function(){var U=S.value;if(U.created){var H=m.find(function(Z){return Z.id===U.id});H||c.push(U)}};for(E.s();!(S=E.n()).done;)V()}catch(p){E.e(p)}finally{E.f()}return l.forEach(function(p){p.created||f.push(p)}),f&&f.length>0&&this.addMany(f,{onMap:!0,instance:!1}),c&&c.length>0&&this.getController().updateMany(c,{visible:!0}),g&&g.length>0&&this.getController().updateMany(g,{visible:!1}),this}},{key:"getVisible",value:function(){var e=this.getSelector();return e.selectEntities().filter(function(t){return t.visible})}}]),i}();function Qn(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Iu(i))||n&&i&&typeof i.length=="number"){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Iu(i,n){if(!!i){if(typeof i=="string")return ei(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ei(i,n)}}function ei(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function ti(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function ir(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?ti(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):ti(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var Au=le,W={isOnce:!1,defaultAction:!0},ar=function(){function i(n){I(this,i),d(this,"listen",function(){}),this.mapViewer=n,this.events=new Map,this.config=ir({},W)}return R(i,[{key:"config",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:W;this.config=ir(ir({},W),e)}},{key:"getConfig",value:function(e){var t=this.events.get(e);return t?t.get("config"):null}},{key:"subscribe",value:function(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:W,a=this.events.get(e),o=new Map;if(o.set("callback",t),o.set("config",r),a){var u=a.get("queue");u.add(o),a.set("config",r)}else{var s=new Map,l=new Set;l.add(o),s.set("queue",l),s.set("config",r),this.events.set(e,s)}}},{key:"unsubscribe",value:function(e,t){var r=this.events.get(e);if(r){var a=r.get("queue"),o=Qn(a.values()),u;try{for(o.s();!(u=o.n()).done;){var s=u.value;s.get("callback")===t&&a.delete(s)}}catch(l){o.e(l)}finally{o.f()}a.size===0&&this.events.delete(e)}}},{key:"dispatch",value:function(e){var t=this.events.get(e);if(t){for(var r=t.get("queue"),a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];var s=Qn(r.values()),l;try{for(s.s();!(l=s.n()).done;){var f=l.value,c=f.get("callback"),g=f.get("config");Au(c)&&c.apply(void 0,o),g&&g.isOnce&&this.unsubscribe(e,c)}}catch(m){s.e(m)}finally{s.f()}}}},{key:"clear",value:function(){this.events.clear()}},{key:"onClick",value:function(e){}},{key:"offClick",value:function(e){}},{key:"onDoubleClick",value:function(e){}},{key:"offDoubleClick",value:function(e){}},{key:"onIconClick",value:function(e){}},{key:"offIconClick",value:function(e){}},{key:"onIconDoubleClick",value:function(e){}},{key:"offIconDoubleClick",value:function(e){}},{key:"onMouseIn",value:function(){}},{key:"onMouseOut",value:function(){}},{key:"_modelClickHandler",value:function(){}},{key:"_modelDoubleClickHandler",value:function(){}},{key:"_iconClickHandler",value:function(){}},{key:"_iconDoubleClickHandler",value:function(){}}]),i}();function Lu(i){var n=Ru();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function Ru(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Re=function(i){ee(e,i);var n=Lu(e);function e(t){var r;return I(this,e),r=n.call(this,t),d(q(r),"listen",function(){var a=r.mapViewer.event;a.onClick(k.model,r._modelClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(k.model)}}),a.onDoubleClick(k.model,r._modelDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(k.model)}}),a.onClick(k.icon,r._iconClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(k.icon)}}),a.onDoubleClick(k.icon,r._iconDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(k.icon)}}),a.onClick(k.area,r._areaClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(k.area)}}),a.onDoubleClick(k.area,r._areaDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(k.area)}})}),r.listen(),r}return R(e,[{key:"_modelClickHandler",value:function(r){var a=this.getConfig(e.MODEL_CLICK);if(a){var o=a.defaultAction;o&&k.modelClickHandler(r),this.dispatch(e.MODEL_CLICK,r)}}},{key:"_modelDoubleClickHandler",value:function(r){var a=this.getConfig(e.MODEL_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&k.modelDoubleClickHandler(r),this.dispatch(e.MODEL_DOUBLE_CLICK,r)}}},{key:"_iconClickHandler",value:function(r){var a=this.getConfig(e.ICON_CLICK);if(a){var o=a.defaultAction;o&&k.iconClickHandler(r),this.dispatch(e.ICON_CLICK,r)}}},{key:"_iconDoubleClickHandler",value:function(r){var a=this.getConfig(e.ICON_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&k.iconDoubleClickHandler(r),this.dispatch(e.ICON_DOUBLE_CLICK,r)}}},{key:"_areaClickHandler",value:function(r){var a=this.getConfig(e.AREA_CLICK);if(a){var o=a.defaultAction;o&&k.areaClickHandler(r),this.dispatch(e.AREA_CLICK,r)}}},{key:"_areaDoubleClickHandler",value:function(r){var a=this.getConfig(e.AREA_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&k.areaDoubleClickHandler(r),this.dispatch(e.AREA_DOUBLE_CLICK,r)}}},{key:"clear",value:function(){}},{key:"onClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.MODEL_CLICK,r,a)}},{key:"offClick",value:function(r){this.unsubscribe(e.MODEL_CLICK,r)}},{key:"onDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.MODEL_DOUBLE_CLICK,r,a)}},{key:"offDoubleClick",value:function(r){this.unsubscribe(e.MODEL_DOUBLE_CLICK,r)}},{key:"onIconClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.ICON_CLICK,r,a)}},{key:"offIconClick",value:function(r){this.unsubscribe(e.ICON_DOUBLE_CLICK,r)}},{key:"onIconDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.ICON_DOUBLE_CLICK,r,a)}},{key:"offIconDoubleClick",value:function(r){this.unsubscribe(e.ICON_DOUBLE_CLICK,r)}},{key:"onAreaClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.AREA_CLICK,r,a)}},{key:"offAreaClick",value:function(r){this.unsubscribe(e.AREA_CLICK,r)}},{key:"onAreaDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.AREA_DOUBLE_CLICK,r,a)}},{key:"offAreaDoubleClick",value:function(r){this.unsubscribe(e.AREA_DOUBLE_CLICK,r)}}]),e}(ar);d(Re,"MODEL_CLICK","MODEL_CLICK"),d(Re,"MODEL_DOUBLE_CLICK","MODEL_DOUBLE_CLICK"),d(Re,"ICON_CLICK","ICON_CLICK"),d(Re,"ICON_DOUBLE_CLICK","ICON_DOUBLE_CLICK"),d(Re,"AREA_CLICK","AREA_CLICK"),d(Re,"AREA_DOUBLE_CLICK","AREA_DOUBLE_CLICK");function Du(i){var n=Mu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function Mu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tt=function(i){ee(e,i);var n=Du(e);function e(t){var r;return I(this,e),r=n.call(this,t),d(q(r),"listen",function(){var a=r.mapViewer.event;a.onClick(F.model,r._modelClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(F.model)}}),a.onDoubleClick(F.model,r._modelDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(F.model)}}),a.onClick(F.icon,r._iconClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(F.icon)}}),a.onDoubleClick(F.icon,r._iconDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(F.icon)}})}),r.listen(),r}return R(e,[{key:"_modelClickHandler",value:function(r){var a=this.getConfig(e.MODEL_CLICK);if(a){var o=a.defaultAction;o&&F.modelClickHandler(r),this.dispatch(e.MODEL_CLICK,r)}}},{key:"_modelDoubleClickHandler",value:function(r){var a=this.getConfig(e.MODEL_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&F.modelDoubleClickHandler(r),this.dispatch(e.MODEL_DOUBLE_CLICK,r)}}},{key:"_iconClickHandler",value:function(r){var a=this.getConfig(e.ICON_CLICK);if(a){var o=a==null?void 0:a.defaultAction;o&&F.iconClickHandler(r),this.dispatch(e.ICON_CLICK,r)}}},{key:"_iconDoubleClickHandler",value:function(r){var a=this.getConfig(e.ICON_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&F.iconDoubleClickHandler(r),this.dispatch(e.ICON_DOUBLE_CLICK,r)}}},{key:"onClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.MODEL_CLICK,r,a)}},{key:"offClick",value:function(r){this.unsubscribe(e.MODEL_CLICK,r)}},{key:"onDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.MODEL_DOUBLE_CLICK,r,a)}},{key:"offDoubleClick",value:function(r){this.unsubscribe(e.MODEL_DOUBLE_CLICK,r)}},{key:"onIconClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.ICON_CLICK,r,a)}},{key:"offIconClick",value:function(r){this.unsubscribe(e.ICON_DOUBLE_CLICK,r)}},{key:"onIconDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.ICON_DOUBLE_CLICK,r,a)}},{key:"offIconDoubleClick",value:function(r){this.unsubscribe(e.ICON_DOUBLE_CLICK,r)}}]),e}(ar);d(tt,"MODEL_CLICK","MODEL_CLICK"),d(tt,"MODEL_DOUBLE_CLICK","MODEL_DOUBLE_CLICK"),d(tt,"ICON_CLICK","ICON_CLICK"),d(tt,"ICON_DOUBLE_CLICK","ICON_DOUBLE_CLICK");function Bu(i){var n=Pu();return function(){var t=O(i),r;if(n){var a=O(this).constructor;r=Reflect.construct(t,arguments,a)}else r=t.apply(this,arguments);return te(this,r)}}function Pu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var rt=function(i){ee(e,i);var n=Bu(e);function e(t){var r;return I(this,e),r=n.call(this,t),d(q(r),"listen",function(){var a=r.mapViewer.event;a.onClick(T.model,r._modelClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(T.model)}}),a.onDoubleClick(T.model,r._modelDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(T.model)}}),a.onClick(T.icon,r._iconClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(T.icon)}}),a.onDoubleClick(T.icon,r._iconDoubleClickHandler.bind(q(r)),{compare:function(u,s){return s.startsWith(T.icon)}})}),r.listen(),r}return R(e,[{key:"_modelClickHandler",value:function(r){var a=this.getConfig(e.MODEL_CLICK);if(a){var o=a.defaultAction;o&&T.modelClickHandler(r),this.dispatch(e.MODEL_CLICK,r)}}},{key:"_modelDoubleClickHandler",value:function(r){var a=this.getConfig(e.MODEL_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&T.modelDoubleClickHandler(r),this.dispatch(e.MODEL_DOUBLE_CLICK,r)}}},{key:"_iconClickHandler",value:function(r){var a=this.getConfig(e.ICON_CLICK);if(a){var o=a.defaultAction;o&&T.iconClickHandler(r),this.dispatch(e.ICON_CLICK,r)}}},{key:"_iconDoubleClickHandler",value:function(r){var a=this.getConfig(e.ICON_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&T.iconDoubleClickHandler(r),this.dispatch(e.ICON_DOUBLE_CLICK,r)}}},{key:"onClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.MODEL_CLICK,r,a)}},{key:"offClick",value:function(r){this.unsubscribe(e.MODEL_CLICK,r)}},{key:"onDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.MODEL_DOUBLE_CLICK,r,a)}},{key:"offDoubleClick",value:function(r){this.unsubscribe(e.MODEL_DOUBLE_CLICK,r)}},{key:"onIconClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.ICON_CLICK,r,a)}},{key:"offIconClick",value:function(r){this.unsubscribe(e.ICON_DOUBLE_CLICK,r)}},{key:"onIconDoubleClick",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:W;this.subscribe(e.ICON_DOUBLE_CLICK,r,a)}},{key:"offIconDoubleClick",value:function(r){this.unsubscribe(e.ICON_DOUBLE_CLICK,r)}}]),e}(ar);d(rt,"MODEL_CLICK","MODEL_CLICK"),d(rt,"MODEL_DOUBLE_CLICK","MODEL_DOUBLE_CLICK"),d(rt,"ICON_CLICK","ICON_CLICK"),d(rt,"ICON_DOUBLE_CLICK","ICON_DOUBLE_CLICK");var ju=R(function i(n,e){var t=this;I(this,i),d(this,"getEvent",function(){return t.event}),d(this,"getController",function(){return t.controller}),d(this,"getAdapter",function(){return t.adapter}),this.view3d=n,this.mapViewer=e,this.adapter=new Su(this.mapViewer),this.category=Pn,this.controller=new Jn(e)}),_e=le,Nu=function(){function i(n){I(this,i),this.view3d=n}return R(i,[{key:"isBuildWK",value:function(e){return/^V[\d]+_JZ[\d]+_WK$/.test(e)}},{key:"isBuildTitle",value:function(e){return/^MP_V[\d]+_JZ[\d]+_WK_?[\d]?$/.test(e)&&this.isBuildFloor(e)===!1}},{key:"isBuildFloor",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_[FWMB][\d]+$/.test(e)}},{key:"isBuildXP",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_XP[\d]*$/.test(e)}},{key:"isFloorXP",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_[FWMB][\d]+_XP[\d]*$/.test(e)}},{key:"isFloorRoom",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_[FWMB][\d]+_[U][\d]+_[H][\d]+$/.test(e)}},{key:"getBuildIdByWKGid",value:function(e){return e.replace(/_WK.*/,"")}},{key:"getBuildGidByBuildId",value:function(e){return e.replace(/JZ([\d]+)(_?)/,"JZ$1_WK$2")}},{key:"getBuildIdByTitleGid",value:function(e){return e.replace(/_WK.*/,"").replace(/MP_/,"")}},{key:"getBuildIdByFloorGid",value:function(e){return e.replace(/_WK.*/,"")}},{key:"getBuildIdByRoomGid",value:function(e){return e.split("_WK")[0]}},{key:"getFloorIdByRoomGid",value:function(e){var t=e.split("_");return"".concat(t[0],"_").concat(t[1],"_").concat(t[3])}},{key:"getFloorIdByFloorGid",value:function(e){return e.replace(/_WK/,"")}},{key:"getFloorNameByFloorId",value:function(e){return e.split("_")[2]}},{key:"getFloorNameSmallByFloorGId",value:function(e){var t=this.getFloorIdByFloorGid(e);return this.getFloorNameSmallByFloorId(t)}},{key:"getFloorNameSmallByFloorId",value:function(e){return this.getFloorNameByFloorId(e).replace(/([A-Z]*)[0]*([1-9][\d]*)/,"$1$2")}},{key:"getF001toF1",value:function(e){return e.replace(/([\w])[0]*([\d]+)/,"$1$2")}},{key:"resetBuild",value:function(e){this.splitBuildingResetSync(e),this.view3d.ResetObjects()}},{key:"splitFloor",value:function(e,t,r){this.view3d&&this.view3d.SplitDynamicFloor(e,t,r)}},{key:"getBuildingNum",value:function(e){_e(e)===!0?this.view3d.GetBuildingNum(function(t){e&&e(t)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getBuildingNames",value:function(e){_e(e)===!0?this.view3d.GetBuildingNames(function(t){e&&e(t)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getBuildingNamesSync",value:function(){return G(this.view3d,this.view3d.GetBuildingNames)}},{key:"getBuildingVisible",value:function(e,t){_e(t)===!0?this.view3d.GetBuildingVisible(e,function(r){t&&t(r)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"setBuildingVisible",value:function(e,t,r){return j(100,this.view3d,this.view3d.SetBuildingVisible,e,t,r)}},{key:"setBuildingWKVisible",value:function(e,t,r){this.view3d.SetBuildingWkVisible(e,t,r)}},{key:"resetAllBuildings",value:function(){return j(10,this.view3d,this.view3d.ResetAllBuildings)}},{key:"splitBuilding",value:function(e,t){this.view3d.SplitBuilding(e,t)}},{key:"splitBuildingReset",value:function(e){this.view3d.SplitBuildingReset(e)}},{key:"splitBuildingResetSync",value:function(e){return j(20,this.view3d,this.view3d.SplitBuildingReset,e)}},{key:"splitDynamicBuilding",value:function(e,t){this.view3d.SplitDynamicBuilding(e,t)}},{key:"splitDynamicFloor",value:function(e,t,r){this.view3d.SplitDynamicFloor(e,t,r)}},{key:"splitFloorReset",value:function(e,t){return this.view3d.SplitFloorReset(e,t)}},{key:"getFloorNum",value:function(e,t){_e(t)===!0?this.view3d.GetFloorNum(function(r){t&&t(r)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getFloorNames",value:function(e,t){console.log("call getFloorNames: ",e),console.log(_e(t)),_e(t)?this.view3d.GetFloorNames(e,t):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getFloorNamesSync",value:function(e){return G(this.view3d,this.view3d.GetFloorNames,e)}},{key:"getFloorVisible",value:function(e,t,r){_e(r)===!0?this.view3d.GetFloorVisible(e,t,function(a){r&&r(a)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"setFloorVisible",value:function(e,t,r,a){return j(10,this.view3d,this.view3d.SetFloorVisible,e,t,r,a)}},{key:"getUpFloorNum",value:function(e,t,r){_e(r)===!0?this.view3d.GetUpFloorNum(e,t,function(a){r&&r(a)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getUpFloorNames",value:function(e,t,r){this.view3d.GetUpFloorNames(e,t,function(a){r&&r(a)})}},{key:"getDownFloorNum",value:function(e,t,r){this.view3d.GetDownFloorNum(e,t,function(a){r&&r(a)})}},{key:"GetDownFloorNames",value:function(e,t,r){this.view3d.GetDownFloorNum(e,t,function(a){r&&r(a)})}},{key:"getFloorRoomNum",value:function(e,t,r){this.view3d.GetFloorRoomNum(e,t,function(a){r&&r(a)})}},{key:"getFloorRoomNames",value:function(e,t,r){return G(this.view3d,this.view3d.GetFloorRoomNames,e,t)}},{key:"getFloorRoomVisible",value:function(e,t,r,a){this.view3d.GetFloorRoomVisible(e,t,r,function(o){a&&a(o)})}},{key:"setFloorRoomVisible",value:function(e,t,r,a){this.view3d.SetFloorRoomVisible(e,t,r,a)}},{key:"setGroundVisible",value:function(){var n=z(B.mark(function t(r){return B.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",j(10,this.view3d,this.view3d.SetGroundVisible,r));case 1:case"end":return o.stop()}},t,this)}));function e(t){return n.apply(this,arguments)}return e}()}]),i}();function ri(i,n){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);n&&(t=t.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),e.push.apply(e,t)}return e}function ni(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?arguments[n]:{};n%2?ri(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):ri(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function or(i,n){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Tu(i))||n&&i&&typeof i.length=="number"){e&&(i=e);var t=0,r=function(){};return{s:r,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Tu(i,n){if(!!i){if(typeof i=="string")return ii(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ii(i,n)}}function ii(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}var re=le,ai=se,oi=hn,ui=ot,si=yr,ur=1,sr=2,nt="zoomIn",it="zoomOut",at="mousemove",Te=ur,lr=null,cr=[nt,it,at],li={prefix:"",isDouble:!1,compare:oi,isOnce:!1,internal:!1,key:+new Date},Fu=function(){function i(n,e){I(this,i),d(this,"_flushDragCallback",function(t,r){t.size>0&&t.forEach(function(a){a(r)})}),this._view3d=n,this.mapViewer=e,this.prefix="*",this.debugger=!1,this.prefixAndCallbackMap=new Map,this._lastClickTimestamp=+new Date,this._emitMouseUp=!1,this._addMouseMoveEvent(),this._addMouseUpEvent(),this._addMouseDownEvent(),this._hasRegisterMouseWheelHandler=!1,this.cleanupCallback=null,this._clickCallbackTimer=new Map,this._onDragHandler=new Set,this._onDragStartHandler=new Set,this._onDragEndHandler=new Set,this._dragTicker=150}return R(i,[{key:"_handleMouseMove",value:function(e){var t=this;Te===ur&&this._flushDragCallback(this._onDragStartHandler,e),Te=sr,lr&&clearTimeout(lr),this._flushDragCallback(this._onDragHandler,e),lr=setTimeout(function(){t._emitMouseUp||t._handleMouseUp()},100)}},{key:"_handleMouseDown",value:function(){}},{key:"_handleMouseUp",value:function(){Te===sr&&this._flushDragCallback(this._onDragEndHandler),Te=ur}},{key:"_registerMouseEvent",value:function(e,t){var r=this.mapViewer.core.config.id,a=document.getElementById(r);a.addEventListener(e,t)}},{key:"_removeMouseEvent",value:function(e,t){var r=cr.filter(function(l){return l===e})[0];if(r){var a=this.prefixAndCallbackMap.get(r);if(a){var o=this.getCallbacks(e)[0].callback;if(this._removeCacheCallback(e,t),!this.prefixAndCallbackMap.get(nt)&&!this.prefixAndCallbackMap.get(it)||e===at){var u=this.mapViewer.core.config.id,s=document.getElementById(u);s.removeEventListener(e,o)}}}}},{key:"_registerMouseWheelCallback",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"mousewheel",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ai;this._hasRegisterMouseWheelHandler||(this._registerMouseEvent(e,t),this._hasRegisterMouseWheelHandler=!0)}},{key:"_mouseWheelHandler",value:function(e){var t=this,r=e.wheelDelta,a="";r>0?a=nt:r<0&&(a=it),a&&this.mapViewer.camera&&this.mapViewer.camera.getCurrentPosition&&this.mapViewer.camera.getCurrentPosition().then(function(o){var u=t.prefixAndCallbackMap.get(a);if(u){var s=u.get("callback"),l=s.get("click");l.forEach(function(f){f.get("config").compare&&f.get("config").compare(e,o)})}})}},{key:"getCallbacks",value:function(e){var t=this.prefixAndCallbackMap.get(e);if(t)return Array.from(t.get("callback").click).map(function(r){return Object.fromEntries(r)})}},{key:"setDragTicker",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:150;this._dragTicker=e}},{key:"zoomIn",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{debounce:!0,debounceTime:300};if(re(e)){var r=this._mouseWheelHandler.bind(this);t.debounce&&(r=ui(this._mouseWheelHandler.bind(this),t.debounceTime||300,!1)),this._cacheCallback(nt,r,{isOnce:!1,compare:e,internal:!1}),this._registerMouseWheelCallback("mousewheel",r)}}},{key:"zoomOut",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{debounce:!0,debounceTime:300};if(re(e)){var r=this._mouseWheelHandler.bind(this);t.debounce&&(r=ui(this._mouseWheelHandler.bind(this),t.debounceTime||300,!1)),this._cacheCallback(it,r,{isOnce:!1,compare:e,internal:!1}),this._registerMouseWheelCallback("mousewheel",r)}}},{key:"onMouseMove",value:function(e){var t=si(function(r){console.log(r)},500);this._cacheCallback(at,t,{isOnce:!1,compare:e,internal:!1}),this._registerMouseEvent(at,t)}},{key:"onDrag",value:function(e){re(e)&&this._onDragHandler.add(e)}},{key:"onDragStart",value:function(e){re(e)&&this._onDragStartHandler.add(e)}},{key:"onDragEnd",value:function(e){re(e)&&this._onDragEndHandler.add(e)}},{key:"removeDrag",value:function(e){re(e)&&this._onDragHandler.delete(e)}},{key:"removeDragStart",value:function(e){re(e)&&this._onDragStartHandler.delete(e)}},{key:"removeDragEnd",value:function(e){re(e)&&this._onDragEndHandler.delete(e)}},{key:"removeMouseEvent",value:function(){this._view3d&&h(this._view3d,"UnRegisterEvent")&&this._view3d.UnRegisterEvent()}},{key:"_addMouseMoveEvent",value:function(){var e=this._view3d;h(e,"RegisterEvent")&&si(this._handleMouseMove.bind(this),100)}},{key:"_addMouseDownEvent",value:function(){var e=this._view3d;h(e,"RegisterEvent")}},{key:"_addMouseUpEvent",value:function(){var e=this._view3d;h(e,"RegisterEvent")}},{key:"_resetMouseCallback",value:function(){this.prefix="*";var e=or(this.prefixAndCallbackMap.keys()),t;try{for(e.s();!(t=e.n()).done;){var r=t.value;this.prefixAndCallbackMap.delete(r)}}catch(a){e.e(a)}finally{e.f()}}},{key:"_cacheCallback",value:function(e,t,r){if(!!e){var a=e.split(",").map(function(S){return S.trim()}),o=or(a),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=this.prefixAndCallbackMap.get(s);if(l){if(l.has("callback")){var f=l.get("callback"),c=new Map;c.set("config",r),c.set("callback",t);var g=void 0;r.isDouble?g=f.get("double"):g=f.get("click"),g.add(c)}}else{var m=new Map,w=new Map,C=new Set,L=new Set,E=new Map;E.set("config",r),E.set("callback",t),r.isDouble?L.add(E):C.add(E),w.set("click",C),w.set("double",L),m.set("prefix",s),m.set("callback",w),this.prefixAndCallbackMap.set(s,m)}}}catch(S){o.e(S)}finally{o.f()}}}},{key:"_removeCacheCallback",value:function(e,t){var r=this;if(!!e){var a=e.split(","),o=or(a),u;try{var s=function(){var f=u.value;if(r.prefixAndCallbackMap.has(f)){var c=r.prefixAndCallbackMap.get(f);if(c){var g=c.get("callback"),m=g.get("click"),w=g.get("double"),C=function(E){E.forEach(function(S){var V=S.get("callback");cr.includes(f)?S.get("config").compare===t&&E.delete(S):V===t&&E.delete(S)})};m.size>0&&C(m),w.size>0&&C(w),m.size===0&&w.size===0&&r.prefixAndCallbackMap.delete(f)}}};for(o.s();!(u=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}}}},{key:"_addMouseClickCallback",value:function(){var e=this,t=this._view3d,r=this;if(this.mapViewer.core.setParameters({prefix:"*"}),h(t,"SetMouseCallback")){var a=function(u){r._lastClickCallbackTimer=setTimeout(function(){if(Te!==sr){r.debugger&&console.log(u);var s=u.gid,l=u.attr&&u.attr.gid||"",f=+new Date;s||l?function(){for(var c=!1,g=Array.from(e.prefixAndCallbackMap.entries()),m=function(E,S){S.forEach(function(V){var p=V.get("config"),U=V.get("callback"),H=p.compare,Z=p.isOnce;if(H!==oi){if(H(s,l)){var he=U(u);re(he)&&(r.cleanupCallback=he),c=!0}}else if(s&&s.toLocaleLowerCase().startsWith(E.toLocaleLowerCase())||l&&l.toLocaleLowerCase().startsWith(E.toLocaleLowerCase())||E==="*"){c=!0;var ce=U(u);re(ce)&&(r.cleanupCallback=ce)}Z&&setTimeout(function(){r.remove(E,U)})})},w=function(E){var S=st(g[E],2);S[0];var V=S[1],p=V.get("prefix"),U=V.get("callback"),H=U.get("click"),Z=U.get("double");if(H.size>0&&Z.size===0)m(p,H);else if(H.size===0&&Z.size>0)f-r._lastClickTimestamp<=300&&m(p,Z);else{var he=!1;if(f-r._lastClickTimestamp<=300&&(clearTimeout(r._clickCallbackTimer.get(p)),r._clickCallbackTimer.delete(p),he=!0,m(p,Z)),!he){var ce=setTimeout(function(){m(p,H)},300);r._clickCallbackTimer.set(p,ce)}}},C=0;C<g.length;C++)w(C);!c&&re(r.cleanupCallback)&&(r.cleanupCallback(),r.cleanupCallback=null)}():re(r.cleanupCallback)&&(r.cleanupCallback(),r.cleanupCallback=null),r._lastClickTimestamp=f}},r._dragTicker)};setTimeout(function(){t.SetMouseCallback(a)},10)}}},{key:"setMousePositionCallback",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ai,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=this._view3d;if(!re(e)){Ie(" callback must be a function, but got: ".concat(ie(e),"."));return}h(r,"SetMousePositionCallback")&&r.SetMousePositionCallback(function(a){e(a),t&&r.SetMousePositionCallback(null)})}},{key:"onClick",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"*",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:li;r=Object.assign({},li,r);var a=r;if(a.isOnce,re(e)&&(t=e),!re(t)){Ie(" callback must be a function, but got: ".concat(ie(t),"."));return}this._cacheCallback(e,t,r),this._addMouseClickCallback()}},{key:"reBind",value:function(){this._addMouseClickCallback()}},{key:"onDoubleClick",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"*",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;this.onClick(e,t,ni(ni({},r),{},{isDouble:!0,prefix:e}))}},{key:"remove",value:function(e,t){if(!e){qe("prefix is not defined, or is ''.");return}cr.includes(e)?this._removeMouseEvent(e,t):this._removeCacheCallback(e,t)}},{key:"removeDouble",value:function(e,t){this.remove(e,t)}},{key:"removeMousePositionCallback",value:function(){var e=this._view3d;h(e,"SetMousePositionCallback")&&e.SetMousePositionCallback(null)}},{key:"clear",value:function(){var e=this._view3d;this.mapViewer.core.setParameters(null),h(e,"SetMouseCallback")&&(e.SetMouseCallback(null),this._resetMouseCallback())}},{key:"silent",value:function(){var e=this._view3d;e.Clear(),e.SetParameters(null),e.SetMouseCallback(null)}}]),i}(),Vu=le,ci=se,$u={id:"mapv3d-container",url:"",projectId:"",token:"",mapkey:"",manual:!1,loading:!0,northControl:!1,enableKeyboard:!0,enableMouse:!0,defaultLocate:!0,autoResize:!0,autoResizeTicker:300,defaultSetResolution:!1,resolutionScale:1,resetBuildings:!0,internalMouseVisible:!1,complete:ci,error:ci},Hu=function(){function i(n){I(this,i),this._initFinished=!1,this.core=new so,this.config=Object.assign({},$u,n),this.config.manual||this._init(),this.event=null,this.build=null,this.camera=null,this.drawer=null,this.model=null,this.scheduler=An,hi()}return R(i,[{key:"create",value:function(){if(this._initFinished){qe("MapViewer is already initialize.");return}this._init()}},{key:"_init",value:function(){var e=this;this.core.createMap(this.config).then(function(){var t=e.core.view3d;t&&(e.event=new Fu(t,e),e.build=new Nu(t,e),e.camera=new vo(t,e),e.drawer=new To(t,e),e.model=new ju(t,e),e._initFinished=!0,e.config.complete&&Vu(e.config.complete)&&e.config.complete(t))})}}]),i}(),Uu="MapV3D \u4E09\u7EF4\u5730\u7403\u6846\u67B6",xu="http://www.aimapvision.com/",Ku="\u56FE\u6D0B\u79D1\u6280",Gu=vr(),qu=hr(),Wu=vi,zu=Pn;J.CATEGORY=zu,J.MapViewer=Hu,J.author=Ku,J.env=Wu,J.error=Ra,J.name=Uu,J.scheduler=An,J.update=qu,J.utils=Ja,J.version=Gu,J.website=xu,Object.defineProperties(J,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=mapv3d-src.umd.js.map
