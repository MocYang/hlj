(function(Q,S){typeof exports=="object"&&typeof module<"u"?S(exports):typeof define=="function"&&define.amd?define(["exports"],S):(Q=typeof globalThis<"u"?globalThis:Q||self,S(Q.mapv3d={}))})(this,function(Q){"use strict";function S(i,r){if(!(i instanceof r))throw new TypeError("Cannot call a class as a function")}function vn(i,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function R(i,r,e){return r&&vn(i.prototype,r),e&&vn(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i}var hn=function(){return"V0.1.29"},gn=function(){return new Date().toLocaleString()},di="DEV",vi=function(){var r=`%c \u{1F312}%c MapV3D %c \u56FE\u6D0B\u4E09\u7EF4\u5730\u56FE\u5E73\u53F0 %c

\u7248 \u672C \u53F7\uFF1A`.concat(hn(),`
\u7F16\u8BD1\u65E5\u671F\uFF1A`).concat(gn(),`
\u7248\u6743\u58F0\u660E\uFF1A
1. MapV3D\u7248\u6743\u5B8C\u5168\u5C5E\u4E8E "\u676D\u5DDE\u56FE\u6D0B\u4FE1\u606F\u79D1\u6280\u6709\u9650\u516C\u53F8"\u3002
2. MapV3D\u4E2Dmapv3d-src.*.js\u7A0B\u5E8F\u5305\uFF0C\u4EFB\u4F55\u4E2A\u4EBA\u548C\u673A\u6784\u5728\u9075\u5B88\u4E0B\u5217\u6761\u4EF6\u7684\u524D\u63D0\u4E0B\u6388\u6743\u6C38\u4E45\u4F7F\u7528\uFF1A
    1\uFF09\u4E0D\u8FDB\u884C\u4EFB\u4F55\u5F62\u5F0F\u7684\u7834\u89E3\u548C\u88C1\u526A\uFF0C\u7A0B\u5E8F\u5305\u5B8C\u6574\u5F15\u7528
    2\uFF09\u4FDD\u7559\u6B64\u7248\u6743\u4FE1\u606F\u5728\u63A7\u5236\u53F0\u8F93\u51FA
\u6211\u4EEC\u4FDD\u7559\u5BF9\u6B64\u7248\u6743\u4FE1\u606F\u7684\u6700\u7EC8\u89E3\u91CA\u6743\u3002
`),e='font-size: 17px;line-height: 1.5;font-weight: 1000;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";color: rgb(240, 133, 25);',t='font-size: 12px;line-height: 1.5;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";color: rgb(0, 138, 255);',n='font-size: 15px;line-height: 1.5;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";font-style: italic;color: rgb(240, 133, 25);padding-bottom: 5px;',a='font-size: 12px;line-height: 1.5;font-family: "\u5FAE\u8F6F\u96C5\u9ED1";color: rgb(0, 138, 255);';console.log(r,e,t,n,a)};function pn(i,r,e,t,n,a,o){try{var u=i[a](o),s=u.value}catch(l){e(l);return}u.done?r(s):Promise.resolve(s).then(t,n)}function G(i){return function(){var r=this,e=arguments;return new Promise(function(t,n){var a=i.apply(r,e);function o(s){pn(a,t,n,o,u,"next",s)}function u(s){pn(a,t,n,o,u,"throw",s)}o(void 0)})}}function ie(i){return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ie(i)}function hi(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var mn={exports:{}},yn={exports:{}};(function(i){function r(e){return i.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i.exports.__esModule=!0,i.exports.default=i.exports,r(e)}i.exports=r,i.exports.__esModule=!0,i.exports.default=i.exports})(yn),function(i){var r=yn.exports.default;function e(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i.exports=e=function(){return t},i.exports.__esModule=!0,i.exports.default=i.exports;var t={},n=Object.prototype,a=n.hasOwnProperty,o=typeof Symbol=="function"?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function f(y,v,w){return Object.defineProperty(y,v,{value:w,enumerable:!0,configurable:!0,writable:!0}),y[v]}try{f({},"")}catch{f=function(w,k,A){return w[k]=A}}function c(y,v,w,k){var A=v&&v.prototype instanceof b?v:b,M=Object.create(A.prototype),K=new fe(k||[]);return M._invoke=function(de,pe,$){var Z="suspendedStart";return function(me,ci){if(Z==="executing")throw new Error("Generator is already running");if(Z==="completed"){if(me==="throw")throw ci;return ge()}for($.method=me,$.arg=ci;;){var fi=$.delegate;if(fi){var dn=X(fi,$);if(dn){if(dn===m)continue;return dn}}if($.method==="next")$.sent=$._sent=$.arg;else if($.method==="throw"){if(Z==="suspendedStart")throw Z="completed",$.arg;$.dispatchException($.arg)}else $.method==="return"&&$.abrupt("return",$.arg);Z="executing";var Ve=g(de,pe,$);if(Ve.type==="normal"){if(Z=$.done?"completed":"suspendedYield",Ve.arg===m)continue;return{value:Ve.arg,done:$.done}}Ve.type==="throw"&&(Z="completed",$.method="throw",$.arg=Ve.arg)}}}(y,w,K),M}function g(y,v,w){try{return{type:"normal",arg:y.call(v,w)}}catch(k){return{type:"throw",arg:k}}}t.wrap=c;var m={};function b(){}function C(){}function L(){}var E={};f(E,u,function(){return this});var I=Object.getPrototypeOf,V=I&&I(I(re([])));V&&V!==n&&a.call(V,u)&&(E=V);var p=L.prototype=b.prototype=Object.create(E);function U(y){["next","throw","return"].forEach(function(v){f(y,v,function(w){return this._invoke(v,w)})})}function H(y,v){function w(A,M,K,de){var pe=g(y[A],y,M);if(pe.type!=="throw"){var $=pe.arg,Z=$.value;return Z&&r(Z)=="object"&&a.call(Z,"__await")?v.resolve(Z.__await).then(function(me){w("next",me,K,de)},function(me){w("throw",me,K,de)}):v.resolve(Z).then(function(me){$.value=me,K($)},function(me){return w("throw",me,K,de)})}de(pe.arg)}var k;this._invoke=function(A,M){function K(){return new v(function(de,pe){w(A,M,de,pe)})}return k=k?k.then(K,K):K()}}function X(y,v){var w=y.iterator[v.method];if(w===void 0){if(v.delegate=null,v.method==="throw"){if(y.iterator.return&&(v.method="return",v.arg=void 0,X(y,v),v.method==="throw"))return m;v.method="throw",v.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var k=g(w,y.iterator,v.arg);if(k.type==="throw")return v.method="throw",v.arg=k.arg,v.delegate=null,m;var A=k.arg;return A?A.done?(v[y.resultName]=A.value,v.next=y.nextLoc,v.method!=="return"&&(v.method="next",v.arg=void 0),v.delegate=null,m):A:(v.method="throw",v.arg=new TypeError("iterator result is not an object"),v.delegate=null,m)}function he(y){var v={tryLoc:y[0]};1 in y&&(v.catchLoc=y[1]),2 in y&&(v.finallyLoc=y[2],v.afterLoc=y[3]),this.tryEntries.push(v)}function ce(y){var v=y.completion||{};v.type="normal",delete v.arg,y.completion=v}function fe(y){this.tryEntries=[{tryLoc:"root"}],y.forEach(he,this),this.reset(!0)}function re(y){if(y){var v=y[u];if(v)return v.call(y);if(typeof y.next=="function")return y;if(!isNaN(y.length)){var w=-1,k=function A(){for(;++w<y.length;)if(a.call(y,w))return A.value=y[w],A.done=!1,A;return A.value=void 0,A.done=!0,A};return k.next=k}}return{next:ge}}function ge(){return{value:void 0,done:!0}}return C.prototype=L,f(p,"constructor",L),f(L,"constructor",C),C.displayName=f(L,l,"GeneratorFunction"),t.isGeneratorFunction=function(y){var v=typeof y=="function"&&y.constructor;return!!v&&(v===C||(v.displayName||v.name)==="GeneratorFunction")},t.mark=function(y){return Object.setPrototypeOf?Object.setPrototypeOf(y,L):(y.__proto__=L,f(y,l,"GeneratorFunction")),y.prototype=Object.create(p),y},t.awrap=function(y){return{__await:y}},U(H.prototype),f(H.prototype,s,function(){return this}),t.AsyncIterator=H,t.async=function(y,v,w,k,A){A===void 0&&(A=Promise);var M=new H(c(y,v,w,k),A);return t.isGeneratorFunction(v)?M:M.next().then(function(K){return K.done?K.value:M.next()})},U(p),f(p,l,"Generator"),f(p,u,function(){return this}),f(p,"toString",function(){return"[object Generator]"}),t.keys=function(y){var v=[];for(var w in y)v.push(w);return v.reverse(),function k(){for(;v.length;){var A=v.pop();if(A in y)return k.value=A,k.done=!1,k}return k.done=!0,k}},t.values=re,fe.prototype={constructor:fe,reset:function(v){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(ce),!v)for(var w in this)w.charAt(0)==="t"&&a.call(this,w)&&!isNaN(+w.slice(1))&&(this[w]=void 0)},stop:function(){this.done=!0;var v=this.tryEntries[0].completion;if(v.type==="throw")throw v.arg;return this.rval},dispatchException:function(v){if(this.done)throw v;var w=this;function k($,Z){return K.type="throw",K.arg=v,w.next=$,Z&&(w.method="next",w.arg=void 0),!!Z}for(var A=this.tryEntries.length-1;A>=0;--A){var M=this.tryEntries[A],K=M.completion;if(M.tryLoc==="root")return k("end");if(M.tryLoc<=this.prev){var de=a.call(M,"catchLoc"),pe=a.call(M,"finallyLoc");if(de&&pe){if(this.prev<M.catchLoc)return k(M.catchLoc,!0);if(this.prev<M.finallyLoc)return k(M.finallyLoc)}else if(de){if(this.prev<M.catchLoc)return k(M.catchLoc,!0)}else{if(!pe)throw new Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return k(M.finallyLoc)}}}},abrupt:function(v,w){for(var k=this.tryEntries.length-1;k>=0;--k){var A=this.tryEntries[k];if(A.tryLoc<=this.prev&&a.call(A,"finallyLoc")&&this.prev<A.finallyLoc){var M=A;break}}M&&(v==="break"||v==="continue")&&M.tryLoc<=w&&w<=M.finallyLoc&&(M=null);var K=M?M.completion:{};return K.type=v,K.arg=w,M?(this.method="next",this.next=M.finallyLoc,m):this.complete(K)},complete:function(v,w){if(v.type==="throw")throw v.arg;return v.type==="break"||v.type==="continue"?this.next=v.arg:v.type==="return"?(this.rval=this.arg=v.arg,this.method="return",this.next="end"):v.type==="normal"&&w&&(this.next=w),m},finish:function(v){for(var w=this.tryEntries.length-1;w>=0;--w){var k=this.tryEntries[w];if(k.finallyLoc===v)return this.complete(k.completion,k.afterLoc),ce(k),m}},catch:function(v){for(var w=this.tryEntries.length-1;w>=0;--w){var k=this.tryEntries[w];if(k.tryLoc===v){var A=k.completion;if(A.type==="throw"){var M=A.arg;ce(k)}return M}}throw new Error("illegal catch attempt")},delegateYield:function(v,w,k){return this.delegate={iterator:re(v),resultName:w,nextLoc:k},this.method==="next"&&(this.arg=void 0),m}},t}i.exports=e,i.exports.__esModule=!0,i.exports.default=i.exports}(mn);var $e=mn.exports(),D=$e;try{regeneratorRuntime=$e}catch{(typeof globalThis>"u"?"undefined":ie(globalThis))==="object"?globalThis.regeneratorRuntime=$e:Function("r","regeneratorRuntime = r")($e)}function at(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,e=arguments.length>2?arguments[2]:void 0,t,n,a=function(){var u=this,s=arguments;return e?(t?clearTimeout(t):n=i.apply(u,s),t=setTimeout(function(){t=null},r)):(clearTimeout(t),t=setTimeout(function(){i.apply(u,s)},r)),n};return a.cancel=function(){clearInterval(t),t=null},a}function bn(i,r,e){var t,n,a,o=0;e=e||{leading:!1,trailing:!0};var u=function(){o=e.leading?+new Date:0,t=null,i.apply(n,a),t||(n=a=null)},s=function(){var f=+new Date;!o&&!e.leading&&(o=f),n=this,a=arguments;var c=r-(f-o);c<=0||c>r?(t&&(clearTimeout(t),t=null),o=f,i.apply(n,a),t||(n=a=null)):!t&&e.trailing&&(t=setTimeout(u,c))};return s.cancel=function(){clearTimeout(t),t=null,o=0},s}var gi=function(){var r=document.documentElement,e=r.requestFullScreen||r.webkitRequestFullScreen||r.mozRequestFullScreen||r.msRequestFullscreen;if(e)e.call(r);else if(typeof window.ActiveXObject<"u"){var t=new ActiveXObject("WScript.Shell");t!=null&&t.SendKeys("{F11}")}},pi=function(){var r=document,e=r.cancelFullScreen||r.mozCancelFullScreen||r.msExitFullscreen||r.webkitExitFullscreen||r.exitFullscreen;if(e)e.call(r);else if(typeof window.ActiveXObject<"u"){var t=new ActiveXObject("WScript.Shell");t!=null&&t.SendKeys("{F11}")}};function mi(i){if(Array.isArray(i))return i}function yi(i,r){var e=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(e!=null){var t=[],n=!0,a=!1,o,u;try{for(e=e.call(i);!(n=(o=e.next()).done)&&(t.push(o.value),!(r&&t.length===r));n=!0);}catch(s){a=!0,u=s}finally{try{!n&&e.return!=null&&e.return()}finally{if(a)throw u}}return t}}function ot(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}function wn(i,r){if(!!i){if(typeof i=="string")return ot(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ot(i,r)}}function bi(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ut(i,r){return mi(i)||yi(i,r)||wn(i,r)||bi()}function wi(i,r){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Ci(i))||r&&i&&typeof i.length=="number"){e&&(i=e);var t=0,n=function(){};return{s:n,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Ci(i,r){if(!!i){if(typeof i=="string")return Cn(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Cn(i,r)}}function Cn(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}var Oi=function(){function i(){S(this,i),this.events=new Map}return R(i,[{key:"_add",value:function(e,t,n){var a=this,o=this.events.get(e),u=o||this.events.set(e,new Map).get(e);u.set(e,function(){t.apply(void 0,arguments),n&&a.off(e,t)})}},{key:"on",value:function(e,t){if(!t){console.error("No callback for key: ",e);return}this._add(e,t,!1)}},{key:"off",value:function(e,t){var n=this.events.get(e);n&&n.delete(t)}},{key:"dispatch",value:function(e){var t=this.events.get(e);if(!t){console.error("No callback for key: ",e);return}for(var n=arguments.length,a=new Array(n>1?n-1:0),o=1;o<n;o++)a[o-1]=arguments[o];var u=wi(t.entries()),s;try{for(u.s();!(s=u.n()).done;){var l=ut(s.value,2),f=l[1];f.apply(void 0,a)}}catch(c){u.e(c)}finally{u.f()}}},{key:"once",value:function(e,t){this._add(e,t,!0)}}]),i}();const ki=new Oi;function st(){this.locked=null}st.prototype.lock=G(D.mark(function i(){var r=this;return D.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.locked!==null){t.next=4;break}this.locked=[],t.next=6;break;case 4:return t.next=6,new Promise(function(n){return r.locked.push(n)});case 6:case"end":return t.stop()}},i,this)})),st.prototype.unlock=function(){this.locked.length?this.locked.shift()():this.locked=null};const _i={captureVideo:function(r){var e=document.createElement("canvas");return e.width=r.videoWidth,e.height=r.videoHeight,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toDataURL()}};var Ei=function(){var i=navigator.userAgent,r=/(?:Windows Phone)/.test(i),e=/(?:SymbianOS)/.test(i)||r,t=/(?:Android)/.test(i),n=/(?:Firefox)/.test(i);/(?:Chrome|CriOS)/.test(i);var a=/(?:iPad|PlayBook)/.test(i)||t&&!/(?:Mobile)/.test(i)||n&&/(?:Tablet)/.test(i),o=/(?:iPhone)/.test(i)&&!a,u=!o&&!t&&!e;return{isTablet:a,isPhone:o,isAndroid:t,isPc:u}}(),On={treeDfs:function(r,e){r.forEach(function(t){e(t),t.children&&On.treeDfs(t.children,e)})},treeToList:function(r){var e=[],t=function n(a){a.forEach(function(o){e.push(o),o.children&&o.children.length>0&&n(o.children)})};return t(r),e},list2Tree:function(r){return r.forEach(function(e){r.forEach(function(t){t.pid===e.id&&(e.children||(e.children=[]),e.children.push(t))})}),r=r.filter(function(e){return e.pid===null}),r}};function d(i,r,e){return r in i?Object.defineProperty(i,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[r]=e,i}var kn={exports:{}},lt={exports:{}},_n=function(r,e){return function(){for(var n=new Array(arguments.length),a=0;a<n.length;a++)n[a]=arguments[a];return r.apply(e,n)}},Si=_n,we=Object.prototype.toString;function ct(i){return Array.isArray(i)}function ft(i){return typeof i>"u"}function Ii(i){return i!==null&&!ft(i)&&i.constructor!==null&&!ft(i.constructor)&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function En(i){return we.call(i)==="[object ArrayBuffer]"}function Ai(i){return we.call(i)==="[object FormData]"}function Li(i){var r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(i):r=i&&i.buffer&&En(i.buffer),r}function Ri(i){return typeof i=="string"}function Di(i){return typeof i=="number"}function Sn(i){return i!==null&&ie(i)==="object"}function He(i){if(we.call(i)!=="[object Object]")return!1;var r=Object.getPrototypeOf(i);return r===null||r===Object.prototype}function Mi(i){return we.call(i)==="[object Date]"}function Bi(i){return we.call(i)==="[object File]"}function ji(i){return we.call(i)==="[object Blob]"}function In(i){return we.call(i)==="[object Function]"}function Pi(i){return Sn(i)&&In(i.pipe)}function Ni(i){return we.call(i)==="[object URLSearchParams]"}function Fi(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function Ti(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function dt(i,r){if(!(i===null||typeof i>"u"))if(ie(i)!=="object"&&(i=[i]),ct(i))for(var e=0,t=i.length;e<t;e++)r.call(null,i[e],e,i);else for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&r.call(null,i[n],n,i)}function vt(){var i={};function r(n,a){He(i[a])&&He(n)?i[a]=vt(i[a],n):He(n)?i[a]=vt({},n):ct(n)?i[a]=n.slice():i[a]=n}for(var e=0,t=arguments.length;e<t;e++)dt(arguments[e],r);return i}function Vi(i,r,e){return dt(r,function(n,a){e&&typeof n=="function"?i[a]=Si(n,e):i[a]=n}),i}function $i(i){return i.charCodeAt(0)===65279&&(i=i.slice(1)),i}var ae={isArray:ct,isArrayBuffer:En,isBuffer:Ii,isFormData:Ai,isArrayBufferView:Li,isString:Ri,isNumber:Di,isObject:Sn,isPlainObject:He,isUndefined:ft,isDate:Mi,isFile:Bi,isBlob:ji,isFunction:In,isStream:Pi,isURLSearchParams:Ni,isStandardBrowserEnv:Ti,forEach:dt,merge:vt,extend:Vi,trim:Fi,stripBOM:$i},Ee=ae;function An(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var Ln=function(r,e,t){if(!e)return r;var n;if(t)n=t(e);else if(Ee.isURLSearchParams(e))n=e.toString();else{var a=[];Ee.forEach(e,function(s,l){s===null||typeof s>"u"||(Ee.isArray(s)?l=l+"[]":s=[s],Ee.forEach(s,function(c){Ee.isDate(c)?c=c.toISOString():Ee.isObject(c)&&(c=JSON.stringify(c)),a.push(An(l)+"="+An(c))}))}),n=a.join("&")}if(n){var o=r.indexOf("#");o!==-1&&(r=r.slice(0,o)),r+=(r.indexOf("?")===-1?"?":"&")+n}return r},Hi=ae;function Ue(){this.handlers=[]}Ue.prototype.use=function(r,e,t){return this.handlers.push({fulfilled:r,rejected:e,synchronous:t?t.synchronous:!1,runWhen:t?t.runWhen:null}),this.handlers.length-1},Ue.prototype.eject=function(r){this.handlers[r]&&(this.handlers[r]=null)},Ue.prototype.forEach=function(r){Hi.forEach(this.handlers,function(t){t!==null&&r(t)})};var Ui=Ue,xi=ae,Ki=function(r,e){xi.forEach(r,function(n,a){a!==e&&a.toUpperCase()===e.toUpperCase()&&(r[e]=n,delete r[a])})},Rn=function(r,e,t,n,a){return r.config=e,t&&(r.code=t),r.request=n,r.response=a,r.isAxiosError=!0,r.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},r},Dn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ht,Mn;function Bn(){if(Mn)return ht;Mn=1;var i=Rn;return ht=function(e,t,n,a,o){var u=new Error(e);return i(u,t,n,a,o)},ht}var gt,jn;function Gi(){if(jn)return gt;jn=1;var i=Bn();return gt=function(e,t,n){var a=n.config.validateStatus;!n.status||!a||a(n.status)?e(n):t(i("Request failed with status code "+n.status,n.config,null,n.request,n))},gt}var pt,Pn;function qi(){if(Pn)return pt;Pn=1;var i=ae;return pt=i.isStandardBrowserEnv()?function(){return{write:function(t,n,a,o,u,s){var l=[];l.push(t+"="+encodeURIComponent(n)),i.isNumber(a)&&l.push("expires="+new Date(a).toGMTString()),i.isString(o)&&l.push("path="+o),i.isString(u)&&l.push("domain="+u),s===!0&&l.push("secure"),document.cookie=l.join("; ")},read:function(t){var n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),pt}var mt,Nn;function Wi(){return Nn||(Nn=1,mt=function(r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}),mt}var yt,Fn;function zi(){return Fn||(Fn=1,yt=function(r,e){return e?r.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):r}),yt}var bt,Tn;function Yi(){if(Tn)return bt;Tn=1;var i=Wi(),r=zi();return bt=function(t,n){return t&&!i(n)?r(t,n):n},bt}var wt,Vn;function Ji(){if(Vn)return wt;Vn=1;var i=ae,r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return wt=function(t){var n={},a,o,u;return t&&i.forEach(t.split(`
`),function(l){if(u=l.indexOf(":"),a=i.trim(l.substr(0,u)).toLowerCase(),o=i.trim(l.substr(u+1)),a){if(n[a]&&r.indexOf(a)>=0)return;a==="set-cookie"?n[a]=(n[a]?n[a]:[]).concat([o]):n[a]=n[a]?n[a]+", "+o:o}}),n},wt}var Ct,$n;function Xi(){if($n)return Ct;$n=1;var i=ae;return Ct=i.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),n;function a(o){var u=o;return e&&(t.setAttribute("href",u),u=t.href),t.setAttribute("href",u),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=a(window.location.href),function(u){var s=i.isString(u)?a(u):u;return s.protocol===n.protocol&&s.host===n.host}}():function(){return function(){return!0}}(),Ct}var Ot,Hn;function xe(){if(Hn)return Ot;Hn=1;function i(r){this.message=r}return i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,Ot=i,Ot}var kt,Un;function xn(){if(Un)return kt;Un=1;var i=ae,r=Gi(),e=qi(),t=Ln,n=Yi(),a=Ji(),o=Xi(),u=Bn(),s=Dn,l=xe();return kt=function(c){return new Promise(function(m,b){var C=c.data,L=c.headers,E=c.responseType,I;function V(){c.cancelToken&&c.cancelToken.unsubscribe(I),c.signal&&c.signal.removeEventListener("abort",I)}i.isFormData(C)&&delete L["Content-Type"];var p=new XMLHttpRequest;if(c.auth){var U=c.auth.username||"",H=c.auth.password?unescape(encodeURIComponent(c.auth.password)):"";L.Authorization="Basic "+btoa(U+":"+H)}var X=n(c.baseURL,c.url);p.open(c.method.toUpperCase(),t(X,c.params,c.paramsSerializer),!0),p.timeout=c.timeout;function he(){if(!!p){var fe="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,re=!E||E==="text"||E==="json"?p.responseText:p.response,ge={data:re,status:p.status,statusText:p.statusText,headers:fe,config:c,request:p};r(function(v){m(v),V()},function(v){b(v),V()},ge),p=null}}if("onloadend"in p?p.onloadend=he:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(he)},p.onabort=function(){!p||(b(u("Request aborted",c,"ECONNABORTED",p)),p=null)},p.onerror=function(){b(u("Network Error",c,null,p)),p=null},p.ontimeout=function(){var re=c.timeout?"timeout of "+c.timeout+"ms exceeded":"timeout exceeded",ge=c.transitional||s;c.timeoutErrorMessage&&(re=c.timeoutErrorMessage),b(u(re,c,ge.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},i.isStandardBrowserEnv()){var ce=(c.withCredentials||o(X))&&c.xsrfCookieName?e.read(c.xsrfCookieName):void 0;ce&&(L[c.xsrfHeaderName]=ce)}"setRequestHeader"in p&&i.forEach(L,function(re,ge){typeof C>"u"&&ge.toLowerCase()==="content-type"?delete L[ge]:p.setRequestHeader(ge,re)}),i.isUndefined(c.withCredentials)||(p.withCredentials=!!c.withCredentials),E&&E!=="json"&&(p.responseType=c.responseType),typeof c.onDownloadProgress=="function"&&p.addEventListener("progress",c.onDownloadProgress),typeof c.onUploadProgress=="function"&&p.upload&&p.upload.addEventListener("progress",c.onUploadProgress),(c.cancelToken||c.signal)&&(I=function(re){!p||(b(!re||re&&re.type?new l("canceled"):re),p.abort(),p=null)},c.cancelToken&&c.cancelToken.subscribe(I),c.signal&&(c.signal.aborted?I():c.signal.addEventListener("abort",I))),C||(C=null),p.send(C)})},kt}var Y=ae,Kn=Ki,Zi=Rn,Qi=Dn,ea={"Content-Type":"application/x-www-form-urlencoded"};function Gn(i,r){!Y.isUndefined(i)&&Y.isUndefined(i["Content-Type"])&&(i["Content-Type"]=r)}function ta(){var i;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(i=xn()),i}function na(i,r,e){if(Y.isString(i))try{return(r||JSON.parse)(i),Y.trim(i)}catch(t){if(t.name!=="SyntaxError")throw t}return(e||JSON.stringify)(i)}var Ke={transitional:Qi,adapter:ta(),transformRequest:[function(r,e){return Kn(e,"Accept"),Kn(e,"Content-Type"),Y.isFormData(r)||Y.isArrayBuffer(r)||Y.isBuffer(r)||Y.isStream(r)||Y.isFile(r)||Y.isBlob(r)?r:Y.isArrayBufferView(r)?r.buffer:Y.isURLSearchParams(r)?(Gn(e,"application/x-www-form-urlencoded;charset=utf-8"),r.toString()):Y.isObject(r)||e&&e["Content-Type"]==="application/json"?(Gn(e,"application/json"),na(r)):r}],transformResponse:[function(r){var e=this.transitional||Ke.transitional,t=e&&e.silentJSONParsing,n=e&&e.forcedJSONParsing,a=!t&&this.responseType==="json";if(a||n&&Y.isString(r)&&r.length)try{return JSON.parse(r)}catch(o){if(a)throw o.name==="SyntaxError"?Zi(o,this,"E_JSON_PARSE"):o}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Y.forEach(["delete","get","head"],function(r){Ke.headers[r]={}}),Y.forEach(["post","put","patch"],function(r){Ke.headers[r]=Y.merge(ea)});var _t=Ke,ra=ae,ia=_t,aa=function(r,e,t){var n=this||ia;return ra.forEach(t,function(o){r=o.call(n,r,e)}),r},Et,qn;function Wn(){return qn||(qn=1,Et=function(r){return!!(r&&r.__CANCEL__)}),Et}var zn=ae,St=aa,oa=Wn(),ua=_t,sa=xe();function It(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new sa("canceled")}var la=function(r){It(r),r.headers=r.headers||{},r.data=St.call(r,r.data,r.headers,r.transformRequest),r.headers=zn.merge(r.headers.common||{},r.headers[r.method]||{},r.headers),zn.forEach(["delete","get","head","post","put","patch","common"],function(n){delete r.headers[n]});var e=r.adapter||ua.adapter;return e(r).then(function(n){return It(r),n.data=St.call(r,n.data,n.headers,r.transformResponse),n},function(n){return oa(n)||(It(r),n&&n.response&&(n.response.data=St.call(r,n.response.data,n.response.headers,r.transformResponse))),Promise.reject(n)})},oe=ae,Yn=function(r,e){e=e||{};var t={};function n(f,c){return oe.isPlainObject(f)&&oe.isPlainObject(c)?oe.merge(f,c):oe.isPlainObject(c)?oe.merge({},c):oe.isArray(c)?c.slice():c}function a(f){if(oe.isUndefined(e[f])){if(!oe.isUndefined(r[f]))return n(void 0,r[f])}else return n(r[f],e[f])}function o(f){if(!oe.isUndefined(e[f]))return n(void 0,e[f])}function u(f){if(oe.isUndefined(e[f])){if(!oe.isUndefined(r[f]))return n(void 0,r[f])}else return n(void 0,e[f])}function s(f){if(f in e)return n(r[f],e[f]);if(f in r)return n(void 0,r[f])}var l={url:o,method:o,data:o,baseURL:u,transformRequest:u,transformResponse:u,paramsSerializer:u,timeout:u,timeoutMessage:u,withCredentials:u,adapter:u,responseType:u,xsrfCookieName:u,xsrfHeaderName:u,onUploadProgress:u,onDownloadProgress:u,decompress:u,maxContentLength:u,maxBodyLength:u,transport:u,httpAgent:u,httpsAgent:u,cancelToken:u,socketPath:u,responseEncoding:u,validateStatus:s};return oe.forEach(Object.keys(r).concat(Object.keys(e)),function(c){var g=l[c]||a,m=g(c);oe.isUndefined(m)&&g!==s||(t[c]=m)}),t},At,Jn;function Xn(){return Jn||(Jn=1,At={version:"0.26.1"}),At}var ca=Xn().version,Lt={};["object","boolean","number","function","string","symbol"].forEach(function(i,r){Lt[i]=function(t){return ie(t)===i||"a"+(r<1?"n ":" ")+i}});var Zn={};Lt.transitional=function(r,e,t){function n(a,o){return"[Axios v"+ca+"] Transitional option '"+a+"'"+o+(t?". "+t:"")}return function(a,o,u){if(r===!1)throw new Error(n(o," has been removed"+(e?" in "+e:"")));return e&&!Zn[o]&&(Zn[o]=!0,console.warn(n(o," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(a,o,u):!0}};function fa(i,r,e){if(ie(i)!=="object")throw new TypeError("options must be an object");for(var t=Object.keys(i),n=t.length;n-- >0;){var a=t[n],o=r[a];if(o){var u=i[a],s=u===void 0||o(u,a,i);if(s!==!0)throw new TypeError("option "+a+" must be "+s);continue}if(e!==!0)throw Error("Unknown option "+a)}}var da={assertOptions:fa,validators:Lt},Qn=ae,va=Ln,er=Ui,tr=la,Ge=Yn,nr=da,Se=nr.validators;function Re(i){this.defaults=i,this.interceptors={request:new er,response:new er}}Re.prototype.request=function(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=Ge(this.defaults,e),e.method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;t!==void 0&&nr.assertOptions(t,{silentJSONParsing:Se.transitional(Se.boolean),forcedJSONParsing:Se.transitional(Se.boolean),clarifyTimeoutError:Se.transitional(Se.boolean)},!1);var n=[],a=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(e)===!1||(a=a&&m.synchronous,n.unshift(m.fulfilled,m.rejected))});var o=[];this.interceptors.response.forEach(function(m){o.push(m.fulfilled,m.rejected)});var u;if(!a){var s=[tr,void 0];for(Array.prototype.unshift.apply(s,n),s=s.concat(o),u=Promise.resolve(e);s.length;)u=u.then(s.shift(),s.shift());return u}for(var l=e;n.length;){var f=n.shift(),c=n.shift();try{l=f(l)}catch(g){c(g);break}}try{u=tr(l)}catch(g){return Promise.reject(g)}for(;o.length;)u=u.then(o.shift(),o.shift());return u},Re.prototype.getUri=function(r){return r=Ge(this.defaults,r),va(r.url,r.params,r.paramsSerializer).replace(/^\?/,"")},Qn.forEach(["delete","get","head","options"],function(r){Re.prototype[r]=function(e,t){return this.request(Ge(t||{},{method:r,url:e,data:(t||{}).data}))}}),Qn.forEach(["post","put","patch"],function(r){Re.prototype[r]=function(e,t,n){return this.request(Ge(n||{},{method:r,url:e,data:t}))}});var ha=Re,Rt,rr;function ga(){if(rr)return Rt;rr=1;var i=xe();function r(e){if(typeof e!="function")throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(o){t=o});var n=this;this.promise.then(function(a){if(!!n._listeners){var o,u=n._listeners.length;for(o=0;o<u;o++)n._listeners[o](a);n._listeners=null}}),this.promise.then=function(a){var o,u=new Promise(function(s){n.subscribe(s),o=s}).then(a);return u.cancel=function(){n.unsubscribe(o)},u},e(function(o){n.reason||(n.reason=new i(o),t(n.reason))})}return r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.prototype.subscribe=function(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]},r.prototype.unsubscribe=function(t){if(!!this._listeners){var n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}},r.source=function(){var t,n=new r(function(o){t=o});return{token:n,cancel:t}},Rt=r,Rt}var Dt,ir;function pa(){return ir||(ir=1,Dt=function(r){return function(t){return r.apply(null,t)}}),Dt}var Mt,ar;function ma(){if(ar)return Mt;ar=1;var i=ae;return Mt=function(e){return i.isObject(e)&&e.isAxiosError===!0},Mt}var or=ae,ya=_n,qe=ha,ba=Yn,wa=_t;function ur(i){var r=new qe(i),e=ya(qe.prototype.request,r);return or.extend(e,qe.prototype,r),or.extend(e,r),e.create=function(n){return ur(ba(i,n))},e}var ve=ur(wa);ve.Axios=qe,ve.Cancel=xe(),ve.CancelToken=ga(),ve.isCancel=Wn(),ve.VERSION=Xn().version,ve.all=function(r){return Promise.all(r)},ve.spread=pa(),ve.isAxiosError=ma(),lt.exports=ve,lt.exports.default=ve,function(i){i.exports=lt.exports}(kn);const sr=hi(kn.exports);function lr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function cr(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?lr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):lr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var Bt=sr.create({baseURL:"",timeout:1e4});Bt.interceptors.request.use(function(i){return i},function(i){return Promise.reject(i)}),Bt.interceptors.response.use(function(i){return i.data},function(i){return Promise.reject(i)});var Ca=sr.CancelToken;function Oa(){return Ca.source()}function ka(){return function(){var r=Oa();return{http:function(){var e=G(D.mark(function n(a){return D.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",Bt.request(cr(cr({},a),{},{cancelToken:r.token})));case 1:case"end":return u.stop()}},n)}));function t(n){return e.apply(this,arguments)}return t}(),cancel:function(t){r.cancel(t)}}}}const _a=ka();function fr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function Ea(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?fr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):fr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function Sa(){return jt.apply(this,arguments)}function jt(){return jt=G(D.mark(function i(){var r,e,t,n;return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return r=_a(),e=r.http,o.next=3,e({url:"./config.json"});case 3:return t=o.sent,n=window.location.host,console.log("%c config.json\u914D\u7F6E:","color: red;font-size:13px",t),console.log("%c \u672C\u673AIP:","color: blue;font-size:13px",n),o.abrupt("return",Ea({environments:t.environments},t[t.environments||"PRD"])||{});case 8:case"end":return o.stop()}},i)})),jt.apply(this,arguments)}var se=function(){return null},dr=function(){return!1},We=Object.create(null),vr=Object.prototype.toString,Pt=function(r){return vr.call(r)},ze=function(r){return Pt(r)==="[object Object]"},hr=function(r){return pr(r)&&le(r.then)&&le(r.catch)},Ia=function(r){return r===!0||r===!1};function Aa(i){return i==null||i===""||i==="undefined"}function La(i){return!(i==null||i===""||i==="undefined")}function Ie(i){return typeof Array.isArray=="export function"?Array.isArray(i):Object.prototype.toString.call(i)==="[object Array]"}function Nt(i){return typeof i=="string"&&i.constructor===String}function Ra(i){return typeof obj=="number"&&obj.constructor===Number}function gr(i){return ie(i)==="object"&&i.constructor===Date}function le(i){return typeof i=="export function"||typeof i=="function"}function pr(i){return i!==null&&ie(i)=="object"}function Ft(i,r){if(i===null||ie(i)!="object")return i;if(r==null&&(r=["_parent","_class"]),gr(i)){var e=new Date;return e.setTime(i.getTime()),e}if(Ie(i)){for(var e=[],t=0,n=i.length;t<n;++t)e[t]=Ft(i[t],r);return e}if(ie(i)==="object"){var e={};for(var a in i)typeof a!="export function"&&r.indexOf(a)==-1&&i.hasOwnProperty(a)&&(e[a]=Ft(i[a],r));return e}return i}function Da(i){for(var r=document.scripts||document.getElementsByTagName("script"),e,t=r.length;t>0;t--)r[t-1].src.indexOf(i)>-1&&(e=r[t-1].src.substring(0,r[t-1].src.lastIndexOf("/")+1));return e}function mr(i){return i&&Nt(i)&&i.toLowerCase()}function Tt(i){return Object.keys(i).reduce(function(r,e){return r[mr(e)]=i[e],r},{})}function Ma(i){function r(e){return"_"+e.toLowerCase()}return Object.keys(i).reduce(function(e,t){return e[t.replace(/[A-Z]/,r)]=i[t],e},{})}function Ba(i){function r(e){return e=e.slice(1),e=e[0].toUpperCase()+e.slice(1),e}return Object.keys(i).reduce(function(e,t){return e[t.replace(/_\w/g,r)]=i[t],e},{})}var ja=function(r,e){var t={};return r.forEach(function(n){var a=e(n);typeof a!="string"&&(a=JSON.stringify(a)),t[a]=t[a]||[],t[a].push(n)}),t},Pa=function(r){return r.sort(function(){return Math.random()-.5})};function ye(){return Math.floor(Math.random()*16777215).toString(16)}function Vt(){return"".concat(ye()).concat(ye()).concat(ye().slice(2))}function Na(){return"".concat(ye()).concat(ye()).concat(ye()).concat(ye()).concat(ye().slice(2))}function Fa(i,r){var e=null,t="",n=0,a="    ";return r=r||{},r.newlineAfterColonIfBeforeBraceOrBracket=r.newlineAfterColonIfBeforeBraceOrBracket===!0,r.spaceAfterColon=r.spaceAfterColon===!1,typeof i!="string"||(i=JSON.parse(i)),i=JSON.stringify(i),e=/([{}])/g,i=i.replace(e,`\r
$1\r
`),e=/([\[\]])/g,i=i.replace(e,`\r
$1\r
`),e=/(\,)/g,i=i.replace(e,`$1\r
`),e=/(\r\n\r\n)/g,i=i.replace(e,`\r
`),e=/\r\n\,/g,i=i.replace(e,","),r.newlineAfterColonIfBeforeBraceOrBracket||(e=/\:\r\n\{/g,i=i.replace(e,":{"),e=/\:\r\n\[/g,i=i.replace(e,":[")),r.spaceAfterColon&&(e=/\:/g,i=i.replace(e,":")),i.split(`\r
`).forEach(function(o,u){var s=0,l=0,f="";for(o.match(/\{$/)||o.match(/\[$/)?l=1:o.match(/\}/)||o.match(/\]/)?n!==0&&(n-=1):l=0,s=0;s<n;s++)f+=a;o!==""&&(t+=f+o+`\r
`),n+=l}),t.replace(/\r\n$/,"")}var $t=1920,Ht=1080;function Ta(i,r){$t=i,Ht=r}function Va(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof i!="number"?i:"".concat(i/$t*100,"vw")}function $a(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return typeof i!="number"?i:"".concat(i/Ht*100,"vh")}function Ha(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$t;if(typeof i!="number")return i;var e=window.innerWidth;return Math.ceil(e/r*i)}function Ua(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ht;if(typeof i!="number")return i;var e=window.innerHeight;return Math.ceil(e/r*i)}var yr=Ei,xa={sim_arraw:"sim_arraw",sim_dot:"sim_dot",sim_dashed:"sim_dashed",sim_flash:"sim_flash",sim_scan:"sim_scan",red:"red"};function Ka(i,r){}const Ga=Object.freeze(Object.defineProperty({__proto__:null,lock:st,debounce:at,throttle:bn,enterFullScreen:gi,exitFullScreen:pi,captureUtil:_i,EventBus:ki,treeUtil:On,fetchConfig:Sa,NOOP:se,FALSE_FUNC:dr,EMPTY_OBJ:We,objectToString:vr,toTypeString:Pt,isPlainObject:ze,isPromise:hr,isBoolean:Ia,isEmpty:Aa,isNotEmpty:La,isArray:Ie,isString:Nt,isNumber:Ra,isDate:gr,isFunction:le,isObject:pr,clone:Ft,getPath:Da,toLowerCase:mr,objectKeyToLowerCase:Tt,objectKeyToUnderline:Ma,objectKeyUnderlineToUppercase:Ba,groupBy:ja,shuffledArray:Pa,createHex:ye,createUUID:Vt,createUUID32:Na,beautifyJSON:Fa,setBaseLayout:Ta,formatPxToVw:Va,formatPxToVh:$a,pxFromVw:Ha,pxFromVh:Ua,osUtil:yr,STYLES:xa,isInViewBox:Ka},Symbol.toStringTag,{value:"Module"}));var br=Nt,wr=ze;function Ye(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";br(i)&&console.error(i),wr(i)&&console.log(i.msg)}function Ut(i){br(i)&&console.warn(i),wr(i)&&console.warn(i.msg)}function h(i,r){if(!!i)return!r in i?(Ye("".concat(r," dose not exist.")),!1):!0}function qa(i){if(Array.isArray(i))return ot(i)}function Wa(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function za(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function De(i){return qa(i)||Wa(i)||wn(i)||za()}var Ya=se,Cr=Ie,be=le,Ja=ze,Xa=hr,Me=[],xt=!1;function Or(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,r=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,t=arguments.length,n=new Array(t>3?t-3:0),a=3;a<t;a++)n[a-3]=arguments[a];return new Promise(function(o){be(r)&&(e=r,r=null),e&&e.apply(r,[].concat(n)),setTimeout(function(){var u=Ya;n.length===1&&be(n[0])?u=n[0]:n.length>1&&be(n[n.length-1])&&(u=n[n.length-1]),u(),o()},i)})}function kr(i,r){for(var e=arguments.length,t=new Array(e>2?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return new Promise(function(a){if(be(r)){var o=function(){a.apply(void 0,arguments)};if(Cr(t)&&t.length===1&&be(t[0])){var u=t[0];o=function(){for(var f=arguments.length,c=new Array(f),g=0;g<f;g++)c[g]=arguments[g];u.apply(i,[].concat(c)),a.apply(void 0,c)},t=[]}else if(Cr(t)&&t.length>1&&be(t[t.length-1])){var s=t.pop();o=function(){for(var f=arguments.length,c=new Array(f),g=0;g<f;g++)c[g]=arguments[g];s.apply(null,[].concat(c)),a.apply(void 0,c)}}r.apply(i,[].concat(De(t),[o]))}})}function Je(i,r){for(var e=arguments.length,t=new Array(e>2?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return G(D.mark(function a(){return D.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",kr.apply(void 0,[i,r].concat(t)));case 1:case"end":return u.stop()}},a)}))}function _r(i,r,e){for(var t=arguments.length,n=new Array(t>3?t-3:0),a=3;a<t;a++)n[a-3]=arguments[a];return G(D.mark(function o(){return D.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.abrupt("return",Or.apply(void 0,[i,r,e].concat(n)));case 1:case"end":return s.stop()}},o)}))}function Be(i){return new Promise(function(){var r=G(D.mark(function e(t,n){return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:try{Er({task:i.task,complete:function(){t.apply(void 0,arguments)}})}catch(u){n(u)}case 1:case"end":return o.stop()}},e)}));return function(e,t){return r.apply(this,arguments)}}())}function Za(i){return function(){var r=G(D.mark(function e(t,n){var a,o,u,s=arguments;return D.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:for(a=s.length,o=new Array(a>2?a-2:0),u=2;u<a;u++)o[u-2]=s[u];return f.abrupt("return",Be({task:function(){return be(i)&&i&&i(),Je.apply(void 0,[t,n].concat(o))}}));case 2:case"end":return f.stop()}},e)}));return function(e,t){return r.apply(this,arguments)}}()}function q(i,r){for(var e=arguments.length,t=new Array(e>2?e-2:0),n=2;n<e;n++)t[n-2]=arguments[n];return Be({task:Je.apply(void 0,[i,r].concat(t))})}function j(){for(var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:10,r=arguments.length>1?arguments[1]:void 0,e=arguments.length>2?arguments[2]:void 0,t=arguments.length,n=new Array(t>3?t-3:0),a=3;a<t;a++)n[a-3]=arguments[a];return Be({task:_r.apply(void 0,[i,r,e].concat(n))})}function Er(i){Ja(i)&&Sr(Me,i),!xt&&Qa()}function Kt(i){return i.length===0?null:i[0]}function Sr(i,r){i.push(r)}function Ir(i){return i.length===0?null:i.splice(0,1)}function Qa(){return Gt.apply(this,arguments)}function Gt(){return Gt=G(D.mark(function i(){var r,e,t,n;return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:xt=!0,r=Kt(Me);case 2:if(r===null){o.next=21;break}if(e=r.task(),t=void 0,!be(e)){o.next=11;break}return o.next=8,e();case 8:t=o.sent,o.next=15;break;case 11:if(!Xa(e)){o.next=15;break}return o.next=14,e;case 14:t=o.sent;case 15:n=r.complete,be(n)&&n(t),Ir(Me),r=Kt(Me),o.next=2;break;case 21:xt=!1;case 22:case"end":return o.stop()}},i)})),Gt.apply(this,arguments)}window.$taskQueue=Me;const Ar=Object.freeze(Object.defineProperty({__proto__:null,sleep:Or,until:kr,curry:Je,wait:_r,doSchedule:Be,preSchedule:Za,schedule:q,waitSchedule:j,performAsyncWork:Er,peek:Kt,push:Sr,pop:Ir},Symbol.toStringTag,{value:"Module"}));var eo=le,to=We,no=at,ro=function(){function i(){S(this,i),this._view3d=null,this.config=to}return R(i,[{key:"view3d",get:function(){return this._view3d},set:function(e){this._view3d=e}},{key:"createMap",value:function(){var r=G(D.mark(function t(n){var a=this,o,u;return D.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(this.config=n,o={},u=this,!(!window.MapVision||!window.MapVision.View3d)){l.next=6;break}return n.error&&eo(n.error)&&n.error({code:1,msg:"mapvision3d.min.js file was not include."}),l.abrupt("return");case 6:return l.abrupt("return",Be({task:function(){var c={id:n.id,url:n.url,projectId:n.projectId,mapkey:n.mapkey,token:n.token};return o=new MapVision.View3d(c),Je(o,o.Open,function(g){if(g.code===200)u._view3d=o;else{Ye({msg:"connection fail! check if MapVisionPServer is running!"}),n.error(g);return}io(u),a._view3d.OverLayerRemoveAll(),a.setNorthControl(n.northControl),n.defaultSetResolution&&a.setResolution(n.id),a.setParameters(),a.setMouseEnable(n.enableMouse),a.setKeyBoardEnable(n.enableKeyboard),a._view3d.Stop(),a._view3d.Clear(),a.setMouseCursorVisible(n.internalMouseVisible),a._insertMask(),n.defaultLocate&&o.ResetHome()})}}));case 7:case"end":return l.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"destroy",value:function(){ao(),this.view3d=null}},{key:"_insertMask",value:function(){var e=this.config.id,t=document.getElementById(e);if(t){var n=t.parentNode;if(n){var a=document.createElement("div");a.id=e+"_mask",a.style.position="absolute",a.style.left="0",a.style.top="0",a.style.width="100%",a.style.height="100%",a.style.zIndex="1",a.style.display="none",a.style.backgroundColor="transparent",a.style.opacity="0",n.appendChild(a)}}}},{key:"_removeMask",value:function(){var e=this.config.id,t=document.getElementById(e);if(t){var n=t.parentNode;n&&n.removeChild(t)}}},{key:"_showMask",value:function(){var e=this.config.id,t=document.getElementById(e+"_mask");t&&(t.style.display="block")}},{key:"_hideMask",value:function(){var e=this.config.id,t=document.getElementById(e+"_mask");t&&(t.style.display="none")}},{key:"setResolution",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"mapVision3d",t=this.config,n=this._view3d,a=document.getElementById(e);if(a&&h(n,"SetResolution")){var o=window.devicePixelRatio*(yr.isPc?1:3);n.SetResolution(a.clientWidth*o*t.resolutionScale,a.clientHeight*o*t.resolutionScale)}}},{key:"openMap",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"default";h(this._view3d,"OpenMap")&&this._view3d.OpenMap(e)}},{key:"setMouseEnable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._view3d.enableMouse=e}},{key:"setKeyBoardEnable",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this._view3d.enableKeyboard=e}},{key:"setTreeVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"InstancedFoliageActor",e)}},{key:"setDirectionalLightVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"DirectionalLight",e)}},{key:"setDynamicSkyVisible",value:function(e){var t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"Ultra_Dynamic_Sky",e)}},{key:"setSkySphereVisible",value:function(e){var t=this._view3d;if(h(t,"UpdateObjectVisible"))return j(10,t,t.UpdateObjectVisible,"BP_Sky_Sphere",e)}},{key:"getKeyBoardEnable",value:function(){return this._view3d.enableKeyboard}},{key:"setMouseCursorVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;h(this._view3d,"SetParameters")&&this.setParameters({showmouse:e})}},{key:"getSceneSunInfo",value:function(){var r=G(D.mark(function t(){var n;return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(n=this._view3d,!h(n,"GetScenceSunInfo")){o.next=3;break}return o.abrupt("return",q(n,n.GetScenceSunInfo));case 3:case"end":return o.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"setSceneSunInfo",value:function(e){var t=this._view3d;if(h(t,"SetScenceSunInfo"))return j(10,t,t.SetScenceSunInfo,e)}},{key:"setNorthControl",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;this._view3d.SetNorthControl(e,t,n,a)}},{key:"close",value:function(){var e=this._view3d;h(e,"Close")&&(e.Close(),this.destroy())}},{key:"setParameters",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this._view3d;t.SetParameters(e)}},{key:"clear",value:function(){var e=this._view3d;h(e,"Clear")&&e.Clear()}},{key:"stop",value:function(){var e=this._view3d;h(e,"Stop")&&e.Stop()}},{key:"isClose",value:function(){var e=this._view3d;if(h(e,"IsClose"))return e.IsClose()}},{key:"setMapStatus",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=this._view3d;h(t,"SetMapStatus")&&t.SetMapStatus(e)}}]),i}(),Xe;function io(i){Xe=no(function(){i.setResolution(i.config.id)},500),window.addEventListener("resize",Xe)}function ao(){Xe&&window.removeEventListener("resize",Xe)}function Lr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function Ce(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Lr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Lr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var qt=ze,oo=le,Ze=se,uo=function(){function i(r,e){S(this,i),this.view3d=r,this.viewer=e,this.duration=3,this.timer=null}return R(i,[{key:"init",value:function(){this.resetHome()}},{key:"resetHome",value:function(){var e=this.view3d;h(e,"ResetHome")&&e.ResetHome()}},{key:"setPosition",value:function(e){var t=this.view3d;qt(e)&&h(t,"SetPosition")&&t.SetPosition(e)}},{key:"flyToPosition",value:function(e){var t,n,a,o,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.duration,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:Ze,c=this.view3d;(t=this.viewer)===null||t===void 0||(n=t.core)===null||n===void 0||n._showMask(),(a=this.viewer)===null||a===void 0||(o=a.event)===null||o===void 0||o.silent();var g=this;this.timer&&clearTimeout(this.timer);var m=function(I){var V,p,U,H;(V=g.viewer)===null||V===void 0||(p=V.core)===null||p===void 0||p._hideMask(),(U=g.viewer)===null||U===void 0||(H=U.event)===null||H===void 0||H.reBindMouseClickCallback(),oo(f)&&setTimeout(function(){f(I)},100)};if(!e){m();return}if(qt(e))h(c,"FlyToPosition")&&(c.FlyToPosition(e,u,s,l,function(E){g.timer&&(clearTimeout(g.timer),g.timer=null),m(E)}),this.timer=setTimeout(function(){m(null)},this.duration+.5));else if(Array.isArray(e)){var b=0,C=null,L=function E(){var I=e[b],V=I.duration||s,p=function(H){C&&clearTimeout(C),b++,b===e.length?(C=null,m(H)):E()};c.FlyToPosition(I,u,V,l,p),C=setTimeout(p,(V+.2)*1e3)};L()}}},{key:"flyToPositionByOptions",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={position:null,duration:3,enableCurve:!1,showLocation:!1,onFinish:Ze},n=Object.assign({},t,e);this.flyToPosition(n.position,n.showLocation,n.duration,n.enableCurve,n.onFinish)}},{key:"flyToObject",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.duration,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.view3d;qt(e)&&!!e.gid&&h(a,"FlyToObject")&&a.FlyToObject(e,n,t)}},{key:"flyToObjectById",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={gid:"",showLocation:!1,pitch:90,yaw:0,distance:null,duration:this.duration,enableCurve:!1,onFinish:function(){return null}};if(e=Ce(Ce({},t),e),!e.gid){console.warn("object gid is undefined or ''.");return}var n=this.view3d;h(n,"FlyToObjectById")&&n.FlyToObjectById(e.gid,e.showLocation,e.pitch,e.distance,e.duration)}},{key:"setNorth",value:function(){var e=this.view3d;h(e,"SetNorth")&&e.SetNorth()}},{key:"getHomePosition",value:function(){var e=this.view3d;if(h(e,"GetHomePosition"))return q(e,e.GetHomePosition)}},{key:"getCurrentPosition",value:function(){var e=this.view3d;if(h(e,"GetCurrentPosition"))return q(e,e.GetCurrentPosition)}},{key:"getScreenPosition",value:function(e){var t=this.view3d;if(h(t,"GetScreenPosition"))return q(t,t.GetScrrenPosition,e)}},{key:"flyToObjectByType",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={type:10102,pitch:90,yaw:0,distance:100,duration:this.duration,heightRadio:1,enableCurve:!1,onFinish:Ze};e=Ce(Ce({},t),e);var n=this.view3d;if(h(n,"FlyToObjectByType"))return j.apply(void 0,[10,n,n.FlyToObjectByType].concat(De(e)))}},{key:"flyToObjectByIds",value:function(e){var t={ids:[],pitch:90,yaw:0,distance:100,duration:this.duration,heightRadio:1,enableCurve:!1,onFinish:Ze};e=Ce(Ce({},t),e);var n=this.view3d;if(h(n,"FlyToObjectByIds"))return j.apply(void 0,[10,n,n.FlyToObjectByIds].concat(De(e)))}},{key:"zoomIn",value:function(){var r=G(D.mark(function t(){var n;return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(n=this.view3d,!h(n,"ZoomIn")){o.next=3;break}return o.abrupt("return",j(10,n,n.ZoomIn));case 3:case"end":return o.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"zoomOut",value:function(){var r=G(D.mark(function t(){var n;return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(n=this.view3d,!h(n,"ZoomOut")){o.next=3;break}return o.abrupt("return",j(10,n,n.ZoomOut));case 3:case"end":return o.stop()}},t,this)}));function e(){return r.apply(this,arguments)}return e}()},{key:"setPitchAngle",value:function(){var r=G(D.mark(function t(n){var a;return D.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"SetPitchAngle")){u.next=3;break}return u.abrupt("return",j(100,a,a.SetPitchAngle,n));case 3:case"end":return u.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"getPitchAngle",value:function(){var r=G(D.mark(function t(n){var a;return D.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"GetPitchAngle")){u.next=3;break}return u.abrupt("return",q(a,a.GetPitchAngle));case 3:case"end":return u.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"setRotateAngle",value:function(){var r=G(D.mark(function t(n){var a;return D.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"SetRotateAngle")){u.next=3;break}return u.abrupt("return",j(100,a,a.SetRotateAngle,n));case 3:case"end":return u.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"getRotateAngle",value:function(){var r=G(D.mark(function t(n){var a;return D.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(a=this.view3d,!h(a,"GetRotateAngle")){u.next=3;break}return u.abrupt("return",q(a,a.GetRotateAngle));case 3:case"end":return u.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"rotate",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={gid:"",pitch:90,radio:1,distance:10,highlight:!0};e=Ce(Ce({},t),e);var n=this.view3d;h(n,"Rotate")&&n.Rotate(e.pitch,e.radio,e.distance,e.gid,e.highlight)}}]),i}();function Rr(i,r){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=so(i))||r&&i&&typeof i.length=="number"){e&&(i=e);var t=0,n=function(){};return{s:n,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function so(i,r){if(!!i){if(typeof i=="string")return Dr(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Dr(i,r)}}function Dr(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}var lo=Ie,Mr=le,x=se,co=function(){function i(r,e){S(this,i),this._view3d=r,this._drawCtl=e,this.config=e.config,this.mapViewer=e._mapView}return R(i,[{key:"_draw",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{isOnce:!1,onDraw:x,onFinish:x,drawPoints:!0,pointsVisible:!0},n=this.mapViewer,a=t.onDraw,o=t.onFinish,u=t.drawPoints;t.pointsVisible;var s=t.isOnce,l=this,f=null,c=[];n.event.silent();var g=this._drawCtl,m=function b(){if(g.overLayerStopEdit(),window.removeEventListener("contextmenu",b),u){var C=Rr(c),L;try{for(C.s();!(L=C.n()).done;){var E=L.value;g.overLayerRemoveObject(E)}}catch(I){C.e(I)}finally{C.f()}}n.event.reBindMouseClickCallback(),Mr(o)&&o(f)};window.addEventListener("contextmenu",m),g.overLayerStartEdit(e,function(b){if(f=b,lo(b.points)&&u){var C=Rr(b.points.slice(c.length)),L;try{for(C.s();!(L=C.n()).done;){var E=L.value;l.point({radius:5,color:e.color,location:E},!1).then(function(I){c.push(I)})}}catch(I){C.e(I)}finally{C.f()}}Mr(a)&&a(b),s&&m()})}},{key:"text",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this._drawCtl,a=this.config.text(e);return n.overLayerCreateObject(a,t)}},{key:"drawText",value:function(e){var t=this.config.text(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"model",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this._drawCtl;return n.overLayerCreateObject(this.config.model(e),t)}},{key:"drawModel",value:function(e){var t=this.config.model(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"image",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=this._drawCtl;return n.overLayerCreateObject(this.config.image(e),t)}},{key:"drawImage",value:function(e){var t=this.config.image(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"point",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.circle(this.config.point(e),t)}},{key:"drawPoint",value:function(e){var t=this.config.point(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"line",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return(!e.points||e.points.length<2)&&Ut("\u521B\u5EFA\u7EBF\uFF0C\u5FC5\u987B\u63D0\u4F9B points \u53C2\u6570\uFF0C\u4E14\u81F3\u5C11\u5305\u542B\u4E24\u4E2A\u53CA\u4EE5\u4E0A\u4E2A\u70B9\uFF01"),this._drawCtl.overLayerCreateObject(this.config.line(e),t)}},{key:"drawLine",value:function(e){var t=this.config.line(e),n={isOnce:!0,onDraw:e.onDraw||x,onFinish:e.onFinish||x,drawPoints:e.drawPoints||!1,pointsVisible:e.pointsVisible||!1};this._draw(t,n)}},{key:"polygon",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.polygon(e),t)}},{key:"drawPolygon",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=this.config.polygon(e),n={onDraw:e.onDraw||x,onFinish:e.onFinish||x,drawPoints:e.drawPoints||!0,pointsVisible:e.pointsVisible||!0};this._draw(t,n)}},{key:"circle",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.circle(e),t)}},{key:"imageLabel",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.imageLabel(e),t)}},{key:"drawImageLabel",value:function(e){var t=this.config.imageLabel(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"polygon3d",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.polygon3d(e),t)}},{key:"drawPolygon3d",value:function(e){var t=this.config.polygon3d(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"triangle",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.triangle(e),t)}},{key:"drawTriangle",value:function(e){var t=this.config.triangle(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"rect",value:function(e,t){return this._drawCtl.overLayerCreateObject(this.config.rect(e),t)}},{key:"drawRect",value:function(e){var t=this.config.rect(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"regularPolygon",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.regularPolygon(e),t)}},{key:"drawRegularPolygon",value:function(e){var t=this.config.regularPolygon(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"shape",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.shape(e),t)}},{key:"drawShape",value:function(e){var t=this.config.shape(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"box",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.box(e),t)}},{key:"drawBox",value:function(e){var t=this.config.box(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"pyramid",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.pyramid(e),t)}},{key:"drawPyramid",value:function(e){var t=this.config.pyramid(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"cone",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.cone(e),t)}},{key:"drawCone",value:function(e){var t=this.config.cone(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"cylinder",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.cylinder(e),t)}},{key:"drawCylinder",value:function(e){var t=this.config.cylinder(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"sphere",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.sphere,t)}},{key:"drawSphere",value:function(e){var t=this.config.sphere(e),n={isOnce:!0,onFinish:e.onFinish||x};this._draw(t,n)}},{key:"skeleton",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.skeleton,t)}},{key:"billBoard",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.billBoard(e),t)}},{key:"vlcMedia",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.vlcMedia(e),t)}},{key:"routeModel",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._drawCtl.overLayerCreateObject(this.config.routeModel(e),t)}},{key:"layer",value:function(e){return this._drawCtl.layerLoadAsync(this.config.layer(e))}},{key:"layerDynamic",value:function(e){return this._drawCtl.layerLoadAsync(this.config.layerDynamic(e))}},{key:"route",value:function(e){return this._drawCtl.createRoute(this.config.route(e))}}]),i}(),fo=function(){function i(r,e){S(this,i),this._view3d=r,this._drawCtl=e}return R(i,[{key:"one",value:function(e){return this._drawCtl.findObjectById(e)}},{key:"all",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"*";return this._drawCtl.findObjectByPrefix(e)}}]),i}(),vo=R(function i(r){S(this,i),this._view3d=r}),ho=function(){function i(r,e){S(this,i),this._view3d=r,this._drawCtl=e}return R(i,[{key:"all",value:function(){this._drawCtl.overLayerRemoveAll()}},{key:"one",value:function(e){this._drawCtl.overLayerRemoveObject(e)}},{key:"oneById",value:function(e){return this._drawCtl.overLayerRemoveObjectById(e)}}]),i}(),go=R(function i(){S(this,i),this.LINE={SIM_ARRAW:"sim_arraw",SIM_DOT:"sim_dot",SIM_DASHED:"sim_dashed",SIM_FLASH:"sim_flash",SIM_CAN:"sim_scan"}});const po=new go;var Wt="10001",zt="10001_01",Yt="10001_02",Jt="10001_03",Xt="10001_05",Qe="10002",Zt="10002_01",mo="10003",Br="10004",Qt="10004_01",en="10004_02",yo="10005",bo="10006",wo="10007",Co="10008",Oo="10009",tn="10010",ko="10010_01",_o="10012",Eo="10013",So="10014",et={text:{type:10002,typeName:"label"},model:{type:10002,typeName:"model"},image:{type:10102,typeName:"image"},point:{type:10002,typeName:"circle"},line:{type:10002,typeName:"linestring"},polygon:{type:10002,typeName:"polygon"},circle:{type:10002,typeName:"circle"},imageLabel:{type:10002,typeName:"imageLabel"},polygon3d:{type:10002,typeName:"polygon3d"},triangle:{type:10002,typeName:"triangle"},rect:{type:10002,typeName:"rect"},regularPolygon:{type:10002,typeName:"regularPolygon"},shape:{type:10002,typeName:"shape"},box:{type:10002,typeName:"box"},pyramid:{type:10002,typeName:"pyramid"},cone:{type:10002,typeName:"cone"},cylinder:{type:10002,typeName:"cylinder"},sphere:{type:10002,typeName:"sphere"},skeleton:{type:10002,typeName:"skeleton"},billBoard:{type:10002,typeName:"webbrowser"},media:{type:10002,typeName:"media"},dynamicModel:{type:10002,typeName:"dynamicModel"},routeModel:{type:10002,typeName:"routeModel"},layer:{type:10002,typeName:"MLT_LAYER_SHAPE"},layerDynamic:{type:10002,typeName:"MLT_LAYER_POS_DYNAMIC"},route:{type:10002,typeName:"route_patrol"},videoSequence:{type:10002,typeName:"video_sequence"},video:{type:10002,typeName:"video_rtsp"},videoProjection:{type:10002,typeName:"media2"},region:{type:10002,typeName:"region"},heatmap:{type:10002,typeName:"heatmap_rect"}};const jr=Object.freeze(Object.defineProperty({__proto__:null,CATEGORY_CAMERA:Wt,CAMERA_TYPE_BOX:zt,CAMERA_TYPE_SPEED_DOME:Yt,CAMERA_TYPE_DOME:Jt,CATEGORY_BAYONET:Xt,CATEGORY_DOOR:Qe,CATEGORY_DOOR_HK_FACE_ACCESS_TERMINAL:Zt,CATEGORY_FIRE_EXTINGUISHING:mo,CATEGORY_INTERCOM:Br,CATEGORY_INTERCOM_HK_INDOOR:Qt,CATEGORY_INTERCOM_HK_OUTDOOR:en,CATEGORY_BROADCAST:yo,CATEGORY_ALARM:bo,CATEGORY_LIGAN:wo,CATEGORY_WINDOW:Co,CATEGORY_BED:Oo,CATEGORY_FACE:tn,CATEGORY_FACE_HK_400:ko,CATEGORY_AGV:_o,CATEGORY_CAR:Eo,CATEGORY_ROBOT:So,TYPE:et},Symbol.toStringTag,{value:"Module"}));function Pr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function B(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Pr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Pr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var P=et,N=Tt,Io=function(){function i(){S(this,i)}return R(i,[{key:"getTypeName",value:function(e){return e.typeName}},{key:"mergeConfig",value:function(e){return e.id||(e.id=Vt()),e.gid||(e.gid=e.id),B(B({},e),{},{attr:B(B({},e.attr),{},{gid:e.gid||e.id})})}},{key:"text",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.text),text:"",font:"\u9ED1\u4F53",fontcolor:"#ffffff",fontsize:24,halign:"center",valign:"bottom",location:null},N(e)))}},{key:"model",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.model),filename:"default",scale:1,style:"red",location:null},N(e)))}},{key:"image",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.image),style:"default",scale:1,screen:!0,location:null},N(e)))}},{key:"point",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.point),radius:10,color:"red",location:null},N(e)))}},{key:"line",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.line),style:"red",linewidth:10,points:[]},N(e)))}},{key:"polygon",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.polygon),points:[],color:"#00ff00",linecolor:"#00ff00",lineWidth:1,linevisible:!0},N(e)))}},{key:"circle",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.circle),radius:10,color:"red",location:null},N(e)))}},{key:"imageLabel",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.imageLabel),lighting:!0,iconstyle:"default.png",text:"\u6D4B\u8BD5\u6587\u672C",fontcolor:"#ffffff",fontbg:"",fontsize:32,style:"white",pwidth:1,pheight:50,scale:1,screen:!1,offsetx:0,offsety:0,location:null},N(e)))}},{key:"polygon3d",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.polygon3d),style:"green",color:"#0000ff",linewidth:5,linestyle:"green",linecolor:"#0000ff",linevisible:!0,roofvisible:!1,roofheight:400,edgestyle:"green",edgecolor:"#0000ff",edgeheight:400,points:[]},N(e)))}},{key:"triangle",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.triangle),color:"#ffffff",points:[]},N(e)))}},{key:"rect",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.rect),length:100,width:100,color:"#ffffff",location:null},N(e)))}},{key:"regularPolygon",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.regularPolygon),radius:100,num:5,color:"#ffffff",location:null},N(e)))}},{key:"shape",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.shape),scale:1,style:"box",color:"#ffffff",location:null},N(e)))}},{key:"box",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.box),length:100,width:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"pyramid",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.pyramid),radius:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"cone",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.cone),radius:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"cylinder",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.cylinder),radius:100,height:100,color:"#ffffff",location:null},N(e)))}},{key:"sphere",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.sphere),scale:1,radius:100,color:"#ffffff",location:null},N(e)))}},{key:"skeleton",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.skeleton),filename:"person",scale:1,color:"#ffffff",location:null},N(e)))}},{key:"billBoard",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.billBoard),url:"",width:100,height:100,screen:!0,location:null},N(e)))}},{key:"media",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.media),url:"",screen:!0,scale:1,width:100,height:100,location:null},N(e)))}},{key:"dynamicModel",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.dynamicModel),scale:1,filename:"",location:null},N(e)))}},{key:"routeModel",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.routeModel),scale:1,speed:20,filename:"default",points:[],location:null},N(e)))}},{key:"layer",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.layer),shapes:[]},N(e)))}},{key:"layerDynamic",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.layerDynamic),speed:10,shapes:[]},N(e)))}},{key:"route",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.route),visible:!0,style:"sim_arraw",showloc:!0,width:100,speed:2e3,distance:1e3,pitch:35,iselev:!0,geom:[]},N(e)))}},{key:"videoSequence",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return{type:this.getTypeName(P.videoSequence),id:e}}},{key:"video",value:function(e){return B({type:this.getTypeName(P.video),url:"",width:10,height:10,position:null},N(e))}},{key:"videoProjection",value:function(e){return this.mergeConfig(B({type:this.getTypeName(P.videoProjection),url:"",width:50,height:45,bwidth:10,barch:5,points:[],location:null},N(e)))}},{key:"region",value:function(e){return B({type:this.getTypeName(P.region),style:"default",geom:null},N(e))}},{key:"heatmap",value:function(e){return B({type:this.getTypeName(P.heatmap),pheight:100,minx:0,miny:0,maxx:0,maxy:0,gradient:{},points:[]},N(e))}}]),i}();const Ao=new Io;function Nr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function Lo(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Nr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Nr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var Ro=We,je=se,Do=Tt,Mo=function(){function i(r,e){S(this,i),this._view3d=r,this._event=e.event,this._mapView=e,this.config=Ao,this.create=new co(r,this),this.find=new fo(r,this),this.remove=new ho(r,this),this.update=new vo(r,this),this.ACTOR=po}return R(i,[{key:"overLayerSelectObjectEdit",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:je,t=this._view3d,n=this;if(h(t,"OverLayerSelectObjectEdit")){var a=function o(){n.overLayerStopEdit(),window.removeEventListener("contextmenu",o)};window.addEventListener("contextmenu",a),t.OverLayerSelectObjectEdit(function(o){e&&e(o)})}}},{key:"overLayerStartEdit",value:function(e,t){var n=this._view3d;if(h(n,"OverLayerStartEdit"))return j(10,n,n.OverLayerStartEdit,function(){n.OverLayerStartEdit(e,t)})}},{key:"overLayerStopEdit",value:function(){var e=this,t=this._view3d;if(h(t,"OverLayerStopEdit"))return j(10,t,t.OverLayerStopEdit,function(){e._event.reBindMouseClickCallback()})}},{key:"overLayerCreateObject",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ro,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a=this._view3d;if(h(a,"OverLayerCreateObject"))return q(a,a.OverLayerCreateObject,t,function(o){n&&e._event.reBindMouseClickCallback()})}},{key:"overLayerCreateObjects",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;t.length>200&&console.warn("OverLayerCreateObjects \u4E00\u6B21\u521B\u5EFA\u5BF9\u8C61\u7684\u6570\u91CF\u4E0D\u5E94\u8D85\u8FC7200\u4E2A\uFF0C\u4E0D\u7136\u6709\u5931\u8D25\u7684\u98CE\u9669\u3002");var a=this._view3d;if(h(a,"OverLayerCreateObjects"))return q(a,a.OverLayerCreateObjects,t,function(){n&&e._event.reBindMouseClickCallback()})}},{key:"findObjectById",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=this._view3d;if(h(t,"FindObjectById"))return q(t,t.FindObjectById,e)}},{key:"findObjectByPrefix",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=this._view3d;if(h(n,"FindObjectByPrefix"))return q(n,n.FindObjectByPrefix,e,t)}},{key:"overLayerUpdateObject",value:function(e){var t=this._view3d;h(t,"OverLayerUpdateObject")&&t.OverLayerUpdateObject(e)}},{key:"overLayerUpdateObjectAsync",value:function(e){var t=this._view3d;if(h(t,"OverLayerUpdateObject"))return j(20,t,t.OverLayerUpdateObject,e)}},{key:"updateObjectStyle",value:function(e,t){var n=this._view3d;h(n,"UpdateObjectStyle")&&n.UpdateObjectStyle(e,t)}},{key:"updateObjectStyleAsync",value:function(e,t){var n=this._view3d;if(h(n,"UpdateObjectStyle"))return j(20,n,n.UpdateObjectStyle,e,t)}},{key:"updateObject",value:function(e){var t=this._view3d;h(t,"UpdateObject")&&t.UpdateObject(e)}},{key:"updateObjectAsync",value:function(e){var t=this._view3d;if(h(t,"UpdateObject"))return j(20,t,t.UpdateObject,e)}},{key:"updateObjects",value:function(e){var t=this._view3d;h(t,"UpdateObjects")&&t.UpdateObjects(e)}},{key:"resetObjects",value:function(){var e=this._view3d;h(e,"ResetObjects")&&e.ResetObjects()}},{key:"updateObjectsAsync",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,n=this._view3d;if(h(n,"UpdateObjects"))return j(t,n,n.UpdateObjects,e)}},{key:"clearObjectStyle",value:function(){var e=this._view3d;h(e,"ClearObjectStyle")&&e.ClearObjectStyle()}},{key:"getObjectsVisible",value:function(){var e=this._view3d;if(h(e,"GetObjectsVisible"))return q(e,e.GetObjectsVisible)}},{key:"setObjectsVisible",value:function(e){var t=this._view3d;h(t,"SetObjectsVisible")&&t.SetObjectsVisible(e)}},{key:"setObjectsVisibleAsync",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,n=this._view3d;if(h(n,"SetObjectsVisible"))return j(t,n,n.SetObjectsVisible,e)}},{key:"updateObjectVisible",value:function(e,t){var n=this._view3d;h(n,"UpdateObjectVisible")&&n.UpdateObjectVisible(e,t)}},{key:"updateObjectVisibleAsync",value:function(e,t){var n=this._view3d;if(h(n,"UpdateObjectVisible"))return j(10,n,n.UpdateObjectVisible,e,t)}},{key:"overLayerRemoveObject",value:function(e){var t=this._view3d;h(t,"OverLayerRemoveObject")&&t.OverLayerRemoveObject(e)}},{key:"overLayerRemoveObjectById",value:function(e){var t=this._view3d;if(h(t,"OverLayerRemoveObjectById"))return j(20,t,t.OverLayerRemoveObjectById,e)}},{key:"overLayerRemoveObjectsById",value:function(e){var t=this._view3d;if(h(t,"OverLayerRemoveObjectsById"))return j(20,t,t.OverLayerRemoveObjectsById,e)}},{key:"overLayerRemoveAll",value:function(){var e=this._view3d;h(e,"OverLayerRemoveAll")&&e.OverLayerRemoveAll()}},{key:"setObjectHighlight",value:function(e){var t=this._view3d;if(h(t,"SetObjectHighlight"))return j(20,t,t.SetObjectHighlight,e)}},{key:"setObjectsHighlightByPrefix",value:function(e){if(!!e){var t=this._view3d;h(t,"SetObjectsHighlightByPrefix")&&t.SetObjectsHighlightByPrefix(e)}}},{key:"clearHighlight",value:function(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20,a=this._view3d;if(h(a,"ClearHighlight"))return j(n,a,a.ClearHighlight,function(){t&&e._event.reBindMouseClickCallback()})}},{key:"layerLoad",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=this._view3d;h(n,"LayerLoad")&&n.LayerLoad(e,function(a){t(a)})}},{key:"layerLoadAsync",value:function(e){var t=this._view3d;if(h(t,"LayerLoad"))return q(t,t.LayerLoad,e)}},{key:"layerSetVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this._view3d;h(n,"LayerSetVisible")&&n.LayerSetVisible(e,t)}},{key:"layerSetVisibleAsync",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this._view3d;if(h(n,"LayerSetVisible"))return j(20,n,n.LayerSetVisible,e,t)}},{key:"layerRemove",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=this._view3d;h(t,"LayerRemove")&&t.LayerRemove(e)}},{key:"layerRemoveAsync",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=this._view3d;if(h(t,"LayerRemove"))return j(20,t,t.LayerRemove,e)}},{key:"layerReLoad",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=this._view3d;h(n,"LayerReLoad")&&n.LayerReLoad(e,t)}},{key:"layerReLoadAsync",value:function(e){var t=this._view3d;if(h(t,"LayerReLoad"))return q(t,t.LayerReLoad,e)}},{key:"createRoute",value:function(e){var t=this._view3d;if(h(t,"CreateRoute"))return q(t,t.CreateRoute,e)}},{key:"playRoute",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:je,t=this._view3d;h(t,"CreateRoute")&&t.PlayRoute(function(n){e(n)})}},{key:"pauseRoute",value:function(){var e=this._view3d;h(e,"PauseRoute")&&e.PauseRoute()}},{key:"resumeRoute",value:function(e){var t=this._view3d;h(t,"resumeRoute")&&t.ResumeRoute(e)}},{key:"stopRoute",value:function(){var e=this._view3d;h(e,"StopRoute")&&e.StopRoute()}},{key:"playSequence",value:function(e){var t=this._view3d;h(t,"PlaySequence")&&t.PlaySequence(e)}},{key:"pauseSequence",value:function(e){var t=this._view3d;h(t,"PlaySequence")&&t.PlaySequence(e)}},{key:"stopSequence",value:function(e){var t=this._view3d;h(t,"StopSequence")&&t.StopSequence(e)}},{key:"isPlayingSequence",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:je,n=this._view3d;h(n,"IsPlayingSequence")&&n.IsPlayingSequence(e,t)}},{key:"isPausedSequence",value:function(e,t){var n=this._view3d;h(n,"IsPausedSequence")&&n.IsPausedSequence(e,t)}},{key:"streamVideoOpen",value:function(e){var t=this._view3d,n=Lo({url:"",width:10,height:9,position:null},Do(e));h(t,"StreamVideoOpen")&&t.StreamVideoOpen(n)}},{key:"streamVideoClose",value:function(){var e=this._view3d;h(e,"StreamVideoClose")&&e.StreamVideoClose()}},{key:"setHighlightRegion",value:function(e){var t=this._view3d,n={style:"default",geom:e};h(t,"SetHighlightRegion")&&t.SetHighlightRegion(n)}},{key:"clearHighlightRegion",value:function(){var e=this._view3d;h(e,"ClearHighlightRegion")&&e.ClearHighlightRegion()}}]),i}(),Fr=se,Bo=R(function i(r,e){var t=this;S(this,i),d(this,"selectIds",function(){return Array.from(t.entity.ids)}),d(this,"selectEntities",function(){return Array.from(t.entity.data.values())}),d(this,"selectAll",function(){var n=t.selectIds();return n.reduce(function(a,o){var u=t.selectDataById(o);return u&&a.push(u),a},[])}),d(this,"selectTotal",function(){return t.selectIds().length}),d(this,"selectDataById",function(n){var a=t.entity.data.get(n);return a?a.getState():(console.warn("cannot find entity for id: ".concat(n,".")),null)}),d(this,"selectEntityById",function(n){var a=t.entity.data.get(n);return a||(console.warn("cannot find entity for id: ".concat(n,".")),null)}),d(this,"selectByCategory",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"category_id";return t.selectAll().filter(function(o){return o[a]===n})}),d(this,"selectEntitiesByCategory",function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"category";return t.selectEntities().filter(function(o){return o[a]===n})}),d(this,"selectMapEntityById",function(n){return t.selectEntityById(n).getEntityData()}),d(this,"selectMapEntity",function(n){return n.reduce(function(a,o){return a.push.apply(a,De(o.getEntityData())),a},[])}),d(this,"filter",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fr;return t.selectAll().filter(n)}),d(this,"filterEntities",function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fr;return t.selectEntities().filter(n)}),d(this,"filterOutDoor",function(){return t.filter(function(n){return!n.indoor})}),d(this,"filterOutDoorEntities",function(){return t.filterEntities(function(n){return!n.data.indoor})}),d(this,"filterByBuilding",function(n){return t.filter(function(a){return a.build_id===n})}),d(this,"filterEntityByBuilding",function(n){return t.filterEntities(function(a){return a.data.build_id===n})}),d(this,"filterByFloor",function(n,a){return t.filter(function(o){return o.indoor&&o.build_id===n&&o.floor_id===a})}),d(this,"filterEntityByFloor",function(n,a){return t.filterEntities(function(o){return o.data.indoor&&o.data.build_id===n&&o.data.floor_id===a})}),this.entity=r,this.mapViewer=e}),Ae=se,nn={isFirst:!1,size:200,onMap:!0,instance:!0,onSuccess:Ae,onProgress:Ae,onError:Ae},Pe={draw:!1,onMap:!0,scale:1,image:!0,imageScale:1,imageVisible:!0,modelVisible:!0,modelScale:1,textVisible:!0,textScale:1,visibleDistance:1e5,visibleInViewBox:!1,onSuccess:Ae,onError:Ae,onVisibleStatusChange:Ae};function Tr(i,r){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=jo(i))||r&&i&&typeof i.length=="number"){e&&(i=e);var t=0,n=function(){};return{s:n,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function jo(i,r){if(!!i){if(typeof i=="string")return Vr(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Vr(i,r)}}function Vr(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}function $r(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function Hr(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?$r(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):$r(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var Ur=Vt,xr="MODEL_INSTANCE_TYPE",Le=function(){function i(r,e,t){S(this,i),this.$$typeof=xr,this.config=t,this.data=null,this.id=null,this.entity=new Map,this.type=e.category_id,this.typeName="\u6A21\u578B\u57FA\u7C7B",this.visible=!1,this.created=!1,this.mapViewer=r,this.setData(e)}return R(i,[{key:"_concatGid",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ur(),t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ur();return"".concat(e,"_").concat(t)}},{key:"setState",value:function(e,t){this[e]=t}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){e&&(this.data=e,this.id=e.id)}},{key:"getEntity",value:function(e){return e?this.entity.get(e):this.entity}},{key:"getAllEntities",value:function(){return Array.from(this.entity.values())}},{key:"getEntityData",value:function(){return Array.from(this.entity.values()).map(function(e){return e.data})}},{key:"setEntity",value:function(e,t){this.entity.set(e,{gid:t.gid||t.attr.id,type:t.type,data:t,visible:t.visible})}},{key:"deleteEntity",value:function(e){this.entity.delete(e)}},{key:"getModel",value:function(){return this.entity.get("model")}},{key:"getIcon",value:function(){return this.entity.get("icon")}},{key:"setModel",value:function(e){this.setEntity("model",e)}},{key:"setIcon",value:function(e){this.setEntity("icon",e)}},{key:"getIconLocation",value:function(e){return e?Hr(Hr({},e),{},{z:e.z+20}):null}},{key:"setVisible",value:function(e){var t=this.mapViewer.drawer;if(e!==this.visible){var n=Tr(this.entity.values()),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;t.updateObjectVisible(o.gid,e)}}catch(u){n.e(u)}finally{n.f()}this.markVisible(e)}}},{key:"markVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.visible=e}},{key:"markCreated",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.created=e}},{key:"clearEntity",value:function(){this.entity.clear()}},{key:"flyTo",value:function(e){if(this.data.center){var t=this.data.center,n={x:t.x,y:t.y,z:t.z,pitch:t.pitch,yaw:t.yaw,roll:t.roll};this.mapViewer.camera.flyToPositionByOptions({position:n,duration:e.duration})}if(this.data.indoor){var a=this.data.build_id,o=this.data.floor_id,u=this.mapViewer.model,s=u.getAdapter();s.setVisible(a,o)}}},{key:"highlight",value:function(){var e=this.getModel(),t=this.mapViewer;return this.clearHighlight().then(function(){e&&t.drawer.setObjectHighlight(e==null?void 0:e.gid)}),this}},{key:"clearHighlight",value:function(){var e=this.mapViewer,t=e.drawer;return t.clearHighlight()}},{key:"create",value:function(){var e=this,t=this.config,n=this.data||{},a=this.mapViewer.drawer,o=this.mapViewer.event,u=JSON.parse(JSON.stringify(n)),s=function(f,c){c&&e.setModel(n),e.markCreated(!0),e.markVisible(!0),t.onSuccess(f)};t.draw?o.setMousePositionCallback(function(l){u.location=l,a.overLayerCreateObject(u).then(function(f){s(f,!0)})}):(e.setModel(u),t.onMap&&a.overLayerCreateObject(u).then(function(l){s(l,!1)}))}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.config,n=e.changes,a=e.data,o=this.mapViewer.drawer;if(t&&this.setState("config",t),a&&this.setState("data",a),n){var u=this.getModel(),s=this.getIcon();s&&(s.data.location=this.getIconLocation(n),o.overLayerUpdateObject(s.data)),u.data.location=n,o.overLayerUpdateObject(u.data)}}},{key:"destroy",value:function(){var e=this.entity,t=this.mapViewer.drawer,n=Tr(e.entries()),a;try{for(n.s();!(a=n.n()).done;){var o=ut(a.value,2),u=o[0],s=o[1];t.remove.one(s.data)}}catch(l){n.e(l)}finally{n.f()}this.clearEntity()}}]),i}();d(Le,"CATEGORY","MODEL");function O(i){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},O(i)}function Po(i,r){for(;!Object.prototype.hasOwnProperty.call(i,r)&&(i=O(i),i!==null););return i}function J(){return typeof Reflect<"u"&&Reflect.get?J=Reflect.get.bind():J=function(r,e,t){var n=Po(r,e);if(!!n){var a=Object.getOwnPropertyDescriptor(n,e);return a.get?a.get.call(arguments.length<3?r:t):a.value}},J.apply(this,arguments)}function rn(i,r){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},rn(i,r)}function ee(i,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(r&&r.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),r&&rn(i,r)}function W(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function te(i,r){if(r&&(ie(r)==="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return W(i)}function Kr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function Gr(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Kr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Kr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function No(i){var r=Fo();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function Fo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qr=We,To=se,_=function(i){ee(e,i);var r=No(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),e.mapViewer=t,n.category=e.model,n.categoryName="\u76D1\u63A7",n.type=Wt,n.typeName="\u76D1\u63A7",n.fileName="qiangji",n}return R(e,[{key:"setModelVisible",value:function(){}},{key:"setIconVisible",value:function(){}},{key:"getArea",value:function(){return this.entity.get("area")}},{key:"setArea",value:function(n){this.setEntity("area",n)}},{key:"flyTo",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{speed:40,showLocation:!1};return J(O(e.prototype),"flyTo",this).call(this,n),this}},{key:"create",value:function(){var n,a=this,o=this.config,u=this.data||qr,s=this.mapViewer.drawer,l=this.mapViewer.event,f=s.config.model({attr:{id:u.id,gid:this._concatGid(e.model,u.id)},gid:this._concatGid(e.model,u.id),fileName:this.fileName,scale:1,location:(u==null||(n=u.options)===null||n===void 0?void 0:n.location)||null}),c=s.config.image({attr:{id:u.id,gid:this._concatGid(e.icon,u.id)},gid:this._concatGid(e.icon,u.id),style:this.fileName+"_icon",location:a.getIconLocation(f==null?void 0:f.location)}),g=function(b,C){C&&(a.setModel(f),a.setIcon(c)),a.markVisible(!0),a.markCreated(!0),o.onSuccess(b)};return o.draw?l.setMousePositionCallback(function(m){f.location=m,c.location=a.getIconLocation(m),s.create.image(c),s.create.model(f,!0).then(function(b){g(b,!0)})}):(a.setModel(f),a.setIcon(c),o.onMap&&(s.create.model(f),s.create.image(c,!0).then(function(m){g(m,!1)}))),this}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return J(O(e.prototype),"update",this).call(this,n),this}},{key:"destroy",value:function(){J(O(e.prototype),"destroy",this).call(this)}},{key:"updateImage",value:function(){}},{key:"updateText",value:function(){}},{key:"updateVisibleArea",value:function(){}},{key:"createArea",value:function(){var n=this.data||qr,a=this.mapViewer.drawer,o=this;if(n.camera_area){var u=this.getEntity("area");if(u)this.setAreaVisible(!0);else{var s=a.config.polygon(Gr(Gr({attr:{id:n.id}},n.camera_area),{},{gid:this._concatGid(e.area,n.id)}));a.create.polygon(s,!0).then(function(l){o.setArea(l)})}}}},{key:"drawArea",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:To,a=this.mapViewer,o=this,u=this._concatGid(e.area,this.data.id);a.drawer.create.drawPolygon({gid:u,attr:{id:this.data.id},onFinish:function(l){l&&o.setArea(l),n(l)}})}},{key:"clearArea",value:function(){var n=this.mapViewer.drawer,a=this.getArea();this.deleteEntity("area"),n.remove.one(a.data)}},{key:"setVisible",value:function(n){return J(O(e.prototype),"setVisible",this).call(this,n),this}},{key:"setAreaVisible",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,a=this.mapViewer.drawer,o=this.getEntity("area");o&&a.updateObjectVisible(o.gid,n)}}]),e}(Le);d(_,"mapViewer",null),d(_,"model","$CAMERA"),d(_,"icon","$ICON_CAMERA"),d(_,"area","$AREA_CAMERA"),d(_,"_getModelInstance",function(i){if(!i)return null;if(!!_.mapViewer){var r=_.mapViewer.model,e=r.getAdapter(),t=e.getSelector();return t.selectEntityById(i.attr.id)}}),d(_,"modelClickHandler",function(i){var r=_._getModelInstance(i);r&&r.flyTo()}),d(_,"modelDoubleClickHandler",function(i){var r=_._getModelInstance(i);r&&r.flyTo()}),d(_,"iconClickHandler",function(i){var r=_._getModelInstance(i);r&&r.flyTo()}),d(_,"iconDoubleClickHandler",function(i){var r=_._getModelInstance(i);r&&r.flyTo()}),d(_,"areaClickHandler",function(i){var r=_._getModelInstance(i);r&&r.flyTo()}),d(_,"areaDoubleClickHandler",function(i){var r=_._getModelInstance(i);r&&r.flyTo()});function Vo(i){var r=$o();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function $o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ho=function(i){ee(e,i);var r=Vo(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="CAMERA",n.categoryName="\u76D1\u63A7",n.type=zt,n.typeName="\u67AA\u673A",n.fileName="qiangji",n.create(),n}return R(e)}(_);function Uo(i){var r=xo();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function xo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ko=function(i){ee(e,i);var r=Uo(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="CAMERA",n.categoryName="\u76D1\u63A7",n.type=Yt,n.typeName="\u7403\u673A",n.fileName="qiuji",n.create(),n}return R(e)}(_);function Go(i){var r=qo();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function qo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Wo=function(i){ee(e,i);var r=Go(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="CAMERA",n.categoryName="\u76D1\u63A7",n.type=Jt,n.typeName="\u534A\u7403",n.fileName="banqiu",n.create(),n}return R(e)}(_);function zo(i){var r=Yo();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function Yo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Jo=function(i){ee(e,i);var r=zo(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="CAMERA",n.categoryName="\u76D1\u63A7",n.type=tn,n.typeName="\u4EBA\u8138",n.fileName="qiangji",n.create(),n}return R(e)}(_);function Xo(i){var r=Zo();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function Zo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Qo=function(i){ee(e,i);var r=Xo(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="CAMERA",n.categoryName="\u76D1\u63A7",n.type=Xt,n.typeName="\u5361\u53E3",n.fileName="qiangji",n.create(),n}return R(e)}(_);function eu(i){var r=tu();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function tu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var T=function(i){ee(e,i);var r=eu(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),e.mapViewer=t,n.category=e.model,n.categoryName="\u95E8\u7981",n.type=Qe,n.typeName="\u95E8\u7981",n.fileName="menjin",n.create(),n}return R(e,[{key:"create",value:function(){var n,a=this,o=this,u=this.config,s=this.data||{},l=this.mapViewer.drawer,f=this.mapViewer.event,c=l.config.model({attr:{id:s.id},gid:this._concatGid(e.model,s.id),fileName:this.fileName,scale:1,location:(s==null||(n=s.options)===null||n===void 0?void 0:n.location)||null}),g=l.config.image({attr:{id:s.id},gid:this._concatGid(e.icon,s.id),style:this.fileName+"_icon",location:o.getIconLocation(c==null?void 0:c.location)});u.draw?f.setMousePositionCallback(function(m){c.location=m,g.location=o.getIconLocation(m),l.create.image(g),l.create.model(c,!0).then(function(b){u.onSuccess(b)}),o.setModel(c),o.setIcon(g),a.markVisible(!0)}):(o.setModel(c),o.setIcon(g),u.onMap&&(l.create.model(c),l.create.image(g,!0),this.markVisible(!0)))}},{key:"flyTo",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{speed:40,showLocation:!1};return J(O(e.prototype),"flyTo",this).call(this,n),this}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return J(O(e.prototype),"update",this).call(this,n),this}},{key:"setVisible",value:function(n){return J(O(e.prototype),"setVisible",this).call(this,n),this}}]),e}(Le);d(T,"mapViewer",null),d(T,"model","$DOOR"),d(T,"icon","$ICON_DOOR"),d(T,"_getModelInstance",function(i){if(!i)return null;if(!!T.mapViewer){var r=T.mapViewer.model,e=r.getDeviceAdapter(),t=e.getSelector();return t.selectEntityById(i.attr.id)}}),d(T,"modelClickHandler",function(i){console.log(i);var r=T._getModelInstance(i);r&&r.flyTo()}),d(T,"modelDoubleClickHandler",function(i){console.log(i);var r=T._getModelInstance(i);r&&r.flyTo()}),d(T,"iconClickHandler",function(i){console.log(i);var r=T._getModelInstance(i);r&&r.flyTo()}),d(T,"iconDoubleClickHandler",function(i){console.log(i);var r=T._getModelInstance(i);r&&r.flyTo()});function nu(i){var r=ru();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function ru(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var iu=function(i){ee(e,i);var r=nu(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="DOOR",n.categoryName="\u95E8\u7981",n.type=Zt,n.typeName="\u6D77\u5EB7\u4EBA\u8138\u8BC6\u522B\u4E00\u4F53\u673A",n.fileName="menjin",n.create(),n}return R(e)}(T);function au(i){var r=ou();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function ou(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var F=function(i){ee(e,i);var r=au(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),e.mapViewer=t,n.category=e.model,n.categoryName="\u5BF9\u8BB2",n.type=Qe,n.typeName="\u5BF9\u8BB2",n.fileName="duijiang",n.create(),n}return R(e,[{key:"create",value:function(){var n,a=this,o=this,u=this.config,s=this.data||{},l=this.mapViewer.drawer,f=this.mapViewer.event,c=l.config.model({attr:{id:s.id},gid:this._concatGid(e.model,s.id),fileName:this.fileName,scale:1,location:(s==null||(n=s.options)===null||n===void 0?void 0:n.location)||null}),g=l.config.image({attr:{id:s.id},gid:this._concatGid(e.icon,s.id),style:this.fileName+"_icon",location:o.getIconLocation(c==null?void 0:c.location)});u.draw?f.setMousePositionCallback(function(m){c.location=m,g.location=o.getIconLocation(m),l.create.image(g),l.create.model(c,!0).then(function(b){u.onSuccess(b)}),o.setModel(c),o.setIcon(g),a.markVisible(!0)}):(o.setModel(c),o.setIcon(g),u.onMap&&(l.create.model(c),l.create.image(g,!0),this.markVisible(!0)))}},{key:"flyTo",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{speed:40,showLocation:!1};return J(O(e.prototype),"flyTo",this).call(this,n),this}},{key:"update",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return J(O(e.prototype),"update",this).call(this,n),this}},{key:"setVisible",value:function(n){return J(O(e.prototype),"setVisible",this).call(this,n),this}}]),e}(Le);d(F,"mapViewer",null),d(F,"model","$INTERCOM"),d(F,"icon","$ICON_INTERCOM"),d(F,"_getModelInstance",function(i){if(!i)return null;if(!!F.mapViewer){var r=F.mapViewer.model,e=r.getDeviceAdapter(),t=e.getSelector();return t.selectEntityById(i.attr.id)}}),d(F,"modelClickHandler",function(i){console.log(i);var r=F._getModelInstance(i);r&&r.flyTo()}),d(F,"modelDoubleClickHandler",function(i){console.log(i);var r=F._getModelInstance(i);r&&r.flyTo()}),d(F,"iconClickHandler",function(i){console.log(i);var r=F._getModelInstance(i);r&&r.flyTo()}),d(F,"iconDoubleClickHandler",function(i){console.log(i);var r=F._getModelInstance(i);r&&r.flyTo()});function uu(i){var r=su();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function su(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var lu=function(i){ee(e,i);var r=uu(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="INTERCOM",n.categoryName="\u5BF9\u8BB2",n.type=Qt,n.typeName="\u6D77\u5EB7\u5BF9\u8BB2\u5BA4\u5185\u7EC8\u7AEF",n.fileName="duijiang",n.create(),n}return R(e)}(F);function cu(i){var r=fu();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function fu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var du=function(i){ee(e,i);var r=cu(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.category="INTERCOM",n.categoryName="\u5BF9\u8BB2",n.type=en,n.typeName="\u6D77\u5EB7\u5BF9\u8BB2\u5BA4\u5916\u7EC8\u7AEF",n.fileName="duijiang",n.create(),n}return R(e)}(F);function vu(i){var r=hu();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function hu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var gu=function(i){ee(e,i);var r=vu(e);function e(t){var n;S(this,e);for(var a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];return n=r.call.apply(r,[this,t].concat(o)),n.type=et.image.typeName,n}return R(e,[{key:"create",value:function(){J(O(e.prototype),"create",this).call(this)}},{key:"flyTo",value:function(n){J(O(e.prototype),"flyTo",this).call(this,n)}},{key:"setVisible",value:function(n){J(O(e.prototype),"setVisible",this).call(this,n)}}]),e}(Le),pu=function(r){var e=Le,t=r.category_id,n=r.type;if(t!==void 0)switch(t){case Wt:e=_;break;case zt:e=Ho;break;case Yt:e=Ko;break;case Jt:e=Wo;break;case tn:e=Jo;break;case Xt:e=Qo;break;case Qe:e=T;break;case Br:e=F;break;case Qt:e=lu;break;case en:e=du;break;case Zt:e=iu;break}else if(n!==void 0)switch(n){case et.image.typeName:e=gu;break}return e},mu=function(){function i(r){S(this,i),this.mapViewer=r}return R(i,[{key:"create",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pe,n=pu(e);if(n)return new n(this.mapViewer,e,t);console.warn("device category of ".concat(e.categoryId,", is not support yet."))}}]),i}();function Wr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function zr(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Wr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Wr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var yu=Ie,Yr=se,bu=Pt,Jr=R(function i(r){var e=this;S(this,i),d(this,"addOne",function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Pe;return new mu(e.mapViewer).create(t,n)}),d(this,"updateOne",function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t==null||t.update(n)}),d(this,"deleteOne",function(t){t==null||t.destroy()}),d(this,"addMany",function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:nn,a=e.mapViewer,o=a.drawer;n=Object.assign({},{size:200,onSuccess:Yr,onProgress:Yr},n);var u=n,s=u.size,l=u.onSuccess,f=u.onProgress;if(!yu(t)){console.error("type source must be an array, got "+bu(t));return}var c=+new Date,g=t.length,m=function b(C){var L=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=t.slice(C,L);if(C>g-1){var I=+new Date;f&&f({progress:100}),console.log("\u52A0\u8F7D ".concat(g," \u4E2A\u6A21\u578B,\u5171\u8017\u65F6: ").concat((I-c)/1e3,"s. ")),l&&l();return}o.overLayerCreateObjects(E).then(function(){C<g&&(f&&f({progress:Math.floor(Math.pow(10,4)*(C/g)/100)}),b(L,L+s))}).catch(function(V){console.error(V)})};m(0,s)}),d(this,"updateMany",function(t,n){var a=t.reduce(function(o,u){return o.push.apply(o,De(u.getAllEntities().map(function(s){return zr(zr({},s.data),n)}))),u.markVisible(n.visible),o},[]);e.mapViewer.core.view3d.SetObjectsVisible(a)}),d(this,"deleteMany",function(){}),this.mapViewer=r});function ke(i,r){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=wu(i))||r&&i&&typeof i.length=="number"){e&&(i=e);var t=0,n=function(){};return{s:n,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function wu(i,r){if(!!i){if(typeof i=="string")return Xr(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return Xr(i,r)}}function Xr(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}function Zr(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function ue(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?Zr(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):Zr(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var tt=Ie,Cu=function(){function i(r){var e=this;S(this,i),d(this,"getSelector",function(){return e.selector}),d(this,"getController",function(){return e.controller}),d(this,"getInitialState",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Object.assign({},e.entity,t)}),d(this,"addOne",function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};n=ue(ue({},Pe),n);var a=t.id;e.entity.ids.add(t.id);var o=e.getController().addOne(t,n);return e.entity.data.set(a,o),o}),d(this,"addMany",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tt(t)){console.warn("addMany take array  as only argument.");return}n=ue(ue({},nn),n);var a=[];if(n.instance){var o=ke(t),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=e.addOne(s,ue(ue({},Pe),{},{onMap:!1}));a.push(l)}}catch(m){o.e(m)}finally{o.f()}}else a=t;if(n.onMap){var f=e.getSelector(),c=f.selectMapEntity,g=c(a);e.controller.addMany(g,ue(ue({},n),{},{onSuccess:function(){if(!n.instance){var b=ke(t),C;try{for(b.s();!(C=b.n()).done;){var L=C.value;L.$$typeof===xr&&(L.markVisible(!0),L.markCreated(!0))}}catch(E){b.e(E)}finally{b.f()}}}}))}return e}),d(this,"setAll",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tt(t)){console.warn("setAll take array  as only argument.");return}var a=ue(ue(ue({},nn),n),{},{isFirst:!0});return e.removeAll(),e.addMany(t,a),e}),d(this,"removeOne",function(t){if(!!t){var n=e.getSelector().selectEntityById(t);return e.getController().deleteOne(n),e.entity.ids.delete(t),e.entity.data.delete(t),e}}),d(this,"removeMany",function(t){if(!tt(t)){console.warn("removeMany take array  as only argument.");return}var n=ke(t),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;e.removeOne(o)}}catch(u){n.e(u)}finally{n.f()}return e}),d(this,"removeAll",function(){return e.removeMany(Array.from(e.entity.ids)),e.entity.ids.clear(),e.entity.data.clear(),e}),d(this,"upsertOne",function(t){return e.getSelector().selectDataById(t.id)?e.updateOne(t):e.addOne(t),e}),d(this,"upsertMany",function(t){var n=ke(t),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;e.upsertOne(o)}}catch(u){n.e(u)}finally{n.f()}return e}),d(this,"updateOne",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{data:null,config:{},changes:null},n=t.data,a=t.config;if(!(!n||!n.id)){a=ue(ue({},Pe),a);var o=e.getSelector().selectEntityById(n.id);if(o)if(o.data.category_id===n.category_id)e.getController().updateOne(o,t);else return e.removeOne(n.id),e.addOne(n,a);else console.warn("Can not update for Id: ".concat(n.id,", because it's instance don't exist."))}}),d(this,"updateMany",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(!tt(t)){console.warn("updateMany take Array as only argument.");return}var n=ke(t),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;e.updateOne(o)}}catch(u){n.e(u)}finally{n.f()}return e}),this.entity={ids:new Set,data:new Map},this.mapViewer=r,this.selector=new Bo(this.entity),this.controller=new Jr(this.mapViewer)}return R(i,[{key:"setVisible",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t={visible:!0,outdoor:!0,buildId:"",floorId:""},n=Object.assign({},t,e),a=n.outdoor,o=n.buildId,u=n.floorId,s=this.getSelector(),l=[];o&&!u?l=s.filterEntityByBuilding(o):o&&u&&(l=s.filterEntityByFloor(o,u)),a&&(l=l.concat(s.filterOutDoorEntities())),l=l.filter(function(p){return p.data.on_map});var f=[],c=[],g=[],m=this.getVisible(),b=ke(m),C;try{var L=function(){var U=C.value,H=l.find(function(X){return X.id===U.id});H||g.push(U)};for(b.s();!(C=b.n()).done;)L()}catch(p){b.e(p)}finally{b.f()}var E=ke(l),I;try{var V=function(){var U=I.value;if(U.created){var H=m.find(function(X){return X.id===U.id});H||c.push(U)}};for(E.s();!(I=E.n()).done;)V()}catch(p){E.e(p)}finally{E.f()}return l.forEach(function(p){p.created||f.push(p)}),f&&f.length>0&&this.addMany(f,{onMap:!0,instance:!1}),c&&c.length>0&&this.getController().updateMany(c,{visible:!0}),g&&g.length>0&&this.getController().updateMany(g,{visible:!1}),this}},{key:"getVisible",value:function(){var e=this.getSelector();return e.selectEntities().filter(function(t){return t.visible})}}]),i}();function Qr(i,r){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Ou(i))||r&&i&&typeof i.length=="number"){e&&(i=e);var t=0,n=function(){};return{s:n,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Ou(i,r){if(!!i){if(typeof i=="string")return ei(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ei(i,r)}}function ei(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}function ti(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function an(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?ti(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):ti(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}var ku=le,z={isOnce:!1,defaultAction:!0},on=function(){function i(r){S(this,i),d(this,"listen",function(){}),this.mapViewer=r,this.events=new Map,this.config=an({},z)}return R(i,[{key:"config",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:z;this.config=an(an({},z),e)}},{key:"getConfig",value:function(e){var t=this.events.get(e);return t?t.get("config"):null}},{key:"subscribe",value:function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:z,a=this.events.get(e),o=new Map;if(o.set("callback",t),o.set("config",n),a){var u=a.get("queue");u.add(o),a.set("config",n)}else{var s=new Map,l=new Set;l.add(o),s.set("queue",l),s.set("config",n),this.events.set(e,s)}}},{key:"unsubscribe",value:function(e,t){var n=this.events.get(e);if(n){var a=n.get("queue"),o=Qr(a.values()),u;try{for(o.s();!(u=o.n()).done;){var s=u.value;s.get("callback")===t&&a.delete(s)}}catch(l){o.e(l)}finally{o.f()}a.size===0&&this.events.delete(e)}}},{key:"dispatch",value:function(e){var t=this.events.get(e);if(t){for(var n=t.get("queue"),a=arguments.length,o=new Array(a>1?a-1:0),u=1;u<a;u++)o[u-1]=arguments[u];var s=Qr(n.values()),l;try{for(s.s();!(l=s.n()).done;){var f=l.value,c=f.get("callback"),g=f.get("config");ku(c)&&c.apply(void 0,o),g&&g.isOnce&&this.unsubscribe(e,c)}}catch(m){s.e(m)}finally{s.f()}}}},{key:"clear",value:function(){this.events.clear()}},{key:"onClick",value:function(e){}},{key:"offClick",value:function(e){}},{key:"onDoubleClick",value:function(e){}},{key:"offDoubleClick",value:function(e){}},{key:"onIconClick",value:function(e){}},{key:"offIconClick",value:function(e){}},{key:"onIconDoubleClick",value:function(e){}},{key:"offIconDoubleClick",value:function(e){}},{key:"_modelClickHandler",value:function(){}},{key:"_modelDoubleClickHandler",value:function(){}},{key:"_iconClickHandler",value:function(){}},{key:"_iconDoubleClickHandler",value:function(){}}]),i}();function _u(i){var r=Eu();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function Eu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _e=function(i){ee(e,i);var r=_u(e);function e(t){var n;return S(this,e),n=r.call(this,t),d(W(n),"listen",function(){var a=n.mapViewer.event;a.setMouseClickCallback(_.model,n._modelClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(_.model)}}),a.setMouseDoubleClickCallback(_.model,n._modelDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(_.model)}}),a.setMouseClickCallback(_.icon,n._iconClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(_.icon)}}),a.setMouseDoubleClickCallback(_.icon,n._iconDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(_.icon)}}),a.setMouseClickCallback(_.area,n._areaClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(_.area)}}),a.setMouseDoubleClickCallback(_.area,n._areaDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(_.area)}})}),n.listen(),n}return R(e,[{key:"_modelClickHandler",value:function(n){var a=this.getConfig(e.MODEL_CLICK);if(a){var o=a.defaultAction;o&&_.modelClickHandler(n),this.dispatch(e.MODEL_CLICK,n)}}},{key:"_modelDoubleClickHandler",value:function(n){var a=this.getConfig(e.MODEL_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&_.modelDoubleClickHandler(n),this.dispatch(e.MODEL_DOUBLE_CLICK,n)}}},{key:"_iconClickHandler",value:function(n){var a=this.getConfig(e.ICON_CLICK);if(a){var o=a.defaultAction;o&&_.iconClickHandler(n),this.dispatch(e.ICON_CLICK,n)}}},{key:"_iconDoubleClickHandler",value:function(n){var a=this.getConfig(e.ICON_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&_.iconDoubleClickHandler(n),this.dispatch(e.ICON_DOUBLE_CLICK,n)}}},{key:"_areaClickHandler",value:function(n){var a=this.getConfig(e.AREA_CLICK);if(a){var o=a.defaultAction;o&&_.areaClickHandler(n),this.dispatch(e.AREA_CLICK,n)}}},{key:"_areaDoubleClickHandler",value:function(n){var a=this.getConfig(e.AREA_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&_.areaDoubleClickHandler(n),this.dispatch(e.AREA_DOUBLE_CLICK,n)}}},{key:"clear",value:function(){}},{key:"onClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.MODEL_CLICK,n,a)}},{key:"offClick",value:function(n){this.unsubscribe(e.MODEL_CLICK,n)}},{key:"onDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.MODEL_DOUBLE_CLICK,n,a)}},{key:"offDoubleClick",value:function(n){this.unsubscribe(e.MODEL_DOUBLE_CLICK,n)}},{key:"onIconClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.ICON_CLICK,n,a)}},{key:"offIconClick",value:function(n){this.unsubscribe(e.ICON_DOUBLE_CLICK,n)}},{key:"onIconDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.ICON_DOUBLE_CLICK,n,a)}},{key:"offIconDoubleClick",value:function(n){this.unsubscribe(e.ICON_DOUBLE_CLICK,n)}},{key:"onAreaClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.AREA_CLICK,n,a)}},{key:"offAreaClick",value:function(n){this.unsubscribe(e.AREA_CLICK,n)}},{key:"onAreaDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.AREA_DOUBLE_CLICK,n,a)}},{key:"offAreaDoubleClick",value:function(n){this.unsubscribe(e.AREA_DOUBLE_CLICK,n)}}]),e}(on);d(_e,"MODEL_CLICK","MODEL_CLICK"),d(_e,"MODEL_DOUBLE_CLICK","MODEL_DOUBLE_CLICK"),d(_e,"ICON_CLICK","ICON_CLICK"),d(_e,"ICON_DOUBLE_CLICK","ICON_DOUBLE_CLICK"),d(_e,"AREA_CLICK","AREA_CLICK"),d(_e,"AREA_DOUBLE_CLICK","AREA_DOUBLE_CLICK");function Su(i){var r=Iu();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function Iu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ne=function(i){ee(e,i);var r=Su(e);function e(t){var n;return S(this,e),n=r.call(this,t),d(W(n),"listen",function(){var a=n.mapViewer.event;a.setMouseClickCallback(T.model,n._modelClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(T.model)}}),a.setMouseDoubleClickCallback(T.model,n._modelDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(T.model)}}),a.setMouseClickCallback(T.icon,n._iconClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(T.icon)}}),a.setMouseDoubleClickCallback(T.icon,n._iconDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(T.icon)}})}),n.listen(),n}return R(e,[{key:"_modelClickHandler",value:function(n){var a=this.getConfig(e.MODEL_CLICK);if(a){var o=a.defaultAction;o&&T.modelClickHandler(n),this.dispatch(e.MODEL_CLICK,n)}}},{key:"_modelDoubleClickHandler",value:function(n){var a=this.getConfig(e.MODEL_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&T.modelDoubleClickHandler(n),this.dispatch(e.MODEL_DOUBLE_CLICK,n)}}},{key:"_iconClickHandler",value:function(n){var a=this.getConfig(e.ICON_CLICK);if(a){var o=a==null?void 0:a.defaultAction;o&&T.iconClickHandler(n),this.dispatch(e.ICON_CLICK,n)}}},{key:"_iconDoubleClickHandler",value:function(n){var a=this.getConfig(e.ICON_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&T.iconDoubleClickHandler(n),this.dispatch(e.ICON_DOUBLE_CLICK,n)}}},{key:"onClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.MODEL_CLICK,n,a)}},{key:"offClick",value:function(n){this.unsubscribe(e.MODEL_CLICK,n)}},{key:"onDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.MODEL_DOUBLE_CLICK,n,a)}},{key:"offDoubleClick",value:function(n){this.unsubscribe(e.MODEL_DOUBLE_CLICK,n)}},{key:"onIconClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.ICON_CLICK,n,a)}},{key:"offIconClick",value:function(n){this.unsubscribe(e.ICON_DOUBLE_CLICK,n)}},{key:"onIconDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.ICON_DOUBLE_CLICK,n,a)}},{key:"offIconDoubleClick",value:function(n){this.unsubscribe(e.ICON_DOUBLE_CLICK,n)}}]),e}(on);d(Ne,"MODEL_CLICK","MODEL_CLICK"),d(Ne,"MODEL_DOUBLE_CLICK","MODEL_DOUBLE_CLICK"),d(Ne,"ICON_CLICK","ICON_CLICK"),d(Ne,"ICON_DOUBLE_CLICK","ICON_DOUBLE_CLICK");function Au(i){var r=Lu();return function(){var t=O(i),n;if(r){var a=O(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return te(this,n)}}function Lu(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Fe=function(i){ee(e,i);var r=Au(e);function e(t){var n;return S(this,e),n=r.call(this,t),d(W(n),"listen",function(){var a=n.mapViewer.event;a.setMouseClickCallback(F.model,n._modelClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(F.model)}}),a.setMouseDoubleClickCallback(F.model,n._modelDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(F.model)}}),a.setMouseClickCallback(F.icon,n._iconClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(F.icon)}}),a.setMouseDoubleClickCallback(F.icon,n._iconDoubleClickHandler.bind(W(n)),{compareFunc:function(u,s){return s.startsWith(F.icon)}})}),n.listen(),n}return R(e,[{key:"_modelClickHandler",value:function(n){var a=this.getConfig(e.MODEL_CLICK);if(a){var o=a.defaultAction;o&&F.modelClickHandler(n),this.dispatch(e.MODEL_CLICK,n)}}},{key:"_modelDoubleClickHandler",value:function(n){var a=this.getConfig(e.MODEL_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&F.modelDoubleClickHandler(n),this.dispatch(e.MODEL_DOUBLE_CLICK,n)}}},{key:"_iconClickHandler",value:function(n){var a=this.getConfig(e.ICON_CLICK);if(a){var o=a.defaultAction;o&&F.iconClickHandler(n),this.dispatch(e.ICON_CLICK,n)}}},{key:"_iconDoubleClickHandler",value:function(n){var a=this.getConfig(e.ICON_DOUBLE_CLICK);if(a){var o=a.defaultAction;o&&F.iconDoubleClickHandler(n),this.dispatch(e.ICON_DOUBLE_CLICK,n)}}},{key:"onClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.MODEL_CLICK,n,a)}},{key:"offClick",value:function(n){this.unsubscribe(e.MODEL_CLICK,n)}},{key:"onDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.MODEL_DOUBLE_CLICK,n,a)}},{key:"offDoubleClick",value:function(n){this.unsubscribe(e.MODEL_DOUBLE_CLICK,n)}},{key:"onIconClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.ICON_CLICK,n,a)}},{key:"offIconClick",value:function(n){this.unsubscribe(e.ICON_DOUBLE_CLICK,n)}},{key:"onIconDoubleClick",value:function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z;this.subscribe(e.ICON_DOUBLE_CLICK,n,a)}},{key:"offIconDoubleClick",value:function(n){this.unsubscribe(e.ICON_DOUBLE_CLICK,n)}}]),e}(on);d(Fe,"MODEL_CLICK","MODEL_CLICK"),d(Fe,"MODEL_DOUBLE_CLICK","MODEL_DOUBLE_CLICK"),d(Fe,"ICON_CLICK","ICON_CLICK"),d(Fe,"ICON_DOUBLE_CLICK","ICON_DOUBLE_CLICK");var Ru=R(function i(r){S(this,i),this.mapViewer=r,this.camera=new _e(r),this.door=new Ne(r),this.intercom=new Fe(r)}),Du=R(function i(r,e){var t=this;S(this,i),d(this,"getEvent",function(){return t.event}),d(this,"getController",function(){return t.controller}),d(this,"getAdapter",function(){return t.adapter}),this.view3d=r,this.mapViewer=e,this.adapter=new Cu(this.mapViewer),this.event=new Ru(e),this.category=jr,this.controller=new Jr(e)}),Oe=le,Mu=function(){function i(r){S(this,i),this.view3d=r}return R(i,[{key:"isBuildWK",value:function(e){return/^V[\d]+_JZ[\d]+_WK$/.test(e)}},{key:"isBuildTitle",value:function(e){return/^MP_V[\d]+_JZ[\d]+_WK_?[\d]?$/.test(e)&&this.isBuildFloor(e)===!1}},{key:"isBuildFloor",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_[FWMB][\d]+$/.test(e)}},{key:"isBuildXP",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_XP[\d]*$/.test(e)}},{key:"isFloorXP",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_[FWMB][\d]+_XP[\d]*$/.test(e)}},{key:"isFloorRoom",value:function(e){return/^V[0]+[\d]+_JZ[0]+[\d]+_WK_[FWMB][\d]+_[U][\d]+_[H][\d]+$/.test(e)}},{key:"getBuildIdByWKGid",value:function(e){return e.replace(/_WK.*/,"")}},{key:"getBuildGidByBuildId",value:function(e){return e.replace(/JZ([\d]+)(_?)/,"JZ$1_WK$2")}},{key:"getBuildIdByTitleGid",value:function(e){return e.replace(/_WK.*/,"").replace(/MP_/,"")}},{key:"getBuildIdByFloorGid",value:function(e){return e.replace(/_WK.*/,"")}},{key:"getBuildIdByRoomGid",value:function(e){return e.split("_WK")[0]}},{key:"getFloorIdByRoomGid",value:function(e){var t=e.split("_");return"".concat(t[0],"_").concat(t[1],"_").concat(t[3])}},{key:"getFloorIdByFloorGid",value:function(e){return e.replace(/_WK/,"")}},{key:"getFloorNameByFloorId",value:function(e){return e.split("_")[2]}},{key:"getFloorNameSmallByFloorGId",value:function(e){var t=this.getFloorIdByFloorGid(e);return this.getFloorNameSmallByFloorId(t)}},{key:"getFloorNameSmallByFloorId",value:function(e){return this.getFloorNameByFloorId(e).replace(/([A-Z]*)[0]*([1-9][\d]*)/,"$1$2")}},{key:"getF001toF1",value:function(e){return e.replace(/([\w])[0]*([\d]+)/,"$1$2")}},{key:"resetBuild",value:function(e){this.splitBuildingResetSync(e),this.view3d.ResetObjects()}},{key:"splitFloor",value:function(e,t,n){this.view3d&&this.view3d.SplitDynamicFloor(e,t,n)}},{key:"getBuildingNum",value:function(e){Oe(e)===!0?this.view3d.GetBuildingNum(function(t){e&&e(t)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getBuildingNames",value:function(e){Oe(e)===!0?this.view3d.GetBuildingNames(function(t){e&&e(t)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getBuildingNamesSync",value:function(){return q(this.view3d,this.view3d.GetBuildingNames)}},{key:"getBuildingVisible",value:function(e,t){Oe(t)===!0?this.view3d.GetBuildingVisible(e,function(n){t&&t(n)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"setBuildingVisible",value:function(e,t,n){return j(100,this.view3d,this.view3d.SetBuildingVisible,e,t,n)}},{key:"setBuildingWKVisible",value:function(e,t,n){this.view3d.SetBuildingWkVisible(e,t,n)}},{key:"resetAllBuildings",value:function(){return j(10,this.view3d,this.view3d.ResetAllBuildings)}},{key:"splitBuilding",value:function(e,t){this.view3d.SplitBuilding(e,t)}},{key:"splitBuildingReset",value:function(e){this.view3d.SplitBuildingReset(e)}},{key:"splitBuildingResetSync",value:function(e){return j(20,this.view3d,this.view3d.SplitBuildingReset,e)}},{key:"splitDynamicBuilding",value:function(e,t){this.view3d.SplitDynamicBuilding(e,t)}},{key:"splitDynamicFloor",value:function(e,t,n){this.view3d.SplitDynamicFloor(e,t,n)}},{key:"splitFloorReset",value:function(e,t){return this.view3d.SplitFloorReset(e,t)}},{key:"getFloorNum",value:function(e,t){Oe(t)===!0?this.view3d.GetFloorNum(function(n){t&&t(n)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getFloorNames",value:function(e,t){console.log("call getFloorNames: ",e),console.log(Oe(t)),Oe(t)?this.view3d.GetFloorNames(e,t):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getFloorNamesSync",value:function(e){return q(this.view3d,this.view3d.GetFloorNames,e)}},{key:"getFloorVisible",value:function(e,t,n){Oe(n)===!0?this.view3d.GetFloorVisible(e,t,function(a){n&&n(a)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"setFloorVisible",value:function(e,t,n,a){return j(10,this.view3d,this.view3d.SetFloorVisible,e,t,n,a)}},{key:"getUpFloorNum",value:function(e,t,n){Oe(n)===!0?this.view3d.GetUpFloorNum(e,t,function(a){n&&n(a)}):console.error("cb \u4E0D\u662F\u51FD\u6570")}},{key:"getUpFloorNames",value:function(e,t,n){this.view3d.GetUpFloorNames(e,t,function(a){n&&n(a)})}},{key:"getDownFloorNum",value:function(e,t,n){this.view3d.GetDownFloorNum(e,t,function(a){n&&n(a)})}},{key:"GetDownFloorNames",value:function(e,t,n){this.view3d.GetDownFloorNum(e,t,function(a){n&&n(a)})}},{key:"getFloorRoomNum",value:function(e,t,n){this.view3d.GetFloorRoomNum(e,t,function(a){n&&n(a)})}},{key:"getFloorRoomNames",value:function(e,t,n){return q(this.view3d,this.view3d.GetFloorRoomNames,e,t)}},{key:"getFloorRoomVisible",value:function(e,t,n,a){this.view3d.GetFloorRoomVisible(e,t,n,function(o){a&&a(o)})}},{key:"setFloorRoomVisible",value:function(e,t,n,a){this.view3d.SetFloorRoomVisible(e,t,n,a)}},{key:"setGroundVisible",value:function(){var r=G(D.mark(function t(n){return D.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",j(10,this.view3d,this.view3d.SetGroundVisible,n));case 1:case"end":return o.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()}]),i}();function ni(i,r){var e=Object.keys(i);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(i);r&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})),e.push.apply(e,t)}return e}function ri(i){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?ni(Object(e),!0).forEach(function(t){d(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):ni(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function un(i,r){var e=typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(!e){if(Array.isArray(i)||(e=Bu(i))||r&&i&&typeof i.length=="number"){e&&(i=e);var t=0,n=function(){};return{s:n,n:function(){return t>=i.length?{done:!0}:{done:!1,value:i[t++]}},e:function(l){throw l},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,o=!1,u;return{s:function(){e=e.call(i)},n:function(){var l=e.next();return a=l.done,l},e:function(l){o=!0,u=l},f:function(){try{!a&&e.return!=null&&e.return()}finally{if(o)throw u}}}}function Bu(i,r){if(!!i){if(typeof i=="string")return ii(i,r);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return ii(i,r)}}function ii(i,r){(r==null||r>i.length)&&(r=i.length);for(var e=0,t=new Array(r);e<r;e++)t[e]=i[e];return t}var ne=le,ai=se,oi=dr,ui=at,ju=bn,sn=1,ln=2,nt="zoomIn",rt="zoomOut",it="mousemove",Te=sn,cn=null,fn=[nt,rt,it],si={prefix:"",isDouble:!1,compareFunc:oi,isOnce:!1,internal:!1,key:+new Date},Pu=function(){function i(r,e){S(this,i),d(this,"_flushDragCallback",function(t,n){t.size>0&&t.forEach(function(a){a(n)})}),this._view3d=r,this.mapViewer=e,this.prefix="*",this.prefixAndCallbackMap=new Map,this._lastClickTimestamp=+new Date,this._emitMouseUp=!1,this._addMouseMoveEvent(),this._addMouseUpEvent(),this._addMouseDownEvent(),this._hasRegisterMouseWheelHandler=!1,this.cleanupCallback=null,this._clickCallbackTimer=new Map,this._onDragHandler=new Set,this._onDragStartHandler=new Set,this._onDragEndHandler=new Set,this._dragTicker=150}return R(i,[{key:"_handleMouseMove",value:function(e){var t=this;Te===sn&&this._flushDragCallback(this._onDragStartHandler,e),Te=ln,cn&&clearTimeout(cn),this._flushDragCallback(this._onDragHandler,e),cn=setTimeout(function(){t._emitMouseUp||t._handleMouseUp()},100)}},{key:"_handleMouseDown",value:function(){}},{key:"_handleMouseUp",value:function(){Te===ln&&this._flushDragCallback(this._onDragEndHandler),Te=sn}},{key:"_registerMouseEvent",value:function(e,t){var n=this.mapViewer.core.config.id,a=document.getElementById(n);a.addEventListener(e,t)}},{key:"_removeMouseEvent",value:function(e,t){var n=fn.filter(function(l){return l===e})[0];if(n){var a=this.prefixAndCallbackMap.get(n);if(a){var o=this.getCallbacks(e)[0].callback;if(this._removeCacheCallback(e,t),!this.prefixAndCallbackMap.get(nt)&&!this.prefixAndCallbackMap.get(rt)||e===it){var u=this.mapViewer.core.config.id,s=document.getElementById(u);s.removeEventListener(e,o)}}}}},{key:"_registerMouseWheelCallback",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"mousewheel",t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ai;this._hasRegisterMouseWheelHandler||(this._registerMouseEvent(e,t),this._hasRegisterMouseWheelHandler=!0)}},{key:"_mouseWheelHandler",value:function(){var r=G(D.mark(function t(n){var a=this,o,u;return D.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:o=n.wheelDelta,u="",o>0?u=nt:o<0&&(u=rt),u&&this.mapViewer.camera&&this.mapViewer.camera.getCurrentPosition&&this.mapViewer.camera.getCurrentPosition().then(function(f){var c=a.prefixAndCallbackMap.get(u);if(c){var g=c.get("callback"),m=g.get("click");m.forEach(function(b){b.get("config").compareFunc&&b.get("config").compareFunc(n,f)})}});case 4:case"end":return l.stop()}},t,this)}));function e(t){return r.apply(this,arguments)}return e}()},{key:"getCallbacks",value:function(e){var t=this.prefixAndCallbackMap.get(e);if(t)return Array.from(t.get("callback").click).map(function(n){return Object.fromEntries(n)})}},{key:"setDragTicker",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:150;this._dragTicker=e}},{key:"zoomIn",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{debounce:!0,debounceTime:300};if(ne(e)){var n=this._mouseWheelHandler.bind(this);t.debounce&&(n=ui(this._mouseWheelHandler.bind(this),t.debounceTime||300,!1)),this._cacheCallback(nt,n,{isOnce:!1,compareFunc:e,internal:!1}),this._registerMouseWheelCallback("mousewheel",n)}}},{key:"zoomOut",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{debounce:!0,debounceTime:300};if(ne(e)){var n=this._mouseWheelHandler.bind(this);t.debounce&&(n=ui(this._mouseWheelHandler.bind(this),t.debounceTime||300,!1)),this._cacheCallback(rt,n,{isOnce:!1,compareFunc:e,internal:!1}),this._registerMouseWheelCallback("mousewheel",n)}}},{key:"onMouseMove",value:function(e){var t=ju(function(n){console.log(n)},500);this._cacheCallback(it,t,{isOnce:!1,compareFunc:e,internal:!1}),this._registerMouseEvent(it,t)}},{key:"onDrag",value:function(e){ne(e)&&this._onDragHandler.add(e)}},{key:"onDragStart",value:function(e){ne(e)&&this._onDragStartHandler.add(e)}},{key:"onDragEnd",value:function(e){ne(e)&&this._onDragEndHandler.add(e)}},{key:"removeDrag",value:function(e){ne(e)&&this._onDragHandler.delete(e)}},{key:"removeDragStart",value:function(e){ne(e)&&this._onDragStartHandler.delete(e)}},{key:"removeDragEnd",value:function(e){ne(e)&&this._onDragEndHandler.delete(e)}},{key:"removeMouseEvent",value:function(){this._view3d&&h(this._view3d,"UnRegisterEvent")&&this._view3d.UnRegisterEvent()}},{key:"_addMouseMoveEvent",value:function(){var e=this._view3d;h(e,"RegisterEvent")&&e.RegisterEvent("onmousemove",this._handleMouseMove.bind(this))}},{key:"_addMouseDownEvent",value:function(){var e=this._view3d;h(e,"RegisterEvent")&&e.RegisterEvent("onmousedown",this._handleMouseDown.bind(this))}},{key:"_addMouseUpEvent",value:function(){var e=this._view3d;h(e,"RegisterEvent")&&e.RegisterEvent("onmouseup",this._handleMouseUp.bind(this))}},{key:"_resetMouseCallback",value:function(){this.prefix="*";var e=un(this.prefixAndCallbackMap.keys()),t;try{for(e.s();!(t=e.n()).done;){var n=t.value;this.prefixAndCallbackMap.delete(n)}}catch(a){e.e(a)}finally{e.f()}}},{key:"_cacheCallback",value:function(e,t,n){if(!!e){var a=e.split(",").map(function(I){return I.trim()}),o=un(a),u;try{for(o.s();!(u=o.n()).done;){var s=u.value,l=this.prefixAndCallbackMap.get(s);if(l){if(l.has("callback")){var f=l.get("callback"),c=new Map;c.set("config",n),c.set("callback",t);var g=void 0;n.isDouble?g=f.get("double"):g=f.get("click"),g.add(c)}}else{var m=new Map,b=new Map,C=new Set,L=new Set,E=new Map;E.set("config",n),E.set("callback",t),n.isDouble?L.add(E):C.add(E),b.set("click",C),b.set("double",L),m.set("prefix",s),m.set("callback",b),this.prefixAndCallbackMap.set(s,m)}}}catch(I){o.e(I)}finally{o.f()}}}},{key:"_removeCacheCallback",value:function(e,t){var n=this;if(!!e){var a=e.split(","),o=un(a),u;try{var s=function(){var f=u.value;if(n.prefixAndCallbackMap.has(f)){var c=n.prefixAndCallbackMap.get(f);if(c){var g=c.get("callback"),m=g.get("click"),b=g.get("double"),C=function(E){E.forEach(function(I){var V=I.get("callback");fn.includes(f)?I.get("config").compareFunc===t&&E.delete(I):V===t&&E.delete(I)})};m.size>0&&C(m),b.size>0&&C(b),m.size===0&&b.size===0&&n.prefixAndCallbackMap.delete(f)}}};for(o.s();!(u=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}}}},{key:"_addMouseClickCallback",value:function(){var e=this,t=this._view3d,n=this;if(this.mapViewer.core.setParameters({prefix:"*"}),h(t,"SetMouseCallback")){var a=function(u){n._lastClickCallbackTimer=setTimeout(function(){if(Te!==ln){var s=u.gid,l=u.attr&&u.attr.gid||"",f=+new Date;s||l?function(){for(var c=!1,g=Array.from(e.prefixAndCallbackMap.entries()),m=function(E,I){I.forEach(function(V){var p=V.get("config"),U=V.get("callback"),H=p.compareFunc,X=p.isOnce;if(H!==oi){if(H(s,l)){var he=U(u);ne(he)&&(n.cleanupCallback=he),c=!0}}else if(s&&s.toLocaleLowerCase().startsWith(E.toLocaleLowerCase())||l&&l.toLocaleLowerCase().startsWith(E.toLocaleLowerCase())||E==="*"){c=!0;var ce=U(u);ne(ce)&&(n.cleanupCallback=ce)}X&&setTimeout(function(){n.remove(E,U)})})},b=function(E){var I=ut(g[E],2);I[0];var V=I[1],p=V.get("prefix"),U=V.get("callback"),H=U.get("click"),X=U.get("double");if(H.size>0&&X.size===0)m(p,H);else if(H.size===0&&X.size>0)f-n._lastClickTimestamp<=300&&m(p,X);else{var he=!1;if(f-n._lastClickTimestamp<=300&&(clearTimeout(n._clickCallbackTimer.get(p)),n._clickCallbackTimer.delete(p),he=!0,m(p,X)),!he){var ce=setTimeout(function(){m(p,H)},300);n._clickCallbackTimer.set(p,ce)}}},C=0;C<g.length;C++)b(C);!c&&ne(n.cleanupCallback)&&(n.cleanupCallback(),n.cleanupCallback=null)}():ne(n.cleanupCallback)&&(n.cleanupCallback(),n.cleanupCallback=null),n._lastClickTimestamp=f}},n._dragTicker)};setTimeout(function(){t.SetMouseCallback(a)},10)}}},{key:"setMousePositionCallback",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ai,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=this._view3d;if(!ne(e)){Ye(" callback must be a function, but got: ".concat(ie(e),"."));return}h(n,"SetMousePositionCallback")&&n.SetMousePositionCallback(function(a){e(a),t&&n.SetMousePositionCallback(null)})}},{key:"setMouseClickCallback",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"*",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:si;n=Object.assign({},si,n);var a=n;if(a.isOnce,ne(e)&&(t=e),!ne(t)){Ye(" callback must be a function, but got: ".concat(ie(t),"."));return}this._cacheCallback(e,t,n),this._addMouseClickCallback()}},{key:"reBindMouseClickCallback",value:function(){this._addMouseClickCallback()}},{key:"setMouseDoubleClickCallback",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"*",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.setMouseClickCallback(e,t,ri(ri({},n),{},{isDouble:!0,prefix:e}))}},{key:"remove",value:function(e,t){if(!e){Ut("prefix is not defined, or is ''.");return}fn.includes(e)?this._removeMouseEvent(e,t):this._removeCacheCallback(e,t)}},{key:"removeMouseDoubleClickCallback",value:function(e,t){this.remove(e,t)}},{key:"removeMousePositionCallback",value:function(){var e=this._view3d;h(e,"SetMousePositionCallback")&&e.SetMousePositionCallback(null)}},{key:"clear",value:function(){var e=this._view3d;this.mapViewer.core.setParameters(null),h(e,"SetMouseCallback")&&(e.SetMouseCallback(null),this._resetMouseCallback())}},{key:"silent",value:function(){var e=this._view3d;e.Clear(),e.SetParameters(null),e.SetMouseCallback(null)}}]),i}(),Nu=le,li=se,Fu={id:"mapv3d-container",url:"",projectId:"",token:"",mapkey:"",manual:!1,loading:!0,northControl:!1,enableKeyboard:!0,enableMouse:!0,defaultLocate:!0,defaultSetResolution:!1,resolutionScale:1,complete:li,error:li,internalMouseVisible:!1},Tu=function(){function i(r){S(this,i),this._initFinished=!1,this.core=new ro,this.config=Object.assign({},Fu,r),this.config.manual||this._init(),this.event=null,this.build=null,this.camera=null,this.drawer=null,this.model=null,this.scheduler=Ar,vi()}return R(i,[{key:"create",value:function(){if(this._initFinished){Ut("MapViewer is already initialize.");return}this._init()}},{key:"_init",value:function(){var e=this;this.core.createMap(this.config).then(function(){var t=e.core.view3d;t&&(e.event=new Pu(t,e),e.build=new Mu(t,e),e.camera=new uo(t,e),e.drawer=new Mo(t,e),e.model=new Du(t,e),e._initFinished=!0,e.config.complete&&Nu(e.config.complete)&&e.config.complete(t))})}}]),i}(),Vu="MapV3D \u4E09\u7EF4\u5730\u7403\u6846\u67B6",$u="http://www.aimapvision.com/",Hu="\u56FE\u6D0B\u79D1\u6280",Uu=hn(),xu=gn(),Ku=di,Gu=jr;Q.CATEGORY=Gu,Q.MapViewer=Tu,Q.author=Hu,Q.env=Ku,Q.name=Vu,Q.scheduler=Ar,Q.update=xu,Q.utils=Ga,Q.version=Uu,Q.website=$u,Object.defineProperties(Q,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=mapv3d-src.umd.js.map
